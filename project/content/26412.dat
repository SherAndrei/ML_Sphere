windpower-russia.ru/archive/index.php/t-232.html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
	<meta name="keywords" content=" MPPT контроллер для ветра, ветряк,ветряки,ветрогенератор,ветрогенераторы,ветроэнергетика,инвертор,инверторы,энергия ветра,wind windpower,windmill,windenergy,форум,форум по ветроэнергетике,ветротурбина,солнечная энергия,солнечная батарея,нетрадиционная энергетика,сапсан,виндек,солнечные коллекторы,турбина,турбины,генератор,генераторы,электрогенератор,ветроэлектрогенератор,самодельный ветряк,самодельный ветрогенератор,ветряная мельница,парусный ветряк,дарье,теплонасос,контроллер заряда,аккумулятор,аккумуляторы, ветрогенератор своими руками" />
	<meta name="description" content="[Архив]  MPPT контроллер для ветра Электроника" />
	
	<title> MPPT контроллер для ветра [Архив]  - Ветроэнергетика и альтернативная энергетика.</title>
	<link rel="stylesheet" type="text/css" href="http://windpower-russia.ru/archive/archive.css" />
</head>
<body>
<div class="pagebody">
<div id="navbar"><a href="http://windpower-russia.ru/archive/index.php"><IDXSKIP>Ветроэнергетика и альтернативная энергетика.</IDXSKIP></a> &gt; <a href="http://windpower-russia.ru/archive/index.php/f-15.html">Технический раздел</a> &gt; <a href="http://windpower-russia.ru/archive/index.php/f-9.html">Электроника</a> &gt;  MPPT контроллер для ветра</div>
<hr />
<div class="pda"><a href="http://windpower-russia.ru/archive/index.php/t-232.html?pda=1" rel="nofollow">PDA</a></div>
<p class="largefont">Просмотр полной версии : <a href="http://windpower-russia.ru/showthread.php?t=232">MPPT контроллер для ветра</a></p>
<hr />
<div id="pagenumbers"><b>Страницы :</b>
[<b>1</b>]
<a href="http://windpower-russia.ru/archive/index.php/t-232-p-2.html">2</a>
</div>
<hr />

<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">04.07.2011, 20:11</div></div><div class="posttext">Есть для солнца контроллеры сделанные по технологии точка максимальной мощности(MPPT), купил такой намедни, ну очень интересный девайс... почему нет аналога для ветра????<br />
Для тех кто не в теме поясню.... <br />
MPPT контроллер позволяет снять максимум мощности с солнечной батареи независимо от освещенности и температуры элементов...<br />
в любой момент времени контроллер удерживает ток отдаваемый солнечной батареей нагружая ее или снижая нагрузку на том уровне, на котором произведение напряжения на ток максимально, в точке максимальной мощности...<br />
 <br />
По сути для ветряка система подобного рода это просто клад....<br />
дело в том, что у нас в ветряке присутствуют две системы из разных разделов науки...<br />
1. ветроколесо <br />
2. электрогенератор.<br />
 <br />
понятно что попытки расчета сводятся к тому, чтобы максимально согласовать работу этих двух элементов в наших &quot;уникальных условиях&quot; Делается это на этапе проектирования, даже сняв характеристику с генератора и ветроколесо считая под него результат будет несколько не идеален<br />
ибо аэродинамика штука тонкая, да и погрешность изготовления и материал лопасти вносят свои коррективы<br />
 <br />
в тоже время если задавать нагрузочную характеристику на действующем ветряке ориентируясь ТОЛЬКО на выдаваемую ветрогенератором мощность... загоняя его (генератор) в пик загружая или наоборот снимая нагрузку... подстраиваясь..т.с.<br />
ведь работа этой машины не передается обычной плоской зависимостью вольт/амперной,<br />
график работы системы в сборе трехмерный, добавляется сила ветра, т.е это не кривая... это поверхность<br />
и выглядит она как холм, по идее... так вот наша задача загнать режим работы генератора на самую верхнюю точку этого холма<br />
есть ли такие системы?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Микола</div><div class="date">06.07.2011, 00:22</div></div><div class="posttext">Работаем над нечто подобным, только летом мало времени, теперь уж активно осенью займусь.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">06.07.2011, 01:30</div></div><div class="posttext">ибо аэродинамика штука тонкая, да и погрешность изготовления и материал лопасти вносят свои коррективыЕщё какая тонкая. Чуть туда, чуть сюда и быстроходность меняется в разы. Соответственно пик мощности будет совершенно в другом месте.<br />
<br />
так вот наша задача загнать режим работы генератора на самую верхнюю точку этого холмаВ наших условиях что-бы снять нагрузочные характеристики винта, то есть зависимость крутящего момента от оборотов на разных ветрах, нам надо какой-то тормозной механизм. Вот в качестве этого механизма и используем генератор. С его помощью хоть как-то можно определить, что там делается на винте. И когда эти данные есть, то можно пробовать их забивать туда, чем занимается Микола. Наверное мы все об одном и том-же. Контролер отбора мощности...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">06.07.2011, 14:03</div></div><div class="posttext">не нужно ничего никуда забивать....<br />
нужно просто измерять отдаваемую мощность меняя нагрузку на генератор и таким образом искать пик отдаваемой мощности.<br />
<br />
представим контроллер  заряда как ящик с одним входом и одним выходом.<br />
функция по входу - открывать &quot;некий вентиль&quot; или закрывать его ( имеется ввиду регулировать ток) отыскивая максимум на графике мощности.. т.е отыскивая место где произведение тока на напряжение максимально<br />
<br />
функцией выхода является 100% утилизация всей передаваемой мощности... что не лезет в батарейку - суем в бак нагревательный для воды...<br />
это вкратце. <br />
Но при этом мы можем не знать ничего о самом генераторе и о винте... нам это не нужно.<br />
главное не превысить предел по току через устройство, и все.<br />
<br />
в принципе вся логика работы понятна...<br />
основная задача передать от входа к выходу информацию о том, какую энергию нужно утилизировать<br />
это нужно для того, чтобы процесс шел как нужно....<br />
<br />
ну например...<br />
1.ветра нет, ветряк стоит...<br />
напряжения нет<br />
система не работает.<br />
2. подул ветер слабый ... генератор пока разгружен, нагрузка не подключена... но контроллер начинает фиксировать напряжение на входе и плавно отдавать наращивать мощность в нагрузку ( акб или балласт не важно, )<br />
ветряк начинает затормаживаться, но до определенного времени момента на винте хватает для эффективного вращения генератора <br />
ток увеличивается.... а вот напряжение начинает падать... обусловлено это падение во первых замедлением вращения а во вторых нагрузочной характеристикой самого генератора...<br />
нагружаем пошагово и на каждом шаге смотрим как меняется отдаваемая генератором мощность ищем перегиб при котором рост мощности прекращается и начинается его падение...<br />
переходим в режим удержания... но ток периодически уменьшаем.увеличиваем следя за выхлопом...<br />
т.е просто ищем максимум...<br />
<br />
При такой подстраиваемой нагрузке, ветряк будет в режиме ВСЕГДА... <br />
на любом ветре... даже на слабом, т.к изменяемая нагрузка будет уменьшена до нуля при старте... т.к. нет отдачи по мощности... и будет увеличена после старта до того уровня при котором, пропеллер работает в оптимальном режиме для данного ветра<br />
<br />
<br />
т.е устройство должно быть универсально. и любой бы смог его воткнуть на свой генератор без изменений для получения нужного эффекта</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Woleh</div><div class="date">06.07.2011, 18:19</div></div><div class="posttext">т.е устройство должно быть универсально. и любой бы смог его воткнуть на свой генератор без изменений для получения нужного эффекта<br />
Устройство очень нужное!Без него никак необойтись!Но боюсь появиться не скоро! Месяца 4 я искал схему контроллера с нужными характеристиками, на всех возможных языках. Сейчас пытаюсь с помощью специалистов в электронике сделать такой девайс на МК. Всё продвигаеться крайне медленно! А участники форума сумевшие сделать такие девайсы  сделали их для комерческого использования! Вот и перебиваемся все кто неимеет супер знаний контроллерами от Бойко и похожими! Все начатые темы в этом направлении уходят в (тень)!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Микола</div><div class="date">06.07.2011, 23:48</div></div><div class="posttext">Все начатые темы в этом направлении уходят в (тень)!<br />
Ну уж прямо так категорично. Просто пока нет готового решения, и показать не чего (у меня именно так).<br />
<br />
Давайте начнем с алгоритма. Отработаем его досканально, и тогда уж програмно попробуем решить, и только потом в железе. в процессе работы, я как раз и столкнулся с проблемой грамотного исполнения задачи.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gda98</div><div class="date">07.07.2011, 00:24</div></div><div class="posttext">нужно просто измерять отдаваемую мощность меняя нагрузку на генератор и таким образом искать пик отдаваемой мощности.<br />
не получится пока ищешь ветер изменится ;) и это уже будет недостоверное измерение. С солнцем проще, если небо ясное, то изменений длительное время не происходит, а ветер всегда разный и в любой момент.<br />
<br />
Добавлено через 1 минуту<br />
подул ветер слабый ... генератор пока разгружен, нагрузка не подключена... но контроллер начинает фиксировать напряжение на входе и плавно отдавать наращивать мощность в нагрузку ( акб или балласт не важно, )<br />
а ветер изменился и тупик контроллеру :) он то и дело будет плавно искать и никогда не найдет :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Woleh</div><div class="date">07.07.2011, 01:08</div></div><div class="posttext">Давайте начнем с алгоритма. Отработаем его досканально, и тогда уж програмно попробуем решить<br />
У меня есть две разработки контроллера. Первая в начальном состоянии на микроконтролере АТmega16.Частично написана программа но её нужно корректировать. Готова схема измерительной части и ШИМ регулятор. Есть восемь каналов открытия балласта! К сожалению человек который мне помогал в этом вопросе изза ряда причин неможет пака продолжить разработку и я с этим проэктом пака в тупике! Если на форуме есть люди умеющие работать с програмированием и готовы помочь то я выложу всю наработку. Схемы,прошивка и файл для Proteusa! Второй вариан разработки к сожелению пака выложить не смогу.Это не мой личный проект и тоже требует доработок!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">07.07.2011, 01:14</div></div><div class="posttext">gda98, может немножко не в тему но всё таки. Кто-то здесь недавно доходчиво описал что такое приемственность винта. Типа многолопастник намного бвстрее реагирует на изменение потока. Я себе это представляю так. Вертится винт и тут порыв ветра секунды на 2-3. Винт не успел на него отреагировать повышением оборотов, но в этот промежуток времени крутящий момент на нём то возрос. А мы его не используем. Можно как-то в этот момент увеличить нагрузку, базируясь на показания рядом стоящего анемометра? Вроде как увеличить приемственность трёхлопастного винта. Это реально?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">07.07.2011, 09:16</div></div><div class="posttext">не получится пока ищешь ветер изменится ;) и это уже будет недостоверное измерение. <br />
Добавлено через 1 минуту<br />
 <br />
а ветер изменился и тупик контроллеру :) он то и дело будет плавно искать и никогда не найдет :)<br />
Тут вопрос в скорости и величине шагов измерений... ведь плавно искать с какой скоростью???? мы пока это не оговорили<br />
скорость шага измерений она чем ограничена??? в основном только механической инерцией генератора  а так, чисто теоретически  <br />
электроника на однокристалке прекрасно с интервалом в 100мС может отрабатывать  процесс снятия показаний и управляющих воздействий в рамках одного шага... но основное время займет стабилизация оборотов при смене нагрузки...<br />
т.ч чисто теоретически скорость набора оборотов при смене ветра и  скорость отработки шагов она примерно одинакова и обусловлена одним и  тем же фактором - механической инерцией системы<br />
а если методы поисковые комбинировать... метод последовательных приближений он медленный...<br />
а например если использовать метод половинного деления - реакция системы будет более шустрой но менее точной.<br />
хотя порывы она будет отрабатывать точнее. т.е <br />
например если система видит что изменения по времени не сильно большие - можно использовать алгоритм последовательных приближений.. просто качать вокруг точки максимума...<br />
НО  если точка максимума начала перемещаться веселее... то тут уж не до &quot;жиру&quot; переходим в режим поиска методом половинного деления и наша задача удержать винт в режиме по максимуму не давая ему раскручиваться порывами ветра</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gda98</div><div class="date">07.07.2011, 10:03</div></div><div class="posttext">базируясь на показания рядом стоящего анемометра?<br />
это проще сделать, чем поиск пика мощности.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">07.07.2011, 10:18</div></div><div class="posttext">нет, это сделать сложнее...<br />
а самое главное - повторяемость этого девайса будет нулевой...<br />
зачем Вам анемометр. когда есть 3-х метровый пропеллер, например :crazy:<br />
тут ведь мы регулируем мощность с ветряка... зачем же обратную связь брать от ветра???<br />
мы сразу выкидываем все вкусняшки... как то коррекция неточности исполнения винта... или плохого его согласования с генератором.<br />
<br />
когда обратная связь идет от устройства на которое мы оказываем воздействие - только тогда эту систему можно назвать - адаптивной... все остальное - фигня</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gda98</div><div class="date">07.07.2011, 10:33</div></div><div class="posttext">Я бы не сказал, Ветряк нагружен и обороты зависят от нагрузки, а анемометр отражает реальную скорость ветра, а мощность ветряка на выходе зависит от скорости ветра, КИЭВ, и КПД механики и генератора. Подставив все это в формулу куба мощности от скорости ветра, на выходе получаем задание на нагрузку ветряка, можно поставить подстоечник для увеличения или уменьшения задания, как в электроприводе, и тогда можно будет подстраивать им задание под любой винт и любую нагрузку.<br />
<br />
Добавлено через 2 минуты<br />
Причем все это можно по формулам посчитать, а при испытаниях увидеть переборшили Вы с КИЭВ или недоборщили :)) и подстроечником постепенно приближаться к оптимуму. Это так, мысли в слух. <br />
Этот коэффициент линейный , регулируется резистором. Потом помножить на расчетную нагрузку и на выходе уже будете знать реальный КИЭВ своего винта ;) Если обратно в формулу запихнуть поправочный коэффициент - это и будет множителем КИЭВ .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">07.07.2011, 10:49</div></div><div class="posttext">Дима...лично я про достижение других целей говорю...<br />
я не хочу крутить резистор... зачем это делать если можно просто догрузить или разгрузить винт ориентируясь на показатель отдаваемой мощности??? в этом случае нам ничего не известно... но в принципе система отстроится на любой ветер и на любой генератор.. вот это и есть высший пилотаж.<br />
<br />
просто одно дело когда крутить резистор тебе интересно...<br />
а другое дело когда нужно просто поставить ветряк и забыть про него до следующего ТО.<br />
просто я не планирую делать из этого свое хобби ;-)<br />
И образования у меня достаточно чтобы мечту советских школьников &quot;Вкалывают роботы а не человек&quot; воплотить в своем личном домохозяйстве</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gda98</div><div class="date">07.07.2011, 10:58</div></div><div class="posttext">Так инерция системы будет все портить, ветер усилился, момент начал расти, а обороты еще не увеличились, в этот момент контроллер будет курить, а надо начинать грабить ветер :)) анемометр это позволит отследить, а винт из-за своей бОльшей инерционности - нет.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">07.07.2011, 11:23</div></div><div class="posttext">Причем все это можно по формулам посчитать, а при испытаниях увидеть переборшили Вы с КИЭВ или недоборщили и подстроечником постепенно приближаться к оптимуму. Это так, мысли в слух. Этот коэффициент линейный , регулируется резистором. <br />
Теперь можно я по колхозному порассуждаю вслух. То что Tema0 предлагает, это своего рода сканер. С какой-то частотой, скажем в 1сек, пробежался по заданному диапазону напряжений изменяя нагрузку от нуля до максимума и оставил её такой когда мощность будет максимальной. Не, ну так здесь мы тогда полностью зависим от оборотов на винте...<br />
когда обратная связь идет от устройства на которое мы оказываем воздействие - только тогда эту систему можно назвать - адаптивной... все остальное - фигня Так вот увеличивать нагрузку нужно ещё до того как винт начал набирать обороты при усилении ветра, а снимать не тогда когда винт затормозился от того что ветер стих, а раньше. То есть: усилился ветер, увеличилась нагрузка. Уменьшился ветер, уменьшилась нагрузка причём до значения, которое соответствует ветру в данный момент времени. Как по мне, это было-бы круто :) ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">07.07.2011, 11:47</div></div><div class="posttext">Так инерция системы будет все портить, ветер усилился, момент начал расти, а обороты еще не увеличились, в этот момент контроллер будет курить, а надо начинать грабить ветер :)) .<br />
<br />
Дим.. сам подумай.. грабь ветер... момент ведь возрос... ты же 10 раз в секунду делаешь попытку нагрузить винт или снять с него нагрузку...<br />
если в один прекрасный момент ты догрузил винт а мощность не упала а возрасла ( момент ведь возрос) ты и снял доп мощность...<br />
разве не так? Инерция тебе тут не помеха....<br />
она как раз системой то и скорректируется...<br />
а вот с анемометром...<br />
<br />
ветер резко вырос, анемометр отработал...<br />
но ветряк 3 метра диаметром обороты еще набрать не успел...<br />
но ты его уже пытаешься оттормозить нагружая его доп нагрузкой...<br />
при этом винт не работает в оптимальном режиме еще не вышел он на него.... и как тут быть как ты будешь время инерции ветряка относительно анемометра корректировать?<br />
ведь это время зависит от целой кучи факторов...<br />
<br />
а ориентируясь на пик отдаваемой мощности ты не препятствуешь выходу винта на режим... т.к на период выхода на режим (переходный период) ты постоянно качаешь нагрузку не препятствуя винту раскручиваться... но при этом снимаешь максимум...<br />
<br />
просто пример...<br />
деревянные лопасти сухие и мокрые... момент инерции разный.<br />
зима и лето - плотность воздуха разная, соответственно момент инерции на скоростных ветряках разный...<br />
нельзя все учесть, но можно все подрегулировать ориентируясь только на 1 параметр который определяет оптимальность режима работы системы - МОЩНОСТЬ<br />
только на нее нужно ориентироваться... а не на скорость ветра или какие другие параметры.<br />
<br />
<br />
и еще прикольный появляется момент...<br />
<br />
находясь в пике мощности мы вдруг начинаем замечать что мощность вышла за какой то допустимый предел это говорит о том, что скорость ветра слишком велика... и нужно выводить ветряк из под ветра...<br />
но зачем его выводить совсем??? ведь мы его можем вывести на тот угол, при котором мощность упадет до допустимых пределов...<br />
причем эта предельная мощность чаще задается обмотками генератора...<br />
т.е мы ставим на слабый гену большой винт, чтобы на слабых ветрах снять с него максимум...<br />
а при возможной ситуации когда ветер усиливается никто не мешает нам продолжать снимать допустимую для генератора мощность просто уменьшив площадь обдува винта, отклонив его на нужный в этот момент угол.<br />
<br />
и еще.. обладая ФАКТИЧЕСКИМИ ДАННЫМИ  о мощности ты выдаешь задание утилизатору... типа.. на следующем шаге забери у меня +10 Вт или -10Вт...<br />
с этими данными работать проще так как на данный момент контроллер точно знает сколько можно лить в батарею а остальное будем лить на балласт.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">07.07.2011, 12:28</div></div><div class="posttext">Мда. Что бы всё это учесть так помоему легче на какой нибудь Пентиум 100 поставить Виндовс 98 и пусть какая нибудь прога всё это обрабатывает. У меня таких вон два стоит, вполне рабочих :) ...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">07.07.2011, 12:33</div></div><div class="posttext">Сергей... на самом деле вся описанная логика до безумия проста и на простой однокристалке реализуема. комп сожрет больше чем ты получишь от ветра ;-)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gda98</div><div class="date">07.07.2011, 13:10</div></div><div class="posttext">на самом деле вся описанная логика до безумия проста<br />
у микроконтроллера есть команда умножения? :)) если нет, то он будет тупить , т.к. в таком случае пишется подпрограмма умножения путем сложения столько раз на сколько надо умножить - это программируемый цикл. Сколько тактов уйдет при умножении на 1000? :) Посчитать время выполнения команды, плюс снятие параметров с минимум двух АЦП, это все по тактам посчитать и прикинуть время отработки полного цикла измерений. Мощность равна ток умножить на напряжение, значит нужно умножать, иначе мощность не измерить...<br />
<br />
Добавлено через 1 минуту<br />
Если получится раз в секунду, то это грустно - нужен проц , который выполняет операции с плавающей запятой ;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">07.07.2011, 13:27</div></div><div class="posttext">Мощность равна ток умножить на напряжение, значит нужно умножать, иначе мощность не измерить...То есть нам нужен Ваттметр постоянного тока, а потом всё остальное. Правильно я понял?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">gda98</div><div class="date">07.07.2011, 13:33</div></div><div class="posttext">Да</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">07.07.2011, 14:18</div></div><div class="posttext">Хотите страшную тайну Дмитрий?<br />
в нашем случае не обязательно даже искать максимум произведения тока на напряжение...<br />
нас устроит и максимум суммы ;-) для поиска максимума.<br />
хотя нужно подумать :-) не факт<br />
<br />
но у нас допустима некоторая погрешность умножения. посему можно и упростить задачу</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">09.07.2011, 18:54</div></div><div class="posttext">Позвольте вставить свои 5 копеек.<br />
<br />
1. При порыве или провале ветра всё то время, пока ветряк не изменит  свои обороты под изменившийся ветер он будет давать меньше мощности, чем  мог бы на этом ветре.<br />
2. если ветер переменный по скорости, то чем выше инерционность ветряка, тем больше энергии он будет терять. (назову это инерционными потерями)<br />
<br />
теперь суть, чтобы инерционные потери были минимальными нужно при  увеличении скорости ветра нагрузку снимать, давая тем самым ротору  разогнаться быстрее, энергия никуда не потеряется - она пойдет на разгон  ротора. <br />
<br />
При падении скорости ветра тоже самое - в самом тяжелом случае ротор  выйдет в вентиляторный режим и свою кинетическую энергию отдаст ветру,  чтобы этого не было нужно нагрузить генератор так, чтобы ротор вышел на  обороты максимальной мощности для этого ветра.<br />
Если делать, как говорит Tema0, то инерционные потери возрастут,  т.к. попытка взять максимум мощности будет препятствовать быстрому  переходу ротора в номинальный режим.<br />
Нужно отслеживать скорость вращения ротора (по частоте тока генератора  допустим), считать по ней угловое ускорение их произведение даст  значение избытка или недостатка механической мощности по ней и корректировать нагрузку.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">11.07.2011, 09:35</div></div><div class="posttext">Странно... вроде как маховик он сам является аккумулятором энергии.. <br />
он ее вроде как усредняет по времени... чем он больше ,тем среднее  энергия...<br />
потери же в маховике вроде были всегда только на трение всякого рода...<br />
посему ветряк размером 3 метра полюбому будет инерционный... ну как не крути.<br />
масса его слишком велика.<br />
<br />
<br />
пока это все домыслы.... нужно опыты ставить.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">11.07.2011, 15:01</div></div><div class="posttext">А применить принцип велосипедного колеса?<br />
Есть ветер - появляется тяга, ветер ослаб - маховик крутится сам - уже без винта.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">roman8301</div><div class="date">11.07.2011, 15:30</div></div><div class="posttext">сугубо мое мнение : чем легче винт тем больше возьмеш с порыва ветра вывел опытным путем правда у вертикалки (но это по моему без разницы), чем тяжелее ( в разумных пределах)  тем эфективнее он на плавных изменениях скорости ветра, так что надо учитывать у кого какие ветра. но я больше скланяюсь к легким винтам.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">11.07.2011, 21:42</div></div><div class="posttext">сугубо мое мнение : чем легче винт тем больше возьмеш с порыва ветра вывел опытным путем правда у вертикалки (но это по моему без разницы), чем тяжелее ( в разумных пределах)  тем эфективнее он на плавных изменениях скорости ветра, так что надо учитывать у кого какие ветра. но я больше скланяюсь к легким винтам.<br />
<br />
Всё правильно, теория говорит о том же самом.<br />
<br />
Добавлено через 3 минуты<br />
А применить принцип велосипедного колеса?<br />
Есть ветер - появляется тяга, ветер ослаб - маховик крутится сам - уже без винта.<br />
<br />
Колесо на верх поднимать не фонтан, а вот если вал протащить вниз и внизу маховик с обгонной муфтой поставить, то из этого что-нибудь может получиться. Такую систему Уфимцев на своем ветряке применял.<br />
<br />
Ходил я в поход до местного дома технического творчества (у них этот ветряк во дворе стоит), да вот директора не застал - поступила информация о том, что он готов поделиться чертежами и прочим по этому ветряку...  Когда-нибудь доберусь.<br />
<br />
Добавлено через 3 минуты<br />
Что касается MPPT, то тот принцип, который предложил Tema0 в самом начале темы можно использовать для того, чтобы на ходу определить скоростные характеристики произвольного ротора ветряка, а дальше, зная характеристики им можно управлять получая максимум возможной отдачи. <br />
<br />
Если что, я готов взять на себя математическое обеспечение (алгоритм расчета), вот только в ассемблер под МК перевести не смогу (не силен).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheese</div><div class="date">10.08.2011, 12:59</div></div><div class="posttext">Продолжение темы будет?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">11.08.2011, 01:22</div></div><div class="posttext">А что, Есть предложения?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheese</div><div class="date">11.08.2011, 11:06</div></div><div class="posttext">petruha256, а если так http://www.nxp.com/documents/data_sheet/MPT612.pdf<br />
<br />
Добавлено через 59 секунд<br />
для начала, это - http://www.rlocman.ru/news/new.html?di=66612<br />
<br />
Добавлено через 24 минуты<br />
http://www.west-l.ru/uploads/tdpdf/lt3652hv_eng_ds.pdf<br />
<br />
Добавлено через 32 минуты<br />
простая схемка МРРТ http://www.terraelectronica.ru/print.php?from=3&amp;ID=277</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">11.08.2011, 22:58</div></div><div class="posttext">Причем здесь МРРТ для ветряка? <br />
Там только реклама про солнечные МРРТ.<br />
Вам суть темы понятна? <br />
Здесь речь совсем о другом. Энергия от ветряка меняет свои параметры совершенно по другим законам, не таким как энергия от солнечных панелей, соответственно и подходы нужны другие.<br />
<br />
Схему и программу сможете осилить под готовый алгоритм управления?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheese</div><div class="date">12.08.2011, 10:50</div></div><div class="posttext">У меня есть инвертор с МРРТ ведомый сетью &quot;грид тию&quot;, предназначенный для подключения к солнечным батареям, в нем имеется возможность подключения ветряка через &quot;дамп лоад&quot; контроллер ( самое главное не превысить напряжение на которое расчитан инвертор). Так что нет разницы солнечные батареи или ветряк. Задача найти максимум мощноси в данный момент времени при данных условиях.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">12.08.2011, 19:55</div></div><div class="posttext">Найти максимум мощности в данный момент времени для ветряка не может  быть решена перебором нагрузки, как это решено в солнечных MPPT  контроллерах.<br />
<br />
Причина такова: винт имеет инерционность, и можно увеличивать нагрузку до  тех пор, пока растет мощность (Rвнутр=Rвнешн), и она будет расти при  этом сажая винт на нерасчетную быстроходность, т.е. за пиком пойманной  мощности будет следовать провал, <br />
последующая попытка отпустить нагрузку приведет к медленному росту  оборотов и медленному же росту мощности, за этот период ветер может  несколько раз усилиться и ослабеть при этих вариациях нагрузки куча  энергии пройдет мимо винта.<br />
Для правильного отбора мощности, с целью получения максимальной отдачи  контроллер должен управлять нагрузкой основываясь на скоростных  характеристиках винта. <br />
Ваш &quot;dump load&quot; контроллер делает это? Или у Вас только имеется  возможность подключения ветряка к солнечному MPPT через этот самый &quot;domp  load&quot; Контрллер?<br />
<br />
Дайте ссылку на контроллер ветряка, который заточен под получение  максимума энергии, чтобы описание того, что он делает было. Мне пока не  встречались контроллеры, для малых ветротурбин с такими функциями.<br />
Ограничение тока - да, защита от перезаряда - да, защита от аварийных  режимов - да, стабилизация частоты и/или напряжения - да, получение  максимума мощности - нет.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">12.08.2011, 21:55</div></div><div class="posttext">petruha256, <br />
Такие контроллеры, точнее, Grid Tie для ветряка имеются в природе, их &quot;Ginlong&quot; производит. Стоят дорого. А алгоритм там простой. В память устройства загружают таблицу &quot;напряжение - мощность&quot; от конкретного ветряка, правда, эту таблицу, как минимум, нужно ещё иметь. Sercat в своём контроллере отбора мощности реализовал функцию MPPT, его схема весьма непроста и не всякий из нас сможет её повторить, в том числе, и по деньгам. Интересно было бы создать такое устройство, которое многие могли бы самостоятельно повторить. Фактически, нужно следить за скоростью вращения винта и понемногу увеличивать нагрузку, если скорость растёт, а если снижается - то уменьшать. Весь диапазон мощности поделить на, скажем, 64 градации, в процессе работы по одной увеличивать или уменьшать (например, единица и 63 нуля - это самая малая мощность, это число загружается в сдвиговый регистр и в последовательном коде выплёвывается, управляя ключом ШИМ), при этом следя за скоростью винта. Как-то так... Или около того... :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">17.08.2011, 00:59</div></div><div class="posttext">..... А алгоритм там простой. В память устройства загружают таблицу &quot;напряжение - мощность&quot; от конкретного ветряка, правда, эту таблицу, как минимум, нужно ещё иметь. ....<br />
<br />
Эту таблицу можно получать автоматически для некоего ветряка стандартного исполнения, но практически любой мощности.<br />
<br />
Идея такова:<br />
<br />
Допустим контроллер, имеет возможность отслеживать угловую скорость ротора (по частоте тока до выпрямителя) и имеет возможность выдавать некий управляющий сигнал, который определяет отбираемую мощность (или скважность сигнала или сопротивление нагрузки).<br />
<br />
поскольку угловая скорость известна, то и угловое ускорение тоже определяется (дифференциал за несколько тактов по частоте тока).<br />
<br />
Теперь задача при наличии ветра остановленный винт отпустить без нагрузки, но измеряя частоту  (угловую скорость) и вычисляя дифференциал частоты (угловое ускорение).<br />
<br />
поскольку нагрузки нет, то вся мощность, которую винт получает от ветра пойдет на увеличение кинетической энергии ротора, это увеличение кинетической энергии/время=J*угловую скорость*угловое ускорение.<br />
пока винт не выйдет на холостые обороты - нужно каждый момент времени замерять и вычислять произведение угловой скорости на угловое ускорение, те обороты, на которых это произведение будет максимально и будут оборотами максимальной мощности для текущей скорости ветра (если измерение несколько секунд, то считаем что ветер не изменился). Несколько замеров дадут возможность уменьшить ошибку, связанную с допущением о неизменности скорости ветра за период замера.<br />
<br />
теперь зная нужные обороты заставляем контроллер подобрать такое значение управляющего сигнала, при котором винт из холостого хода вернется обратно на эти (полученные) обороты и при этом не будет ни ускоряться ни разгоняться. <br />
<br />
в результате всех этих мучений у нас есть одна точка соответствия оборотов винта и значения управляющего сигнала.<br />
и если в следующий раз при том же самом ветре сразу влупить это значение управляющего сигнала, то это и будет пик мощности, который контроллер сможет отобрать от винта.<br />
<br />
так делаем несколько раз, получаем точки соответствия для разных оборотов винта (и ветра, соответственно). Получится искомая таблица для любого винта.<br />
<br />
Фокус в том, что ветер измерять не нужно, и вообще больше ничего измерять не нужно.<br />
<br />
<br />
Когда будет таблица можно усложнить задачу, например оптимальное отрабатывание порывов ветра. Я об этом писал, но повторюсь.<br />
<br />
Если винт работает в номинале и вдруг стал разгоняться, его не нужно догружать, это значит, что скорость ветра увеличилась, а быстроходность винта упала. <br />
Если винт оставить на этой нагрузке, то пока он не выйдет на номинальную быстроходность для нового ветра - он будет недобирать мощности от ветра, пропуская поток через себя. Время, которое необходимо для выхода винта на номинал зависит от его момента инерции и от мощности, отбираемой генератором.<br />
Так вот, если нагрузку при разгоне винта снять, то на номинал он выйдет быстрее и меньше мощности потеряет. при этом мощность, не отобранная генератором накопится в роторе (винте).<br />
Тут главное вовремя винт &quot;подхватить&quot;, включив нагрузку - этот момент поддается расчету, и чтобы не мучить контроллер сложными вычислениями точно так же свести в таблицу.<br />
<br />
При падении скорости винта - наоборот, нужно добавить нагрузку с той же самой целью, и потом вовремя её уменьшить, как только винт выйдет близко к номиналу.<br />
<br />
В голове сидит еще целая куча подробностей, о том, как упростить и ускорить процесс измерений.<br />
<br />
Вот кто бы аппаратную часть взялся изобрести...:unknw:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">hecs</div><div class="date">17.08.2011, 12:43</div></div><div class="posttext">Вот кто бы аппаратную часть взялся изобрести...<br />
Эх, серката бы на это дело подписать, вот где голова да руки...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">17.08.2011, 20:00</div></div><div class="posttext">Да, действительно, но боюсь не дождемся, он ведь далеко вперед ушел, ему сейчас свои изделия до ума доводить, а не новые разрабатывать.<br />
Неужели больше никто не рубит в микроконтроллерах? Если нет, то нужно развернуть бурную деятельность по привлечению специалистов.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheese</div><div class="date">18.08.2011, 09:11</div></div><div class="posttext">полностью поддерживаю и пытаюсь сам начать с азов по мк</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">23.08.2011, 18:30</div></div><div class="posttext">Здравствуйте. Так получилось, что я как раз дошел в своем ветряке до этой темы. <br />
Кому интересно может посмотреть, что сделано в &quot;Участниках&quot;.<br />
 <br />
Генератор у меня намного мощнее винта, поэтому падением напряжения на генераторе я перенебрегаю (0.5 ома фаза)<br />
Сейчас делаю контролллер с таким принципом работы:<br />
Есть анемометр.<br />
По таблице определяется оптимальное напряжение при текущей скорости ветра. Т.е. в моем случае это эквивалентно оптимальным оборотам.<br />
Ветряк отпускается до этого напряжения. Вычисляется скважность понижающего sepic преобразователя. Если не ошибаюсь выходное напряжение равно входному умножить на скважность. Таким образом контроллер отпускает ветряк до нужного напряжения и выставляет необходимую скважность. Ну в общем все. Ветряк работает на оптимальных оборотах и всю мощность выдает на аккумулятор. (естественно минус потери преобразователя, диодного моста и т.д.)<br />
В этой схеме могут быть подводные камни. <br />
Первый это дроссель. Чтоб он работал в диапазоне 2-50 А при 70Кгц по моим расчетам размер его оставляет желать лучшего. 310 мкгн 55А кольцо с зазором 20мм 120х80х24, 37 витков. И то неплохобы сделать еще больше индуктивность на малые токи, но тогда совсем огромный получается.<br />
Второй нерешенный вопрос как это все будет вести себя при порывах ветра. На даче ветер зачастую именно такого характера.<br />
Таблицу соответствия думаю сначала от балды сделать (т.е. как я думаю оно должно быть), потом писать лог на сд карточку каждую секунду и как-то менять таблицу до получения оптимальных параметров.<br />
Все это будет работать на пик контроллере, там есть встроенный ШИМ. В принцие ничего сложного в пиках нету. Естественно если иметь минимальные навыки в программировании на С. Могу посоветовать компилятор PIC-C, много примеров и функции достаточно высокоуровневые.<br />
 <br />
Пока из того что сделано. Ветряк, подключенный напрямую (естественно выдаваемая мощность смешная), балластный контроллер заряда аккумулятора. Есть плата с пиком, которая осталась от прошлых проектов с 2-х сегментным индикатором. Практически сделал дроссель, развел плату под драйвер транзистора. Пока думаю вручную контроллировать скважность и входное напряжение и проверить жизнеспособность идеи. Потом поставлю анемометр, СД карточку, ЖК экранчик.<br />
 <br />
P.S. Если думаете начинать изучать микроконтроллеры ИМХО лучше брать ARM, стоимость уже приемлемая, возможности несравнимо больше. Сложность изучения сильно преувеличена, можно найти соответствующие статьи по изучению с нуля.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">23.08.2011, 20:43</div></div><div class="posttext">Вот агрегат Sercat'а   http://www.youtube.com/watch?v=PbkPS96O4lE.<br />
<br />
Там в конце видно, как контроллер отображает параметры агрегата - обороты, мощность. и видно, как ветер неадекватно гуляет по отношению к оборотам и к мощности.<br />
<br />
По цифрам однозначно видно, что регулирование нагрузки жестко завязано на обороты винта через кубическую зависимость (и это правильно), а вот на скорость ветра она не завязана. На напряжение думаю завязывать регулирование не стоит, лучше взять частоту тока до выпрямителя. Ведь когда винт будет помощнее - от сопротивления обмоток уже не отмахнешься.<br />
<br />
Нужна таблица - обороты-мощность для конкретного винта. <br />
а чтобы от балды не писать эту таблицу - см. выше.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">23.08.2011, 23:22</div></div><div class="posttext">У меня есть 2 аргумента насчет регулирования от оборотов. <br />
Первый и самый главный в моем случае. Многое уже сделано, нужно довести до ума и проверить как будет работать. Проверить результат довольно легко. Известно примерно сколько при какой скорости ветра теоретически может выдать трехлопастник 1.7 метра из ПВХ труб. Сравнивая с этим значением получим эффективность контроллера. <br />
 <br />
Ну и второй агрумент более теоретического плана. Насколько я понимаю процесс, максимальный киев турбины при заданной скорости ветра достигается на определенных оборотах. Соответственно логично мерять скорость ветра и заставлять вращаться турбину на максимально эффективных оборотах. Я себе упростил жизнь мощным генератором с маленьким сопротивлением. Но в любом случае эту модель можно доработать включив в параметры сопротивление генератора и видимо еще момент энерции вращающихся частей. Но это уже совсем круто :) Но вы тоже правы. Фактически скорость ветра можно вычислить проанализировав обороты и снимаемую мощность за какой-то промежуток времени. Но лично мне легче вцепить анемометр. Слишком много может быть неучтенных параметров.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">24.08.2011, 00:01</div></div><div class="posttext">Сравнивая с этим значением получим эффективность контроллера.Это при КПД генератора 100% и оно не должно изменяться. <br />
<br />
Я себе упростил жизнь мощным генератором с маленьким сопротивлением.С первой частью согласен, со второй нет. Само по себе сопротивление ни о чём не говорит. А уже в паре с вырабатываемой ЭДС, Да. Вон болгарин лежит с сопротивлением 0,4 Ом. Ну и что? А при 300 об/мин 4,7Вольт ЭДС. Так что сопротивление может быть и 20Ом, а если ЭДС при этом 500V то максимальная мощность уже больше 3кВт...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.08.2011, 00:02</div></div><div class="posttext">видно, как ветер неадекватно гуляет по отношению к оборотам и к мощности<br />
Поэтому Sercat отказался от анемометра и убрал его с хвоста ветряка. Его контроллер изначально был без анемометра, он его впоследствии добавил, для эксперимента. Мне в разговоре сообщил, что решил его убрать, поскольку показывает он непонятно что.<br />
Вообще, даже не совсем понятно, куда этот анемометр ставить. У меня стоит отдельно от ветряка, чуть ниже нижней кромки винта и немного в стороне, примерно в четырёх метрах. И я замечал, что анемометр показывает одно, а винт - всё строго наоборот. Данные признавал достоверными, если не менее десяти секунд мощность с ветряка совпадает с тем, что должно быть согласно показаниям анемометра. Но такое получается весьма редко и весьма непросто подловить. От анемометра придётся отказываться и реализовывать совсем другой тип алгоритма.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">24.08.2011, 00:07</div></div><div class="posttext">Действительно, логично было бы мерить скорость ветра, а нагрузкой загонять винт в расчетные обороты для этого ветра. Но фокус в том, что анемометр будет стоять на расстоянии от винта и при порывистом ветре измеренные значения скорости ветра будут сильно отличаться от ветра на винте.<br />
<br />
В том видео в принципе видно, что инерция винта не очень высока (обороты набирает быстро и сбрасывает тоже).<br />
и получается такая беда - если мощность завязывать на обороты то погрешность будет идти от инерции, а если на скорость ветра то погрешность будет идти от несоответствия показаний анемометра.<br />
<br />
Как раз внимательно изучив показания на дисплее контроллера в том видео можно сделать вывод о том (тупо посчитать), в каком случае погрешность будет меньше.<br />
<br />
.....<br />
Стоило на 5 минут зазеваться и все мои мысли уже написаны....:))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">24.08.2011, 00:08</div></div><div class="posttext">Это при КПД генератора 100% и оно не должно изменяться.<br />
 <br />
Ну с этим можно поспорить. Где-то на форуме есть табличка, с зависимостью вырабатываемой мощности от скорости ветра. Подразумевается ветряк с идеальным согласованием нагрузки. Ну и что ветряк крутится на оптимальных оборотах. Именно эти условия и должен обеспечить контроллер.<br />
 <br />
Насчет видео тут скорее вопрос реализации, а не теории. Мне все-таки не верится, что анемометр в нескольких метрах от ветряка будет показывать принципиально другие значения. Конечно в идеале нужно учитывать инерцию ветряка, на больших турбинах при порывистом ветре это будет особенно заметно. Нужно какую-то сложную математическую модель строить.<br />
 <br />
Думаю недели 3-4 осталось до полной реализации того контроллера, что я задумал в &quot;железе&quot; так сказать. Дальше вопрос программирования. Можно будет опробовать разные варианты.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.08.2011, 00:19</div></div><div class="posttext">Скорость винта можно измерить достаточно быстро и, несмотря на ощутимую инерцию, поймать начало изменения режима в самом зародыше. Контроллер успевает измерить длительность половины периода и при этом ещё сравнить с тем, что было прошлый раз. А затем снова измерить - на следующем импульсе - и снова сравнить. А дальше нужно думать, что с этим делать и как.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">24.08.2011, 00:32</div></div><div class="posttext">... А дальше нужно думать, что с этим делать и как.<br />
<br />
Уже всё придумано, вопрос в железе.<br />
<br />
Добавлено через 8 минут<br />
<br />
Насчет видео тут скорее вопрос реализации, а не теории. Мне все-таки не верится, что анемометр в нескольких метрах от ветряка будет показывать принципиально другие значения. <br />
<br />
Принципиально другие - не будет, но существенно отличающиеся - запросто.  Именно по этой причине я бросил затею с обработкой целой кучи результатов испытаний ротора Дарье. Записей - куча (запись велась синхронно скорость ветра - мощность) за месяц не обработать. А вот вытащить из этих записей результаты при которых ветер и мощность показывают адекватное соответствие практически не удалось, так - несколько точек замера...<br />
<br />
Вот и лежат уже полтора года... необработанные.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.08.2011, 00:47</div></div><div class="posttext">Пока у меня винт стоял низко над землёй, я носился с датчиком анемометра, как дурень со ступою, стремясь воткнуть его в землю строго перед винтом в паре метрах. Тогда более-менее что-то получалось. Но вот незадача: на уровне земли уж больно ветер непостоянный. Ну его, анемометр этот... Так только, чтобы знать, что ветер вообще дует...:)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">24.08.2011, 00:51</div></div><div class="posttext">Пока ходил в магазин таки понял, что контроллировать соответствие оборотов мощности наверно более правильно.<br />
 <br />
Например, в контроллере таблица соответствия оборотов вырабатываемой мощности. Если вырабатывает больше заданной в таблице отпускаем ветряк, если мощность меньше значит работает вхолостую и тормозим. Да и частоту измерить легче чем с анемометром играться. <br />
 <br />
Даже оптимальные обороты  и мощность посчитать можно и предварительно занести в таблицу.<br />
 <br />
Всем спасибо, что надоумили.<br />
 <br />
Теперь разобраться надо как датчиком холла силу тока мерять.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">21.11.2011, 11:07</div></div><div class="posttext">А зачем измерять силу тока датчиком холла??? <br />
да и вообще... зачем нам сила тока как таковая...<br />
есть другое решение.<br />
мы оперируем мощностью на выходе системы. посему измерять нужно именно мощность.<br />
т.к. в основном у народа проблемы с программированием, то нужно процесс перемножения вынести наружу.<br />
а именно ... поставив измерительный шунт снять с него напряжение (пропорциональное току в нагрузке) и перемножить с текущим напряжением исползуя аналоговый перемножитель двух сигналов...<br />
например вот такой http://w-metr.narod.ru/<br />
с выхода этой преблуды мы имеем сигнал ( напряжение) пропорциональное отдаваемой в нагрузку мощности...<br />
ее мы и загоняем в PIC и на нее мы ориентируемся при манипуляциях с нагрузкой</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">21.11.2011, 15:56</div></div><div class="posttext">Сложность в том, на сколько на данный момент разобрался в теме с MPPT - это адаптивность нагрузки. То есть нагрузка должна быть с максимальным отбором мощности в определённый момент времени, естественно зависящий от силы ветра. И без неё, перемножитель просто займётся измерением напряжения к сожалению. Думаю в ПИКе должно присутствовать семейство нагрузочных характеристик генератора, а не зря предлагаемый датчик (и лучше не один, а как можно больше) Холла позволит с большей точностью следить за угловым ускорением, что в итоге будет говорить о мощности на валу<br />
, которую можно использовать опять-же в данный момент времени.<br />
 <br />
Измиритель мощности нам тоже нужен будет для контроля максимальной нагрузки на генератор, для предупреждения его перегрева, допустим информируя об оставшемся 10% запасе от максимально выдаваемой мощности.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">21.11.2011, 16:45</div></div><div class="posttext">Лишнее это.... <br />
разбиваем задачу на две части... абсолютно разных<br />
1. Выжимание максимума из источника<br />
ну давай пока для упрощения представим что нагрузка - есть бездонная бочка и о ней мы ничего не знаем<br />
а наш контроллер - это кран, регулирующий напор подаваемой в бочку воды из некоего неизвестного нам источника.<br />
для прояснения пишу что НАПОР - ЭТО КОЛИЧЕСТВО ПРОХОДЯЩЕЙ ЧЕРЕЗ СИСТЕМУ ВОДЫ В ЕДИНИЦУ ВРЕМЕНИ<br />
и заведомо решим... что забирая из источника энергию мы на него влияем, по пофиг какому закону... нам это не важно... важно что влияем!!!<br />
т.е безоговорочно нагрузка сможет утилизировать 100% мощности которую мы в нее запихнем.. (как это делается позже решим)<br />
есть у меня параметр - мощность (напор) я его могу прекрасно оценить при помощи некоего &quot;Ваттметра&quot; <br />
а теперь используя кран и ваттметр нужно добиться такого режима, чтобы напор был максимален...<br />
крутя кран мы по неизвестным нам законам влияем на источник(ветроголовку)...<br />
измеряя мощность мы делаем вывод - позитивно эти изменения сказались или негативно...<br />
если позитивно, то повторяем это действие с некоторым таймаутом на некоторую величину, если напор уменьшился то совершаем действие обратное с некоторым таймаутом на некоторую величину.<br />
<br />
таймаут  и Величина это константы зависящие от механических свойств системы... как то масса инерция и.т.д. но и они могут быть найдены автоматом в ходе недлительного процесса &quot;стартового обучения&quot; системы<br />
<br />
на мой взгляд все понятно.<br />
термины которые тут использованы: кран  - ШИМ<br />
для отладки этой части программы используем банальное КЗ в качестве бездонной бочки<br />
<br />
2 часть - утилизация этого максимума.... <br />
за ранее решаем что для универсальности и повторяемости нагрузка и ее характер нам неизвестны...<br />
а дальше напишу если сообщество одобрит первую часть алгоритма</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">21.11.2011, 18:19</div></div><div class="posttext">Что то уж больно всё сложно. Я не знаю что вы задумали, но в моём варианте должно всё быть проще. Я знаю какая нужна нагрузка при достижении определённого напряжения на выходе генератора.<br />
У меня 4 ступени, напруга поднимается до 60 вольт подключается первая нагрузка - 98 Ом, напряжение поднялось до 75 вольт, ещё один тен - и того 48 ом. Растёт дальше и при 90 волтах подключается ещё 2 тена = 24,5 ома. Выростает до 110 вольт подлючается ещё 2 тена = 16 Ом - это полная нагрузка гены. Защита срабатывает когда генератор выдаёт 130-150 вольт (хвост складвается)<br />
Зная напряжение и сопротивление нагрузки можно расчитать линейность. Помоему это самый простой вариант.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">21.11.2011, 21:41</div></div><div class="posttext">Помоему это самый простой вариант.<br />
И самый неудачный...<br />
Такой вариант не отслеживает точку наибольшей мощности, а только приблизительно, да и то с большой натяжкой, подгоняет несколько точек на кривой винта. Да и использование нагрузки из кучи переключающихся ТЭНов не является лучшим способом. То, что предлагает Tema0, должно работать на любую нагрузку, к которой оно должно само приспосабливаться. И на любом ветряке. Именно к этому нужно стремиться. А сложным всё будет выглядеть до тех пор, пока не будет отточен алгоритм.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">21.11.2011, 22:37</div></div><div class="posttext">to Tema <br />
Алгоритм то правильный и красивый, но надо иметь время и здоровье это все реализовать. В этом году времени хватило только на реализацию, похожую на алгоритм Baysun. Только ступеней нет (у меня это скорее контрольные точки), переключение от мощности и тенов нет (импульсный преобразователь все утилизирует). <br />
В вашем алгоритме может быть много подводных камней. Например то, с чем конкретно я столкнулся. Меряем мощность, меняем ШИМом параметры преобразователя, меряем опять. Что получается. ШИМ отпустил турбину и пока она не раскрутилась до новых оборотов измеряемая мощность равна нулю. Если померять невовремя, получим неправильный вывод о напрявлении изменения параметров преобразователя. Если сделать таймаут слишком большим турбина будет раскручиваться недостаточно резво. А ветер часто бывает порывами.<br />
 <br />
Появилось сегодня немного времени, накидал схему своего контроллера. В ней пока только блок самого микроконтроллера. Дальше выложу схемы датчиков напряжения, тока, оборотов. Схема импульсного преобразователя есть в учасниках, потом тоже нормально сделаю (она простая как 5 копеек). В архиве есть еще архив с проектом microC. <br />
Важно!!! если вы не понимаете что происходит в схеме не вздумайте ее делать. Сам девайс на даче, делал по памяти. То, что я сейчас выкладываю это скорее подсказка для конструирования своего контроллера.<br />
 <br />
http://windpower-russia.ru/forum/attachment.php?attachmentid=4977&amp;stc=1&amp;d=1321897108<br />
 <br />
З.Ы. Универсальность не всегда хорошо. Наиболее реальным и простым вариантом я думаю будет снять нагрузочную характеристику турбины и отталкиваться от этого.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">21.11.2011, 23:22</div></div><div class="posttext">Свои пять копеек.<br />
Предположим, что ветер Х м/с, из скоростной характеристики турбины  знаем, что на этом ветре она должна вращаться со скоростью Y и при этом  выдавать мощность Z. Способ измерения мощности, как предложил Tema0 в посте #51.<br />
  <br />
теперь алгоритм<br />
первый вариант - частота вращения (измерять по частоте тока ) из таблицы  (в ROM) дает значение мощности, которое  нужно получить, если оно  превышает измеренное значение мощности то меняем скважность в одну  сторону, если меньше измеренного значения мощности - скважность в другую  сторону.<br />
  <br />
  <br />
второй вариант - так же как в первом варианте измеряем обороты и мощность,<br />
подгоняем скважностью мощность в соответствие с табличным значением<br />
  <br />
еще измеряем угловое ускорение (дифференциал частоты).<br />
значение дифференциала частоты (опять же из скоростной характеристики  турбины) однозначно дает значение действующей скорости ветра в настоящий  момент. <br />
Если дифференциал=0, значит обороты турбины соответствуют расчетным для  текущего ветра -  никаких действий, продолжаем отслеживать соответствие  мощности текущим оборотам<br />
  <br />
Если дифференциал&gt;0, значит обороты турбины  растут, что по скоростной характеристике дает значение большей скорости   ветра и больших расчетных оборотов - отпускаем винт на холостую  (или 20% или хз сколько% от расчетной нагрузки), до тех пор, пока  обороты не станут  расчетными для новых условий, после чего врубаем  нагрузку для новых расчетных оборотов.<br />
<br />
Если дифференциал&lt;0, значит обороты турбины падают, что по скоростной характеристике дает значение меньшей скорости   ветра и меньших расчетных оборотов - грузим винт по полной  (200% или хз сколько% от расчетной нагрузки, но с ограничением по току, дабы генератор не спалить), до тех пор, пока  обороты не станут  расчетными для новых условий, после чего снижаем  нагрузку до соответствия новым оборотам.<br />
<br />
Дабы предупредить вопросы об отпускании и перегружении винта (об этом  писалось уже, но повторю). при резком увеличении скорости ветра винт  работает с недобором оборотов, пока не выйдет в номинал, чем дольше он  выходит, тем больше ветра пропустит сквозь себя и недоберет энергию.<br />
при резком падении скорости ветра - винт работает с перебором оборотов, и  чем дольше он замедляется, тем больше воздуха обойдет винт стороной -  опять недобор.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">22.11.2011, 04:07</div></div><div class="posttext">petruha256, <br />
Вполне допустимо не уменьшать нагрузку на винт при порывах. Порыв никогда не бывает абсолютно мгновенным, усиление ветра происходит хоть и быстро, но не скачком. А окружная скорость винта достаточно высока и существенно превышает скорость ветра при порыве. Поэтому изменение угла набегания невелико и винт очень быстро разгоняется. Эти выводы сделаны при наблюдении за моим винтом, который продолжает меня удивлять своей работой, в том числе и при порывистых ветрах.<br />
Можно для начала создать базовый алгоритм отслеживания точки пика мощности, а уже потом можно его изменять в нужную сторону.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">22.11.2011, 11:30</div></div><div class="posttext">krauser2 хотел посмотреть твою ссылку, пишет &quot; вложения не существует&quot;. Что там?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">22.11.2011, 11:44</div></div><div class="posttext">petruha256,<br />
зачем отслеживать дифференциал частоты? достаточно отслеживать дифференциал мощности чтобы сделать вывод о правильности действий...<br />
по тому как при нагруженном генераторе мощность и обороты имеют прямую зависимость, посему достаточно измерять последний параметр.<br />
для того чтобы идти вашим путем, нам обязательно еще нужно скорость ветра измерять только имея скорость ветра мы сможем правильно использовать данные о скорости вращения.<br />
<br />
НО... я уже писал... это все лишнее. для того чтобы снять максимум мощности с ветряка в конкретный момент времени нам кроме величины мощности отдаваемой ветряком больше ничего и не нужно. Все временные задержки которые будет иметь система выявляются на этапе &quot;обучения контроллера&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">22.11.2011, 12:32</div></div><div class="posttext">Как-то косо залил кусок схемы и проект с прошивкой. В часов 6 перезалью<br />
 <br />
to Tema <br />
Нагрузочная характеристика турбины позволяет по мощности и оборотам найти скорость ветра.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">22.11.2011, 12:37</div></div><div class="posttext">пишет &quot; вложения не существует&quot;. Что там?<br />
Да вот и мне интересно. Пишет &quot;Обратитесь к Администрации&quot;. А я кто:scratch_one-s_head:?<br />
Похоже что krauser2, загрузил вложение, а вставить в виде миниатюры посередине текста не получилось. Для выполнения этой процедуры, ему ещё раз нужно заглянуть сюда<br />
 (http://windpower-russia.ru/forum/showthread.php?t=68)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">22.11.2011, 18:12</div></div><div class="posttext">Простите, но как предлагается измерять частоту? :) Допустим в моём проектируемом варианте предполагается выпрямитель упрятать в коробке соединений асинхронника и снижение вести всего двумя силовыми кабелями...с точки зрения надёжности n*контакт ессно.<br />
Tema0 - ваше предложение по измерению мощности без нагрузки как реализовать? Ведь чем большую мощность мы можем снять - тем меньше сопротивление нагрузки, а это есть величина переменная (хочется однозначной зависимости, в пределах погрешности, пропорциональной).<br />
Baysun предлагает вариант ступенчатой нагрузки - мне кажется в этом есть смысл, если в качестве буфера использовать аккумуляторы, а не тэны - без него ведь всё равно никак (Вложить подобную логику переключений в зарядное устройство).<br />
Идея, которая крутится в голове: 1 часть (Генератор - MPPT - Умный зарядник - Блок аккумуляторов), 2 часть (Блок аккумуляторов - Не очень умный преобразователь - Потребители)<br />
Если мощность переменна, то и количество потребителей переменно, разве не так? А городить логику, которая включала бы мне телек, когда на него есть избыток мощности у генератора как-то не совсем айс...<br />
<br />
Добавлено через 23 минуты<br />
А сложным всё будет выглядеть до тех пор, пока не будет отточен алгоритм. <br />
Александр здраствуйте! Может создать ветку с обсуждением входящих переменных? Мне кажется так легче будет определить и сам алгоритм? В том плане, которые мы РЕАЛЬНО и однозначно можем измерить и которые с позволительной погрешностью смогут нам сказать о поведении генератора?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">22.11.2011, 18:49</div></div><div class="posttext">Перезалил<br />
4996</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">22.11.2011, 19:29</div></div><div class="posttext">Дмитрий 31, <br />
Не стоит создавать специальную ветку. А то мы в этих ветках утонем. Всё касающееся алгоритма MPPT обсуждаем здесь.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">22.11.2011, 19:33</div></div><div class="posttext">И всётаки я уверен что есть возможность привязки шим-контоллера к выходному напряжению генератора. У меня осталась таблица характеристик моего гены, я согласно неё и делал свой контроллер и он реально работает!<br />
Давайте прикинем, допустим мой генератор при 350 оборотах даёт 100 вольт при нагрузке 10 ом и винт при 10 м.с. как раз даёт нужную мощность.<br />
Так вот, на максимуме наш контроллер увидя напряжение на входе 100 вольт, должен пропустить через себя 1000 ват - типа пропустить всё то, что выдал ему ветрогенератор. Ветер снизился до 9 м.с., напряжение на генератора упало до 75 вольт, контроллер увидя это, уменьшил частоту сделования импульсов подключения нашего генератора к нагрузке, тем самым довёл нагрузку до 750 ват. Ветер упал до 8 м.с, генератор выдаёт 50 вольт - контоллер подключает нагрузку доводя её до 500 вт. Ну и т.д не важно в каком порядке.<br />
Зависимость от входного напряжения тоже позволяет нагружать винт ровно столько сколько есть на нём мощность - напруга больше, больше и нагрузка. Напруга меньше, меньше и нагрузка.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">22.11.2011, 20:22</div></div><div class="posttext">В итоге, какие переменные можно взять: на мой взгляд кажется достаточным частоты вращения ротора. Для реализации конкретной ВЭУ считаю необходимым использовать семейство ВАХ генератора в зависимости от оборотов.<br />
Для максимального отбора мощности мы должны быть готовы её потребить - отсюда следует, что переменную мощность (позвольте так назвать) мы можем потребить только мнгновенно с минимумом потерь, так как иначе сливаем в балласт (неважно какой) или греем воздух. Значит, в идеальном варианте, в конкретном участке времени, алгоритм определяет конкретную ВАХ из семейства основываясь на приращении угловой скорости (ускорении) вращения ротора.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">22.11.2011, 20:33</div></div><div class="posttext">to Baysun<br />
Естественно вариант регулирования мощности ШИМом (входным напряжением) будет работать, только он требует от пользователя контроллера настройки. Тут насколько я понимаю собираются делать черный ящик с 2-мя парами проводов. Человеку делающего (и разрабатывающего) единственный контроллер для себя такая универсальность ИМХО ни к чему.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">22.11.2011, 23:35</div></div><div class="posttext">petruha256, <br />
Можно для начала создать базовый алгоритм отслеживания точки пика мощности, а уже потом можно его изменять в нужную сторону.<br />
<br />
Согласен, это уже если совсем последние крохи добирать.<br />
А глядя на то, как бодро реагирует ветряк Sercat'а (на ролике с соседнего форума)  на порывы ветра можно смело делать предположение о том, что достаточно первой части алгоритма.<br />
<br />
Добавлено через 3 минуты<br />
petruha256,<br />
зачем отслеживать дифференциал частоты? достаточно отслеживать дифференциал мощности чтобы сделать вывод о правильности действий...<br />
<br />
<br />
Отрицательный диффренциал мощности мы будем иметь как при перегрузе, так и при недогрузе. А дифференциал частоты однозначно укажет на то перегружен винт или недогружен.<br />
<br />
Добавлено через 37 минут<br />
<br />
по тому как при нагруженном генераторе мощность и обороты имеют прямую зависимость, посему достаточно измерять последний параметр.<br />
для того чтобы идти вашим путем, нам обязательно еще нужно скорость ветра измерять только имея скорость ветра мы сможем правильно использовать данные о скорости вращения.<br />
<br />
<br />
Прямую зависимость (кубическую) и связываются между собой (через таблицу например) только если нагрузка согласована.<br />
Измерением только мощности можно выйти на согласование для винта, работающего в более-менее стационарных (по ветру ) условиях.<br />
<br />
вот как работает винт в реальных ветровых условиях http://windpower-russia.ru/forum/showpost.php?p=12741&amp;postcount=41<br />
видно, что обороты гуляют достаточно быстро, и это винт достаточно большой (7 м), на меньших диаметрах обороты будут изменяться еще бодрее. <br />
Как Ваш алгоритм будет работать в подобных условиях без расчета динамики системы сказать сложно, думаю стоит посчитать, чтобы имелось представление.<br />
<br />
Скорость ветра измерять не нужно. Частота вращения, угловое ускорение и электрическая мощность однозначно определяют скорость ветра, причем не на анемометре, стоящем неизвестно где и показывающем неизвестно что, а непосредственно на ветротурбине.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">23.11.2011, 03:26</div></div><div class="posttext">Зависимость от входного напряжения тоже позволяет нагружать винт ровно столько сколько есть на нём мощностьА при работе на АКБ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">23.11.2011, 03:58</div></div><div class="posttext">Сергей, А это уже совсем другая история. За АКБ нужно следить, не допуская его перезаряда, а всё лишнее сбрасывать в балласт. Так, кстати, Sercat делает. У него там могучий алгоритм, он вычисляет нагрузку на винт, основываясь на куче параметров, параллельно следит за АКБ и ещё много чего делает. Нам до этого ещё не так просто будет дойти, а надо бы.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">23.11.2011, 05:12</div></div><div class="posttext">Александр, я к тому, что на напряжение базироваться нельзя. И уж если не на ветер, тогда на обороты турбины. В нашей так сказать любительской практике, я думаю не очень сложно будет найти на конкретной ВУ точки максимальной мощности на разных ветрах. Предполагаю, что соединив эти точки на графике мы получим некую кривую в виде параболы. А любая линия, это множество точек. А вот где, как и сколько этих точек прописать? Это уже вопрос другой. <br />
baysun,  это сделал из четырёх ступеней с помощью стабилитронов. <br />
krauser2,  может прописать эти точки в PIC контроллер.<br />
Так как я не владею программированием, то мне наверное будет легче всего, нечто подобное реализовать задавая крутизну усиления ОУ.<br />
Или я где-то в основных понятиях уже ошибаюсь?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">23.11.2011, 05:13</div></div><div class="posttext">krauser2,  полностью согласен:<br />
Тут насколько я понимаю собираются делать черный  ящик с 2-мя парами проводов. Человеку делающего (и разрабатывающего)  единственный контроллер для себя такая универсальность ИМХО ни к  чему.Можно ещё добавить, что-бы этот ящик сам и определял эти  точки максимума. А то моторошное это занятие  записывать показания  нескольких приборов, а потом ещё и всё анализировать. Плюс ко всему,  нужного ветра нужно ещё дождаться:).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">23.11.2011, 06:55</div></div><div class="posttext">А при работе на АКБ?<br />
<br />
А что меняется? В конце концов легко поставить 2 паралельные системы, одна для работы на АКБ, вторая включится при достижении на АКБ 14 вольт и будет скидывать всё на тен - это очень легко реалезуемо.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">23.11.2011, 09:47</div></div><div class="posttext">вторая включится при достижении на АКБ 14В Опять ты не понял. При работе на тен, у тебя напряжение гуляет туда сюда и это напряжение ты берёшь на управление подключения дополнительной нагрузки. Если работа на АКБ, так ты где хочешь его меряй, хоть до моста переменку, хоть после моста постоянку, оно будет одинаковым на любом ветре.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">23.11.2011, 10:53</div></div><div class="posttext">Вопрос: После ШИМ преобразования выбираем Uвых=const, ведь так?<br />
Предложение: Для управления ШИМом (MPPT) установить таходатчик(и), и получать с него(них) уже цифровую зависимость поведения ротора во времени. Эту зависимость заполнять импульсами задающего генератора ШИМ и результирующий сигнал использовать для управления силовым драйвером. Чем больше скважность - тем больше проходит импульсов управления драйвером. В режиме максимальной мощности генератора скважность импульсов управления 2.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">23.11.2011, 11:03</div></div><div class="posttext">Срегей, ты опять не прав. На акуме напруга тоже гуляет, ведь не зря ставят баластники. Другое дело она там гуляет в малых пределах. Кто мешает взять от баластного регулятора сигнал и подать его на шим? Тогда при достижении напряжения на акуме до 14,5 вольт, начинает работать вторая цепь, которая греет воду. Навсякий случай можно дополнительно поставить и баластник с повышеным напряжением, тапа поднялась напруга до 15 вольт, пусть скидывает с самого акума.<br />
<br />
Кто в английском шарит, посмотрите ссылку http://www.national.com/en/<br />
Тут вроде можно подобрать нужные детали по параметрам</div></div><hr />


<div class="post"><div class="posttop"><div class="username">krauser2</div><div class="date">23.11.2011, 12:19</div></div><div class="posttext">Я у себя балластный регулятор сделал отдельно. Поставил и забыл, а контроллер пусть более интеллектуальными вещами занимается.<br />
Меряем контроллером мощность - выставляем скважностью ШИМа соответствующие мощности обороты. Алгоритм предельно прост.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">roman8301</div><div class="date">23.11.2011, 12:27</div></div><div class="posttext">baysun я тут немного поразмышлял и пришел к выводу что мерить нужно только ветер и мощность и больше ни какие параметры не помогут, тем более надо мерить для каждого винта индивидуально,вот моя мысль, при определенном ветре ваш винт вырабатывает определенную мощность, берем преобразователь который делал павел от бойко помоему, на tl 494 я так понял за частоту импульса этой микросхемы отвечает какое то сопротивление между двумя ножками и подает сигнал на полевик через который у нас и будет проходить ток на аккумулятор ( по поводу TL494 это мои догадки может это и не так но для этого существует что то другое я не электронщик) дальше что мы делаем, смотрим на анемометр например там 5 м\с  начинаем увеличивать частоту открывания полевика( тоесть давать нагрузку)  и как только вольты и амперы перестают увеличиваться (мощность) то тут и будет пик мощности вашего винта на этом ветре дальше замеряем переменное сопротивление которым мы регулировали частоту на полевике, проводим эти эксперименты на тех ветрах которые нам нужно и переменное сопротивление заменяем каскадом замеренных фиксированных сопротивлений подключающихся в зависимости от оборотов или показаний анемометра по моему как то так наверное.:hi:да чуть не забыл сопротивление нагрузки при замере должно быть максимально допустимым  для вашего генератора, а не ваших тенов или аккумуляторов,так как если сопротивление будет увеличиваться то и обороты винта будут расти</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">23.11.2011, 12:37</div></div><div class="posttext">Нет Роман, такой системы мне не надо. Вниз мпо мачте должно спускаться только 3 фазы и ничего более!<br />
Система krauser2 мне подходит на 100%.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">23.11.2011, 16:24</div></div><div class="posttext">roman8301, прав в алгоритме. Видишь, а я до этого и не додумался. Я насчёт управления ТЛкой ступенчато. А вот завязывать управление нужно не на напряжении, которое само гуляет под нагрузкой, ни на ветре- его тоже толком не поймаешь.(Этот момент много раз обсуждался). А проще и достовернее на оборотах генератора. И лишних проводов с мачты спускать не нужно.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">23.11.2011, 17:10</div></div><div class="posttext">Вы придлагаете помимо силовых проводов, вниз ещё опускать и сигналы датчиков? Вполне возможно потребуется жгут из 5-7 проводов и три из них должны быть приличного сечения. Это же утопие.<br />
Можно замерять частоту оборотов прям с фаз, нафига ещё цеплять онемометр?<br />
<br />
Смотрите что нашел http://catalog.compel.ru/ic_dcdc/info/LM5116MH%2FNOPB%20(NSC) Может это то что нужно для нас?<br />
Или вот http://catalog.compel.ru/ic_dcdc/info/LM5116MHX%20(NSC)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">roman8301</div><div class="date">23.11.2011, 17:38</div></div><div class="posttext">А проще и достовернее на оборотах генераторая конечно не специалист но нельзя брать параметры того что вы регулируете, только исходные, а это только ветер и ни какие обороты генератора ни напряжение вам в этом не помогут, сначала надо отколибровать систему через ветер а вот потом только можно воспользоваться оборотами генератора или частотой импульсов как угодно.хотя наверное можно через обороты, нам ведь без разницы какой дует ветер ,просто находить максимальную мощность на разных ветрах фиксировать их смотреть какая частота и опираться на частоту импульсов в принципе так тоже должно работать и ни каких дополнительных проводов будет не нужно(сергей уже сказал), а для вас baysun помоему будет хорошо если будет на выходе импульс с полевика поставите транс  и все, частота там будет вроде бы нормальная, многие кричат что кпд у транса аж 90 с лишним %.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">23.11.2011, 18:37</div></div><div class="posttext">Ну так у меня сейчас трансы и стаят. Только они из за несоответствия частоты, сжирают половину мощности ветряка.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Саня77</div><div class="date">23.11.2011, 21:00</div></div><div class="posttext">baysun, какое сопротивление вторичной обмотки?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">23.11.2011, 21:33</div></div><div class="posttext">baysun, какое сопротивление вторичной обмотки?  У трансов? Я не мерил. Тупо намотал в два провода сечением 1,35 - 175 витков. Зардный ток появляется как раз на нужном напряжении с генератора.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">23.11.2011, 21:49</div></div><div class="posttext">Датчиков на ветряк цеплять не нужно. Хватает полностью того, что идёт с фаз генератора. Частота даёт значение оборотов, произведение тока на напряжение - мощность.Вполне может оказаться, что будет достаточно только обороты измерять и по ним ловить максимальную точку. Нужно измерять знак ускорения турбины: если он положительный, то плавно увеличивать скважность ШИМа от текущего значения до максимума, нужно только подобрать скорость, с какой это делать. Если же знак ускорения отрицательный - то уменьшать скважность ШИМа. ШИМ должен всё время динамически изменяться. Если правильно подобрать скорость этого изменения, то кончится тем, что винт будет стремиться удерживать скорость вращения вблизи вершинки параболы его характеристики, чуть-чуть покачиваясь (в смысле оборотов) влево-вправо. И это должно происходить вне зависимости от скорости ветра и сопротивления подключенной нагрузки, лишь бы оно не было слишком малым. Собственно, этим сейчас и занимаюсь, отрабатывая программу для Атмеги-48.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">24.11.2011, 06:36</div></div><div class="posttext">Александр, вчера с другом, который мне помогает с MPPT пришли в ходе беседы к такому-же выводу. Датчики не нужны. Будем контролировать изменение приращения напряжения с генератора. <br />
В алгоритм закладываем ограничение по мощности генератора сверху. Регулированием тока нагрузки стремимся к минимальной дельте по напряжению.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">24.11.2011, 07:49</div></div><div class="posttext">Можно замерять частоту оборотов прям с фаз, нафига ещё цеплять онемометр?Вот это то что я написал перед твоим постом.<br />
<br />
А вот завязывать управление нужно не на напряжении, которое само гуляет под нагрузкой, ни на ветре- его тоже толком не поймаешь.(Этот момент много раз обсуждался). А проще и достовернее на оборотах генератора. И лишних проводов с мачты спускать не нужно.<br />
А лишний провод тянуть придется. С нулевой точки трёх фаз.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">24.11.2011, 09:19</div></div><div class="posttext">Наконец то приходим к общему мнению, я тоже думаю по частоте можно делать регулировку.<br />
Сергей, а нафига спускать средний провод? Достаточно взять с двух фаз, там таже частота будет только напруга чуток больше. Но это срезается как два пальца.....</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">24.11.2011, 11:22</div></div><div class="posttext">таже частота будет только напруга чуток больше. Но это срезается как два пальца.....Попробуй:). Сделай простой стрелочный тахометр базируясь на 2-х фазах. А вдруг получится:scratch_one-s_head:...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">24.11.2011, 12:48</div></div><div class="posttext">Сергей, так оно мне не надо. Зато я представляю как оно нам потребуется. Ставятся последовательно конденсаторы, резисторы и допустим стабилитроны (или пара-тройка диодов) на вход логики или операциолнника. На выходе будет синусойда в виде квадратиков.<br />
<br />
Скачал несколько програм расчёта дросселя и трансформаторов. Могу скинуть в барахолку если нужно.<br />
Кто нибудь из присутствующих умеет расчитывать торойды? Везде расчёт на 50 герц, а мне надо на 12-15 герц.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">24.11.2011, 14:21</div></div><div class="posttext">baysun, если бы всё было так просто, то на автогенах не выводили бы среднюю точку. И по моему это как раз связано с тахометром.<br />
<br />
Скачал несколько програм расчёта дросселя и трансформаторов.Скинь, посмотрим. А вдруг что то новенькое:)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.11.2011, 18:48</div></div><div class="posttext">Дмитрий 31, Напряжение генератора не совсем подходит, поскольку оно просаживается при увеличении нагрузки. Я смотрю чисто за оборотами, контроллер уже подключен к ветряку и пока работает так, как мне представлялось. Нужно немного его погонять в динамическом режиме, чтобы набрать статистику - а вдруг где-то прячется баг? Дабы оного найти и изловить, нужно время.:)<br />
<br />
Добавлено через 1 минуту<br />
А лишний провод тянуть придется. С нулевой точки трёх фаз.<br />
Зачем?  Это никому не нужно. У меня его нет. А обороты измеряю по двум фазам.<br />
<br />
Добавлено через 1 минуту<br />
Сделай простой стрелочный тахометр базируясь на 2-х фазах. А вдруг получится<br />
Получится.<br />
<br />
Добавлено через 5 минут<br />
на автогенах не выводили бы среднюю точку<br />
Её выводят не для тахометра. Её выводят для других задач. У меня, повторяю, уже полгода ветряк показывает скорость вращения безо всякой средней точки. Нафиг она никому сто лет не нужна!:crazy:Проще нужно смотреть на вещи...<br />
Если нужно сделать гальваническую развязку для измерительной цепи, то делается это до безобразия просто и, кстати, весьма дёшево.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">24.11.2011, 19:05</div></div><div class="posttext">[b]Если нужно сделать гальваническую развязку для измерительной цепи, то делается это до безобразия просто и, кстати, весьма дёшево.<br />
Можно попросить схему?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.11.2011, 20:39</div></div><div class="posttext">Да, схемку я нарисую и выложу. Кстати, какие пределы выходного напряжения от генератора?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Goga65</div><div class="date">24.11.2011, 20:40</div></div><div class="posttext">скорость вращения безо всякой средней точки.<br />
На ВОЛГЕ (вроде 3110)-тахометр взят с одной фазы генератора.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.11.2011, 20:50</div></div><div class="posttext">С тем же успехом он мог быть взят и от двух фаз. Ничего бы не изменилось.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">baysun</div><div class="date">24.11.2011, 21:26</div></div><div class="posttext">Да, схемку я нарисую и выложу. Кстати, какие пределы выходного напряжения от генератора?<br />
У меня по переменке до 120 вольт.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.11.2011, 23:50</div></div><div class="posttext">baysun, <br />
Так, это верхний предел. А нижний какой нужен? Хотя... Это всё можно подбирать в очень широких пределах. Схема состоит из двух частей. Первая часть сделана на трансформаторе. Это для гальванической развязки. Трансформатор может быть любой маломощный, с коэффициентом трансформации 1:4 или 1:5. Скажем, от мелкого сетевого адаптера 220/24 вольта. Ещё потребуются три резистора в районе 1,5 килоом, конденсатор на 10 мкф, два небольшой мощности выпрямительных диодика и два светодиода красного цвета в качестве стабилитронов. У светодиодов есть большое преимущество перед стабилитронами - у них наклон ВАХ более крутой и перелом более резкий. Сама схема:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.11.2011, 23:54</div></div><div class="posttext">С её выхода идут почти прямоугольники. Такие:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">24.11.2011, 23:59</div></div><div class="posttext">Дальше так. Можно использовать такие, а можно это подать на триггер Шмитта на 555 таймере:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">25.11.2011, 01:02</div></div><div class="posttext">Далее. Если предполагается всё же ставить таймер, то можно выбросить из первой схемы все диоды, а выход трансформатора подключить к переменному резистору,  с движка этого резистора - через небольшую ёмкость, примерно в районе 1 мкф, подать на вход таймера. И затем подстроить входной уровень по вкусу. В принципе, всё. Кстати, сейчас я для эксперимента подключал вход МК прямо к схемке на трансформаторе - всё работает без проблем - контроллер измеряет скорость, определяет знак изменения этой скорости и в соответствии с этим меняет скважность ШИМ. Осталось закончить схему выходого ключа и пробовать всё в комплексе.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">25.11.2011, 04:06</div></div><div class="posttext">Спасибо Александр, вразумил немножко. Получается у нас частотомер настроенный под определённую скважность. То есть если попробовать проводить измерения простой переменки, то нужно будет его калибровать по другому. Правильно я понял?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">25.11.2011, 04:43</div></div><div class="posttext">А всё равно, чего измерять. Я измеряю  интервал между фронтом и спадом импульса, полученного из обычной переменки генератора с помощью схемы, о которой писал выше; там получается прямоугольник со скважностью единица. Также  можно измерять интервал между фронтами или между спадами, это кому что больше нравится. <br />
Шутки же со скважностью - это весёлые проделки таймера МК в режиме ШИМ и предназначены уже не для измерений, а для непосредственного управления током нагрузки.:)<br />
Чувствует моя печёнка, что придётся всем обзаводиться программаторами для МК...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">25.11.2011, 08:57</div></div><div class="posttext">Я смотрю чисто за оборотами, контроллер уже подключен к ветряку и пока работает так, как мне представлялось. <br />
Да, согласен:( В моём случае мозг будет стремиться к минимуму нагрузки.<br />
Но для вашего случая, если вязаться к оборотам, нужно вносить в мозг нагрузочную характеристику, ведь так?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">25.11.2011, 16:23</div></div><div class="posttext">Дмитрий 31, <br />
Нет, это не требуется. Алгоритм делается таким, чтобы система сама искала верхнюю точку на параболе винта, делала это вне зависимости от подключенной нагрузки и ветровых условий ( имеется ввиду, что нагрузка не должна быть слишком мала - это единственное ограничение), поэтому вносить в мозг ничего не требуется. Система работает на принципе обратной связи, поэтому на изменившиеся условия настраивается сама.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">25.11.2011, 23:26</div></div><div class="posttext">Алгоритм делается таким, чтобы система сама искала верхнюю точку на параболе винта, делала это вне зависимости от подключенной нагрузки <br />
А каким тогда образом регулировать Ток? Чего-то видимо не допонимаю...Исходя из двух переменных уравнение не решается вроде...<br />
 <br />
Добавлено через 4 минуты<br />
Чувствует моя печёнка, что придётся всем обзаводиться программаторами для МК... <br />
А на аналоговой технике?;)<br />
Чувствую не программатор нужен, а интегратор:scratch_one-s_head:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">25.11.2011, 23:32</div></div><div class="posttext"><IDXSKIP>Ток на нагрузке регулируется с помощью ШИМа.<br /></IDXSKIP>
<br />
А на аналоговой технике?<br />
На аналоговой сделать можно, но схема будет сложной и навороченной.<br />
Чем удобен МК? Что-то захотелось изменить в логике схемы - переписал программу и порядок. Никакой пайки, никакого изменения схемы. А на аналоговой... Замучаешься подбирать режим. И всё нужно делать с помощью паяльника.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">26.11.2011, 08:04</div></div><div class="posttext">Ток на нагрузке регулируется с помощью ШИМа. <br />
Да, Александр, это я понимаю, другого метода у нас нет наверное, кроме как влиять на ШИМ ;). <br />
Уменьшая сопротивление нагрузки наблюдать за падением напряжения, так? Отсюда выбираем максимальный ток? Нижний предел регулирования по увеличению дельты напряжения (соответственно и верхний по уменьшению)?<br />
П.С. Про аналоговую технику я, конечно, перебрал :) Пережитки прошлого так сказать...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">26.11.2011, 20:24</div></div><div class="posttext">В данный момент я не измеряю ни ток, ни напряжение. Ничего, кроме скорости вращения, точнее, только один горбик синусоиды с генератора - между фронтом и спадом. И этот параметр использую для управления ШИМ-ом. В данный момент стоит задача максимально оптимизировать работу винта, причём, вне зависимости от сопротивления нагрузки. Если ветряк использовать только для питания нагревательных приборов, то больше ничего и не нужно. Если же нужно работать на заряд батарей или на сеть, то нужно создавать следующее устройство, которое это будет делать из того, что поступает с первого устройства. Нельзя решать задачу, хватаясь сразу за самый её хвост, всё нужно делать постепенно. Иначе можно конкретно запутаться, надеть в программе кучу ошибок, которые будет трудно найти.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">27.11.2011, 13:17</div></div><div class="posttext">А в чём заключена оптимизация винта по отношению к электронике... Хорошо, знаем мы частоту вращения винта. Изменение частоты вращения управляет силовым драйвером. А откуда берётся максимальная точка отбора мощности? Как мы узнаём, что берём максимум мощности при таких или иных оборотах? Или я немогу разглядеть очевидных вещей, Александр?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">27.11.2011, 19:41</div></div><div class="posttext">Дмитрий 31, <br />
Да я бы не сказал, что это всё - вещи очевидные. И поломать голову нужно. Чем в данный момент и занимаюсь. Система работает по принципу обратной связи между винтом и нагрузкой. Алгоритм работает, но пока ещё не всё мне нравится, нужно над мелочами повозиться. Не исключено, что окончательный вариант будет сильно отличаться от того, что работает сейчас.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">28.11.2011, 08:10</div></div><div class="posttext">Александр, сегодня я подумал о такой вещи: в итоге мы должны достигать максимального крутящего момента на валу, влияя на генератор, посредством изменения нагрузки. Причём генератор - это всего лишь связующее звено. Ведь максимальный момент и есть максимальная мощность на валу, что соответствует максимуму параболы нагрузочной характеристики винта? Единственное но, которое меня теперь озадачивает в этой связке - а если гена слаб? Максимальной нагрузкой на гену мы не дотянем до максимума параболы, а лишь будем снимать максимум, соответствующий конструктивной мощности генератора с возрастающей части нагрузочной характеристики винта...<br />
П.С. начал переживать - не слабого ли донора взял :(</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">28.11.2011, 14:22</div></div><div class="posttext">Слабость гены проявится в синем дыме из него...<br />
т.е мощность таки будет повышаться пока генератор не сгорит...<br />
это если винт сильно мощнее гены... или если ветер слишком сильный.<br />
полюбому нужно ограничение выставлять в контроллере по мощности генератора....<br />
<br />
Александр, <br />
по поводу &quot;Умной нагрузки&quot;.<br />
я себе это представлял так:<br />
с выхода контроллера пиковой мощности мы входим в контроллер заряда АКБ (условимся что контроллер пиковой мощности выгоняет максимум мощности с ветроголовки. т.е эту часть забот получения максимума решается только в нем, &quot;Умная нагрузка&quot; решает только вопрос 100% утилизации с делением по потребителям)<br />
что он из себя представляет.<br />
Это ШИМ контроллер с прямым выходом на АКБ и с обратной связью от АКБ<br />
и с инверсным выходом на балласт<br />
т.е. мы в АКБ забираем всю нужную для заряда энергию а излишки сбрасываем в балласт... утилизация входящей энергии 100%<br />
Если немного подробнее расписать...<br />
Генератор ШИМ управляется сигналом с модуля заряда АКБ...  на выходе мы получаем импульс - ширина его определяет полезную ( зарядную часть энергии+текущий расход с АКБ на инверторы) а пауза - излишки балластные энергии.<br />
соответственно на  ключ в зарядном модуле мы подаем прямой импульс... на ключ в балластном модуле мы подаем инвертированный импульс<br />
<br />
<br />
но единственное условие - суммарная мощность балласта должна быть немного больше пиковой максимальной мощности генератора.<br />
<br />
<br />
про обратную связь между винтом и нагрузкой несогласен... нагрузка по определению максимальной эффективности - &quot;бездонная бочка&quot; или &quot;абсолютный энергетический вакуум&quot;<br />
должен быть просто кран на трубе в эту &quot;бездонную бочку&quot;<br />
и обратная связь по количеству энергии.<br />
критерий - чем больше тем лучше.<br />
вопрос за алгоритмом получения этого &quot;больше&quot;<br />
свою версию я предложил.<br />
но возможно есть еще варианты</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">28.11.2011, 15:25</div></div><div class="posttext">про обратную связь между винтом и нагрузкой несогласен... нагрузка по определению максимальной эффективности - &quot;бездонная бочка&quot; или &quot;абсолютный энергетический вакуум&quot; должен быть просто кран на трубе в эту &quot;бездонную бочку&quot; <br />
Вы меня наверное неправильно поняли. Генератор ведь просто трансформирует энергию, НО - посредством воздействия на него, мы можем воздействовать на винт, что нам и нужно, как я понимаю сам (загнать винт в максимум его параболы). А чем мы можем повлиять на это промежуточное звено? Только изменением сопротивления нагрузки.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">28.11.2011, 15:33</div></div><div class="posttext">ну не обратная связь...<br />
сопротивление нагрузки это фактор управляющий... а обратная связь, по которой мы собственно и оцениваем качество управляющего воздействия - по выхлопу энергии или &quot;потоку в трубе&quot;..<br />
по моему так корректнее</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">28.11.2011, 16:01</div></div><div class="posttext">Тут вопрос собственно, возможно-ли выудить крутящий момент винта без датчика такового...об этом ещё придтся поразмыслить. Скорость вращения благодаря Александру уже не представляет трудов фиксировать. Остальное уже математика (имеется ввиду алгоритм воздействия).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">28.11.2011, 16:11</div></div><div class="posttext">нам скорость вращения без скорости ветра не нужна.<br />
но даже при наличии этих двух параметров не имея нагрузочной характеристики винта мы вроде как ничего не сможем получить.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">28.11.2011, 16:44</div></div><div class="posttext">нам скорость вращения без скорости ветра не нужна. <br />
А для чего нам знать с какой силой дует ветер, если нагрузочные характеристики винта параболичны - берём максимум.<br />
 <br />
Кстати, тут в соседней ветке ваш пост №22 очень даже понравился<br />
 <br />
алгоритм такой... увеличиваем скважность (при этом нагрузка становится меньше...) если произведение становится больше (значит наблюдается рост мощности) снова увеличиваем скважность еще на один шаг.<br />
как только произведение начинает уменьшаться - начинаем уменьшать скважность и так сравнивая две величины прошлый шаг и новый шаг мы всегда будем качаться в точке максимальной мощности для этого ветра и этого генератора.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">28.11.2011, 18:06</div></div><div class="posttext">Ребята, в данный момент алгоритм ещё находится в процессе тестирования и отладки, поэтому точно и подробно рассказать о его работе не получится. Далее. Как правильно заметил Дмитрий 31, генератор - это связующее звено. Посредник. Поэтому его роль второстепенна. Ещё далее. Скорость вращения винта и скорость ветра знать никому не нужно. Эти параметры при таком алгоритме, какой использую я, не играют никакой роли.<br />
 Tema0, по поводу обратной связи. &quot;Согласен - несогласен&quot; - это не совсем аргумент в данном случае. Согласны? Обратная связь - это очень информативный параметр, который используется практически всюду. Другой вопрос - как на неё реагирует система, с какими задержками или предусловиями. Обратную связь можно использовать как для стабилизации чего-либо, так и для дестабилизации. У меня используется именно последнее. Программа не позволяет винту стабилизироваться по скорости вращения. Она только следит за тем, чтобы винт находился всё время в поиске. Появились признаки ускорения - увеличиваем нагрузку, появились признаки торможения - уменьшаем. Если после ускорения появились признаки стабилизации - пробуем немного увеличить нагрузку, а если стабилизация захотела быть после торможения - уменьшаем. Если винт снизил скорость до установленного нижнего порога - отключаем нагрузку совсем, что позволяет винту находится в движении даже при очень слабом ветре. Результат: винт продолжает вращение даже тогда, когда зажжённая спичка на ветру не гаснет. (Причём, работая в этом режиме без нагрузки он вращается несколько быстрее, чем должен был бы по расчёту при данном ветре, что позволяет ему при усилении ветра очень быстро выйти на режим.)<br />
Как результат - винт никогда не стабилизируется по скорости, а находится в поиске. Что заметно сразу - при изменении скорости ветра винт изменяет свою скорость вращения таким образом, что оказывается в районе расчётной точки на параболе. Плюс-минус несколько процентов. Насколько можно это точно ухватить из показаний анемометра и тахометра винта. (Тахометр в моём случае - это совершенно независимое устройство, никак не связанное с МК и работой программы и предназначен только для визуального контроля системы при отладке программы, анемометр - то же самое).<br />
В данный момент программа работает. И весьма успешно управляет нагрузкой. Даже этот простейший алгоритм значительно улучшил энергоотдачу ветряка по сравнению с работой на чисто фиксированную нагрузку.<br />
По поводу генератора. Если винт не с регулировкой шага, то генератор обязан иметь значительный запас по мощности.<br />
По поводу заряда АКБ и прочего - это отдельная тема, которая пока не рассматривается. Об этом можно будет думать потом, когда работа контроллера мне начнёт нравиться на 100%. Пока этого ещё не произошло, поэтому - работаем дальше...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">28.11.2011, 18:46</div></div><div class="posttext">Появились признаки ускорения - увеличиваем нагрузку, появились признаки торможения - уменьшаем. <br />
То есть Александр, в вашем алгоритме основная контролируемая функция это угловое ускорение, правильно вас понял? Если да, то к тому мои мысли часа два назад и пришли :)<br />
А насчёт запаса мощности генератора, к сожалению тоже догадался - незря у вас ВРШ.<br />
Ну что-ж, покрайней мере для моего случая в алгоритме ограничением сверху будет максимальная мощность генератора.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">28.11.2011, 20:05</div></div><div class="posttext">основная контролируемая функция это угловое ускорение<br />
Да, именно так.<br />
Если у Вас мощность генератора ограничена, то ветряк - только складнохвостик. Но в мире сейчас становятся популярными ветряки без складывания, но имеющие большой запас по мощности генератора, и по превышению скорости вращения включающие тормозной дроссель. Это позволяет плавно остановить ветряк без ударных перегрузок винта. Закорачивать генератор для остановки просто так нельзя, я один раз попробовал... Ощущение было такое, словно винт в воздухе наткнулся на лом.:shok:<br />
Кстати, с ВРШ всё ещё хитрее: когда начинает работать ограничение по аэродинамике, можно увеличивать нагрузку на генератор, если последний позволяет. Обороты стабильны, но мощность растёт при усилении ветра, поскольку потенциально растёт вращающий момент.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">29.11.2011, 10:05</div></div><div class="posttext">Александр, Я понял логику работы Вашей системы. Да, Ваш алгоритм теперь мне кажется более правильным и гораздо более простым в реализации.<br />
осталось только проработать драйвер на пару киловатт</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">29.11.2011, 14:59</div></div><div class="posttext">Кстати, с ВРШ всё ещё хитрее: когда начинает работать ограничение по аэродинамике, можно увеличивать нагрузку на генератор, если последний позволяет. Обороты стабильны, но мощность растёт при усилении ветра, поскольку потенциально растёт вращающий момент. <br />
Так понимаю Александр, именно при этих условиях идёт отработка нового алгоритма у вас в текущий момент, до того, как он вам начнёт нравиться? Ведь тут уже предыдущий алгоритм, не дающий винту застабилизировать обороты уже не работает ведь?<br />
А по поводу слабого генератора решил вопрос просто - если выбранный мной винт не будет в паре с генератором выходить на участок максимума параболы, то уменьшить диаметр винта.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">29.11.2011, 21:31</div></div><div class="posttext">Дмитрий 31, <br />
ВРШ просто несколько усложняет задачу. В том случае, если хочется не пропускать лишнюю энергию сквозь винт, а попытаться её собрать. Не всю, понятное дело, но весьма немалую часть. Алгоритм тот же самый, просто в нём учитывается факт аэродинамической стабилизации, он её распознаёт и начинает работать с её учётом. Стоит задача сделать так, чтобы электронике было безразлично, что к ней подключили - ветряк с винтом фиксированного шага, или ВРШ. И чтобы безразлично было сопротивление нагрузки. <br />
<br />
если выбранный мной винт не будет в паре с генератором выходить на участок максимума параболы<br />
Тут я чуток поправлю. Дело в том, что мы имеем не одну параболу, а их целое семейство. Для каждой скорости ветра своя парабола. В этом и есть главная засада. Поэтому нужно просто определиться с конкретной параболой, которая будет считаться предельной для данного ветряка, собственно, определить, при какой скорости ветра должен начинаться увод (для складнохвостика) или регулировка лопастей для ВРШ. Уменьшать винт не нужно - зачем себя лишать удовольствия забрать энергию по максимуму от умеренного ветра?<br />
<br />
Добавлено через 1 час 42 минуты<br />
осталось только проработать драйвер на пару киловатт<br />
Самый простой и дешёвый драйвер у меня в данный момент успешно работает. Вот его схема:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">29.11.2011, 21:36</div></div><div class="posttext">Пару киловатт он держит. Но нужно помнить, что напряжение ограничено 200 вольтами. Полевик живёт на радиаторе. Нагрузка  активная - какой-нибудь нагреватель. Универсальный вариант нагрузки будем делать потом.<br />
На вход оптрона идёт ШИМ прямо с выходного порта МК.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">30.11.2011, 10:51</div></div><div class="posttext">Схема хорошая.<br />
Если нужно будет поменять напряжение на повыше вместо IRF 640 (http://tec.org.ru/board/49-1-0-229) можно поставить IRFP 460 (http://tec.org.ru/board/irfp250_n/49-1-0-1133) (20А, 500V) у него вдвое больше мощность рассеивания, но немного хуже частотные характеристики. <br />
У Вас на ШИМ какая частота используется?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">30.11.2011, 13:30</div></div><div class="posttext">Tema0, <br />
Сравнительно низкая - период 1,16 mS, или 862 герца всего. Для IRFP 460 придётся ставить другую микруху в драйвер, эта схема может не потянуть. В ближайшее время испытаю такую:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">30.11.2011, 14:03</div></div><div class="posttext">При низкой частоте ШИМ в дальнейшем мы столкнемся с проблемой изготовления дросселя..<br />
лучшее сразу уйти на частоты максимально доступные для IRFP 460<br />
И софт отлаживать на этих рабочих частотах</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">30.11.2011, 14:31</div></div><div class="posttext">Частота ШИМ не определяется софтом и на него не влияет. ШИМ - это аппаратная функция МК и зависит только от тактовой частоты процессора и разрядности ШИМ. Собственно, если используем энергию для нагревателя, то частота особо не волнует. Второй вариант - это превратить выходную последовательность импульсов в постоянное напряжение, установив после ключа фильтр. Получаем меняющееся по величине выходное напряжение, которое затем обрабатываем с помощью чисто аппаратных средств - DC/DC конверторов. Если используем для работы с АКБ, то тоже частота ШИМ нас не должна особо заботить, просто контролируем параметры батареи и стреляем в неё импульсами. Если же предусмотрено подключение Grid Tie, то на него подаём постоянное напряжение прямо с фильтра, нужно быть лишь уверенным в том, что выбранный нами инвертор сможет работать в диапазоне этих напряжений. Такие вот мысли. Возможно и не совсем верные...<br />
А вот кусочек работы ШИМа, только сильно не плюйтесь - снимал мобильником с маленького расстояния, а тот немного дрожал в руке. Есть у него такое свойство - дрожать...:))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">30.11.2011, 14:33</div></div><div class="posttext">Регулирование мощности идёт по нижней линии, осциллограф подключен параллельно полевику. Поэтому в голове нужно картинку переворачивать.:crazy:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">30.11.2011, 15:36</div></div><div class="posttext">в дальнейшей работе нужен будет второй вариант чтобы потом его раскладывать на два потока - полезный и балластный. И чем выше будет частота, тем меньшие габариты будут у фильтра<br />
<br />
Я опыты могу проводить только на вот ЭТОМ (http://www.gaw.ru/pdf/Atmel/kit_soft/avr/Battery.pdf)<br />
он у меня есть и с материалом по программированию тоже вопросов нет, драйвер по последней Вашей схеме к пятнице спаяю...<br />
там ядро - атмега 169 у него четыре канала ШИМ, т.е можно на одном ядре обслужить все этапы утилизации.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">30.11.2011, 18:08</div></div><div class="posttext">Это несложно сделать. В данный момент у меня задействован только один канал ШИМа из шести возможных. Можно разложить на все шесть. Частоту повысим, но в разумных пределах, чтобы скорость нарастания импульса составляла незначительный процент от длительности импульса ШИМа, иначе полевик может начать греться, что не есть сильно хорошо.<br />
<br />
Добавлено через 1 час 47 минут<br />
Отключил делитель тактовой частоты, теперь частота ШИМа увеличилась примерно до 7 кГц. Но в этом случае в драйвере необходимо заменить резистор R6, уменьшив его до 5,1 - 6,2 кОм. В противном случае фронты на ключах будут завалены и ключ будет греться.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">30.11.2011, 20:57</div></div><div class="posttext">Решил на TL494 сотворить контроллер и стабилизатор напряжения. Попробую хлопнуть двух зайцев.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Микола</div><div class="date">30.11.2011, 21:16</div></div><div class="posttext">Программа не позволяет винту стабилизироваться по скорости вращения. Она только следит за тем, чтобы винт находился всё время в поиске. Появились признаки ускорения - увеличиваем нагрузку, появились признаки торможения - уменьшаем. Если после ускорения появились признаки стабилизации - пробуем немного увеличить нагрузку, а если стабилизация захотела быть после торможения - уменьшаем. Если винт снизил скорость до установленного нижнего порога - отключаем нагрузку совсем, что позволяет винту находится в движении даже при очень слабом ветре. Результат: винт продолжает вращение даже тогда, когда зажжённая спичка на ветру не гаснет<br />
Собственно вот все что и нужно. Остальное детали, которые каждый решает на свое усмотрение или умение, воображение.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Микола</div><div class="date">30.11.2011, 21:35</div></div><div class="posttext">Александр, я такую схему использую. И два шима. Один управляет нагрузкой, другой балластом. Но скажу сразу, мне еще похвастаться не чем.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">30.11.2011, 22:51</div></div><div class="posttext">Микола, <br />
Почему же нечем? :) Очень даже чем! Схему создал?  - Создал. Работает? - Работает. А ты говоришь, нечем... Шутник-с, однако...:))<br />
Если обратил внимание, схема драйвера у меня очень похожа на твою. Но есть один маленький нюанс. И этот нюанс мне не понравился, поэтому я схему изменил. У этой схемы есть свойство полностью открывать выходной ключ при отсутствии сигнала на входе. Вот это я и переделал. Теперь при отсутствии входного сигнала ключ закрыт.<br />
<br />
Добавлено через 6 минут<br />
Я опыты могу проводить только на вот ЭТОМ<br />
Вполне неплохой вариант. С большим запасом и на все случаи жизни.<br />
 Я тут вынашиваю идею сделать то же самое, что у меня сейчас, на самом мелком из AVR-ок, - на ATiny13. Его должно хватать с ушами.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">01.12.2011, 10:11</div></div><div class="posttext">Ребята, не могу понять. Вот эта ссылка из поста <br />
Tema0, №133 в слове &quot;этом&quot; http://www.gaw.ru/pdf/Atmel/kit_soft/avr/Battery.pdf<br />
открывается чёрный экран и всё. Толи ссылки не туда, то ли у меня с компом что-то не то. Что это может быть? <br />
Прошу прощения, что не по теме...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">01.12.2011, 11:15</div></div><div class="posttext">Это ссылка на PDF документ, с описанием Атмеговского микроконтроллера, даже точнее маленького микрокомпьютера с дисплейчиком и портами выведенными наружу, такой клевский отладочный комплект, я ссылку перепроверил, она нормально работает.<br />
Должен на компе стоять адобе акробат реадер.<br />
Можно скачать этот документ на комп и там посмотреть, нажав на ссылке правую кнопку мыши и выбрав пункт &quot;сохранить объект как&quot;<br />
<br />
Добавлено через 17 минут<br />
<br />
 Я тут вынашиваю идею сделать то же самое, что у меня сейчас, на самом мелком из AVR-ок, - на ATiny13. Его должно хватать с ушами.<br />
<br />
В общем, после того как твой алгоритм поиска максимума будет отлажен<br />
понадобится всего два канала ШИМ, для реализации полного цикла.<br />
Полученная (назовем ее суммарной) длительность импульса... по твоему алгоритму должна биться на два канала первый канал работает на заряд АКБ и текущее потребление инверторов (АКБ в буферном режиме) - базовая часть... ширина этого импульса будет определяться запросом от блока заряда...<br />
а второй канал - балласт, ширина импульса в нем разница между суммарной длительностю и длительностью зарядного импульса.<br />
типа вроде так получится<br />
Единственно, я пока слабо представляю как программно сделать привязку фронтов, импульс в первом канале идет первым, а импульс во втором канале идет через небольшой защитный интервал по заднему фронту первого канала<br />
<br />
Добавлено через 6 минут<br />
:scratch_one-s_head:<br />
Под эти задачи ATiny 13 шикарно подходит<br />
- Один 8- разрядный таймер/счетчик с отдельным предделителем и два ШИМ канала<br />
    - 4 канальный 10 битный АЦП со встроенным ИОН<br />
    - Встроенный аналоговый компаратор <br />
весь набор понадобится</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">01.12.2011, 11:29</div></div><div class="posttext">Tema0, спасибо, всё получилось:)...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">01.12.2011, 21:27</div></div><div class="posttext">Tema0, Ничего страшного не произойдёт, если не будет этой привязки фронтов. Если используется аппаратный ШИМ таймера, то у него мы не можем влиять на эти фронты. Мы просто записываем в OCR-регистр соответствующего таймера нужное нам число, и оно будет определять скважность. Сейчас я использую таймер 0, у него 8-битный шим и два OCR регистра. OCR0A и OCR0B. Если в первый из них запишем 1 , а во второй - 254, то на первом выходе будет тонкая иголочка в 1/255 периода ШИМа, а во втором будет широкий импульс в 254/255 от полного периода ШИМа, но начинаться они могут только одновременно. Можно пробовать с одного канала брать прямой сигнал, а со второго - инверсный. Тогда получим, что если в первом канале импульс кончился, то во втором - начался. И о взаимной синхронизации снова не нужно думать.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">02.12.2011, 11:00</div></div><div class="posttext">Привязка фронтов конечно может и не быть, только задача в любом случае заключается в том, чтобы управляющие импульсы ШИМ на двух каналах не накладывались по времени иначе основная идея разделения энергии нарушится<br />
<br />
в общем виде получается такая схема управления ключами.<br />
соответственно t1 - ширина общего импульса полученного по твоему алгоритму назовем его временем утилизации... <br />
т2 - импульс с первого канала ШИМ (зарядного)<br />
t3 - импульс второго канала ШИМ (балластного)<br />
ведущим является импульс t2. его ширина определяется потребность модуля заряда АКБ он может занимать от 0 до 100% от общего времени утилизации t1<br />
импульс t3 - это разница времени t1-t2<br />
в общем то понятно что процесс заряда АКБ в пределах большого количества периодов ШИМ практически не изменится...<br />
по этому основную логику твоего алгоритма нужно будет осуществлять вариацией времени t3</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">02.12.2011, 11:11</div></div><div class="posttext">и я честно говоря не вижу возможности инверсией по второму каналу решить задачу привязки импульса t3<br />
<br />
по идее самый простой способ такой<br />
канал ШИМ1 - формирует импульс утилизации t1<br />
канал ШИМ2 - формирует инверсный импульс заряда АКБ t2<br />
а импульс t3 получаем на элементе 2И из импульсов t1 и  инверсного t2 <br />
тут же можно сформировать и защитный интервал.<br />
и получится что вся твоя программулина останется без изменений.<br />
вычитание времени сделаем снаружи.<br />
и добавим только программный модуль управления зарядом АКБ</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">02.12.2011, 18:49</div></div><div class="posttext">и я честно говоря не вижу возможности инверсией по второму каналу решить задачу привязки импульса t3<br />
Для решения этой задачи нужно сделать два разных драйвера. Первый должен открываться по единичному уровню и подключается к первому каналу, второй же - открывается по нулевому уровню и подключается к инверсному второму каналу. В первый канал записываем некую переменную, пусть она у нас называется Pwm1. Далее договоримся, что будем использовать  ШИМ 8 бит. Тогда во второй канал пишем Pwm2=255-Pwm1.  Суммарная мощность по двум каналам останется неизменной, только будет перераспределяться энергия. Но я в этом особой нужды не вижу. Я предпочитаю делать оба канала независимыми по управлению. Один канал должен быть главным и управлять основным потоком энергии. А если энергии становится слишком много и первый канал уже полностью открыт, то тут должен подключиться второй канал. А если и он полностью открылся - то и третий. Если важен заряд АКБ, то первый канал обслуживает её, а оставшуюся часть забирают остальные. ШИМ стреляет в нагрузку частыми импульсами, генератор работает очень мягко, без резких рывков и ударов. Я подключал к единственному каналу всё, что только смог найти - что-то около восьми ом, а у генератора 2 ома. Ветер позволил получить максимально 1600 ватт, при этом напряжение на нагрузке было 160 вольт и ток 10 ампер. Если одну из нагрузок отключаешь, тут же меняется скважность ШИМа, напряжение поднимается, а ток падает. Мощность при этом остаётся прежней. Винт при этом не меняет своего режима.<br />
Фактически, нам нужно поставить условие системе, что Pwm1+Pwm2+.....+PwmN=Const. Тогда она будет сама перераспределять энергию и делать это правильно.<br />
Аналогичным образом использует ШИМ Sercat. Он не стал синхронизировать каналы и всё отлично работает на двух ветряках.<br />
Я предлагаю делать с самого начала максимально просто. Пусть система заработает. Тогда станет видно, что нужно сделать ещё. <br />
Такие вот мысли...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Дмитрий 31</div><div class="date">03.12.2011, 19:05</div></div><div class="posttext">Если одну из нагрузок отключаешь, тут же меняется скважность ШИМа, напряжение поднимается, а ток падает. <br />
Александр, позволю себе по этому поводу поднять свой флаг:) Это не то же самое, что я предлагал, контролировать выходной ток с преобразователя стабилизируя напряжение?;)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">03.12.2011, 21:53</div></div><div class="posttext">Дмитрий 31, А это пока совсем другой алгоритм отлаживается, Александр пока отлаживает алгоритм загона винта в оптимальный для текущей скорости ветра режим работы.<br />
и пока сливает все в балластную нагрузку.<br />
<br />
Александр, про фронты каналов шим я понял. просто разброс фронтов по времени более понятен для меня на этом этапе</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">03.12.2011, 23:18</div></div><div class="posttext">Дмитрий 31, <br />
Да, Tema0 уже ответил. <br />
 <br />
Tema0, по разбросу фронтов можно, я думаю, не особо заморачиваться. Ни у нас переключаются с частотой 7 кГц, поэтому мы можем о них вообще не думать, а делать всё в одно и то же время. Так оно и проще, кстати.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Абдулалим</div><div class="date">20.05.2012, 04:03</div></div><div class="posttext">Почему же тишина в теме?  . Ни одно фото , ни одна схема  у меня не открываются , или так же у всех? Прочитал все 15 страниц , и похоже я хочу подружится с микроконтролерами</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">21.05.2012, 09:54</div></div><div class="posttext">тишина - дык страда началась... в июне продолжим :))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">16.11.2012, 11:36</div></div><div class="posttext">Несколько вопросов к Александру.<br />
1) Правильно я понимаю, что ветряк надо рассчитывать так, что при скважности 1, он должен быть перегруженным?<br />
2) Почему вы решили ориентироваться на обороты ветряка, а не на мощность на нагрузке?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">16.11.2012, 21:30</div></div><div class="posttext">BenGunn, по первому вопросу - совершенно необязательно. Скважность 1 означает, что контроллер пропускает только половину возможного. Нам не нужно о скважности думать, контроллер сам должен решать, какую установить в данный момент времени. Она будет зависеть от подключенной нагрузки.<br />
По второму вопросу. <br />
Мощность в нагрузке - суть производная от оборотов винта. Можно делать и так и эдак. Оба пути приведут к одинаковому результату.  Хотя вернее было бы сказать, что я ориентируюсь не столько на обороты винта (они выводятся на дисплей только для меня, контроллер о них даже не знает), как таковые, сколько на изменение их. На знак ускорения, так сказать. Имеется три состояния - &quot;минус&quot;, &quot;нуль&quot;, &quot;плюс&quot;. По каждому из них принимается соответствующее решение. Просто мне так было удобнее делать.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">16.11.2012, 22:12</div></div><div class="posttext">BenGunn, по первому вопросу - совершенно необязательно. Скважность 1 означает, что контроллер пропускает только половину возможного. <br />
Хм, я почему-то думал, что при скважности 1 контроллер пропускает всю мощность, а половину при скважности 2. У нас же скважность – это отношение периода импульса ко времени импульса или нет?<br />
<br />
<br />
Нам не нужно о скважности думать, контроллер сам должен решать, какую установить в данный момент времени. Она будет зависеть от подключенной нагрузки.<br />
Я работу контроллера себе представляю так, что увеличивая скважность, мы уменьшаем нагрузку на винт. Тогда при скважности 1 винт должен быть перегружен, иначе контроллер может выдавать полную мощность, но винт будет недогружен.<br />
<br />
<br />
По второму вопросу. <br />
Мощность в нагрузке - суть производная от оборотов винта. Можно делать и так и эдак. Оба пути приведут к одинаковому результату.  Хотя вернее было бы сказать, что я ориентируюсь не столько на обороты винта (они выводятся на дисплей только для меня, контроллер о них даже не знает), как таковые, сколько на изменение их. На знак ускорения, так сказать. Имеется три состояния - &quot;минус&quot;, &quot;нуль&quot;, &quot;плюс&quot;. По каждому из них принимается соответствующее решение. Просто мне так было удобнее делать.<br />
Вот тут у меня и возник вопрос. Давайте посмотрим на график мощности (см. рисунок).<br />
Пока мы находимся левее максимума, т.е. винт делает меньше чем 500 оборотов, то ваш принцип (увеличение оборотов означает увеличение мощности) работает. Но если мы оказались правея максимума, то все меняется и увеличение оборотов означает уже уменьшение мощность. Так как в конкретный момент мы не знаем, с какой стороны от максимума находимся, то изменение оборотов нам ни о чем не говорит. Может, я просто чего-то не понимаю?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">17.11.2012, 00:02</div></div><div class="posttext">BenGunn, всё у вас верно. Это я думал об одном, а сказал другое... ;%<br />
Что касается самой нагрузки, то она, естественно, должна быть с учётом интересов винта.<br />
По графику.<br />
Конкретно в моём случае - винт не может оказаться на правой ветви. Даже если контроллер и нагрузку отключить совсем. Винту это абсолютно безразлично. Проверено многократно. (Всё-таки ВРШ...) Поэтому правая ветвь меня особо не заботит. В остальном же - если винт вдруг выйдет за вершинку, это будет сигнал для контроллера &quot;увеличить нагрузку&quot;. И винт неизбежно вернётся на левую ветвь.<br />
Шаг дискретизации ШИМ должен находиться в некотором соответствии с динамикой винта и это следует просто подобрать экспериментально. Меняя шаг дискретизации, на одной и той же программе получаются очень разные результаты. Понятно, что имея численные данные о динамике винта при разных ветровых режимах и разных нагрузках, можно было бы, в принципе, написать вполне рабочую программу. Но не факт, что она не потребует отладки в железе.<br />
Есть у меня три статейки на тему MPPT, правда, на английском. В прикреплённом архиве все три.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">17.11.2012, 00:05</div></div><div class="posttext">Да, кстати: на графике мы имеем только кривую винта. А реальный контроллер работает, имея на этом же графике две кривых - винта и нагрузки. Вот когда они обе там появятся, то неопределённость не будет так очевидна.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">17.11.2012, 01:38</div></div><div class="posttext">Конкретно в моём случае - винт не может оказаться на правой ветви. Даже если контроллер и нагрузку отключить совсем. Винту это абсолютно безразлично. Проверено многократно. (Всё-таки ВРШ...) <br />
ВРШ тут не причем, так как он начинает работать, только при определенных оборотах. <br />
<br />
Да, кстати: на графике мы имеем только кривую винта. А реальный контроллер работает, имея на этом же графике две кривых - винта и нагрузки. Вот когда они обе там появятся, то неопределённость не будет так очевидна.<br />
Вот как раз сейчас сделал такой график.<br />
Вводим два допущения.<br />
1) ВРШ у нас ещё не срабатывает.<br />
2) К генератору подключена постоянная нагрузка, поэтому при неизменной  скважности мощность генератора будет изменяться в зависимости от квадрата оборотов.<br />
<br />
В начальный момент дует ветер со скоростью 5м/с и  ШИМ имеет скважность 1.<br />
Ветер изменился и стал дуть со скоростью 7м/с. Для простоты будем считать, что ветер изменился мгновенно. Мощность ветроколеса увеличилась (точка 2), а мощность генератора пока не изменилась. Теперь возможно несколько вариантов.<br />
1) У нас нет контроллера. Мощность генератора возрастет по желтой линии. Мощности генератора и ветроколеса уравновешиваются в точке 6. Так как точка 6 явно не оптимальна, мы и пытаемся сделать контроллер.<br />
2) Скважность меняется, но медленно. Поэтому мощности уравновешиваются в точке 3. Дольше по вашему алгоритму контроллер уменьшает нагрузку и винт начинает разгоняться. Контроллер реагирует на разгон винта и увеличивает нагрузку, винт замедляется. В итоге мы остаемся в районе точки 3.<br />
3) Скважность изменяется с оптимальной скоростью. Мы попадаем в точку 4 и по аналогии и точкой 3 топчемся на одном месте.<br />
4) Скважность меняется слишком быстро. Винт не успевает разогнаться и мы попадаем в точку 5. Мы опять топчемся на месте.<br />
Когда скорость ветра упадет, картина будет аналогичной.<br />
<br />
Пока писал, понял, что когда мы попадаем в некоторую точку, ваш алгоритм просто стабилизирует в ней ветряк, а максимум при этом не ищется.<br />
<br />
<br />
Шаг дискретизации ШИМ должен находиться в некотором соответствии с динамикой винта и это следует просто подобрать экспериментально. Меняя шаг дискретизации, на одной и той же программе получаются очень разные результаты. <br />
Это как раз подтверждение того, что я написал выше. Если мы не правильно настроили шаг дискретизации ШИМ, то мы получим или случай 1 или случай 4. Оптимальная дискретизация зависит от момента инерции винта или как вы пишите от динамики винта.  <br />
<br />
Для универсального алгоритма поиска точки максимума, надо вместо изменения оборотов ориентироваться на изменения мощности на нагрузке. <br />
Давайте посмотрим, как это будет работать.<br />
1)	Скважность изменяется медленно и мы опять попали в точку 3. Контролер попробует ещё нагрузить ветряк, винт замедлится, но мощность при этом возрастет. Постепенно мы попадем в точку максимума 4. <br />
2)	Скважность изменяется с оптимальной скоростью, мы попали в точку 4. Контроллер пытается ещё нагрузить ветряк, винт тормозится и мощность падает. Контроллер реагирует на падание мощности и уменьшает нагрузку, мощность растет. В итоге мы топчемся около точки максимума.<br />
3)	Скважность изменяется слишком быстро, мы в точке 5. Контроллер нагружает ветряк, винт тормозиться, мощность падает. Контроллер уменьшает нагрузку, винт разгоняется, мощность растет. Контроллер продолжает уменьшать нагрузку, пока мы не попадем в точку 4.<br />
<br />
В общем виде алгоритм выгладит так. <br />
1) Контроллер изменяет скважность (увеличивает или уменьшает).<br />
2) Если это приводит к увеличению мощности, то контроллер продолжает изменять скважность в том же направлении.<br />
3) Если мощность падает, то контроллер меняет направление изменения скважности на противоположное.<br />
При таком алгоритме дискретизация ШИМ уже не так важна, так как мы в любом случаи попадем в точку максимума. Единственная разница будет в том, что при правильной дискретизации точка максимума будет находиться быстрее и поэтому ветряк будет лучше реагировать на порывы ветра.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">17.11.2012, 02:48</div></div><div class="posttext">Следует помнить, что максимальная мощность винта не совпадает с максимальными оборотами, а находится чуточку не доходя максимума. Далее. Измерение знака ускорения производится много десятков раз раз за один оборот винта. Соответственно и реакция по изменению нагрузки происходит с этой же скоростью. Винт сместился всего на несколько сантиметров по окружности, а его уже измерили и изменили нагрузку. Весь отрезок мощности от нуля до 2500 ватт разбит на 256 частей. Пока что я не видел того, что вы описывали. А вот соответствие расчётным параметрам наблюдается. Я не считаю свой алгоритм идеальным или самым правильным, но он реально работает в железе и даёт совершенно реальную энергию. <br />
Что касается порывов - забудьте мечтать об их утилизации. Это не тот ветер, от которого можно что-то взять, кроме вибраций.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">19.11.2012, 16:53</div></div><div class="posttext">Меняя шаг дискретизации, на одной и той же программе получаются очень разные результаты.<br />
Александр, опишите, пожалуйста, как изменяются результаты, при изменении шага  дискретизации.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">19.11.2012, 19:37</div></div><div class="posttext">BenGunn, у меня получалось при слишком грубом шаге, что нагрузка успевала задавить винт и тот не мог выйти на расчётный режим. В результате винт был перегружен и мощность недобиралась. А при чрезмерно мелком шаге винт успевал разогнаться до скоростей выше расчётных, поскольку нагрузка отставала. Но если ветер оставался некоторое время стабильным, то контроллер мог подстроиться. Однако стабильность ветра вещь почти нереальная, особенно при малой высоте установки ветряка, поэтому, как правило, в этом случае также был ощутимый недобор по мощности. На быстро меняющемся ветре вообще очень сложно добиться полной утилизации энергии ветра, если вообще возможно.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">19.11.2012, 20:29</div></div><div class="posttext">BenGunn, у меня получалось при слишком грубом шаге, что нагрузка успевала задавить винт и тот не мог выйти на расчётный режим. В результате винт был перегружен и мощность недобиралась. А при чрезмерно мелком шаге винт успевал разогнаться до скоростей выше расчётных, поскольку нагрузка отставала. <br />
<br />
Это один в один случаи 4 и 2, которые я описал выше.<br />
<br />
<br />
Но если ветер оставался некоторое время стабильным, то контроллер мог подстроиться.<br />
Тут видимо я не до конца понял работу вашего контроллера, при попадании ветряка в точку равенства мощностей. <br />
<br />
<br />
На быстро меняющемся ветре вообще очень сложно добиться полной утилизации энергии ветра, если вообще возможно.<br />
Вот это как раз самая интересная задача. Я думаю для её решения надо<br />
1)	Делать винт максимально легким, для уменьшения его момента инерции.<br />
2)	Усложнять алгоритм поиск оптимальной точки. Или вводить элемент самообучения, который будет заключаться в автоматическом подборе оптимального шага дискретизации. Или делать алгоритм градиентного поиска оптимальной точки.<br />
<br />
Александр, насколько сложные программы может выполнять микроконтроллер?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">19.11.2012, 21:11</div></div><div class="posttext">Микроконтроллер может очень сложные программы выполнять. Дай Бог нам их написать.<br />
По поводу лёгких винтов. Тут есть проблема: если винт слишком лёгкий, то механическая прочность  его может оказаться недостаточной. Я не могу сказать, что у меня винт лёгкий, однако при усилении ветра от пяти до десяти метров в секунду он разгоняется очень быстро. Где-то примерно за секунду. И чтобы успевать за ним, мне пришлось проводить замеры знака ускорения в каждой положительной полуволне напряжения с генератора, а в отрицательной полуволне проводить коррекцию нагрузки.<br />
Если ветряк попадает в точку равенства мощностей, контроллер не даёт ему там застрять. Он его оттуда сталкивает. Поскольку он знает, что если скорость растёт либо стабильна, то нужно увеличить нагрузку. И делать это до тех пор, пока скорость не начнёт снижаться. В идеале должно  получаться, что контроллер балансирует на восходящей ветви перед самой вершинкой. По реальным наблюдениям что-то в этом духе происходит.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">19.11.2012, 21:38</div></div><div class="posttext">Микроконтроллер может очень сложные программы выполнять. Дай Бог нам их написать. <br />
А на каком языке надо писать программы?<br />
<br />
<br />
По поводу лёгких винтов. Тут есть проблема: если винт слишком лёгкий, то механическая прочность  его может оказаться недостаточной. Я не могу сказать, что у меня винт лёгкий, однако при усилении ветра от пяти до десяти метров в секунду он разгоняется очень быстро. Где-то примерно за секунду. И чтобы успевать за ним, мне пришлось проводить замеры знака ускорения в каждой положительной полуволне напряжения с генератора, а в отрицательной полуволне проводить коррекцию нагрузки.<br />
<br />
По мне, такой скорости реакции вполне достаточно. Главное поймать ветряк  в нужном месте.<br />
<br />
<br />
Если ветряк попадает в точку равенства мощностей, контроллер не даёт ему там застрять. Он его оттуда сталкивает. Поскольку он знает, что если скорость растёт либо стабильна, то нужно увеличить нагрузку. И делать это до тех пор, пока скорость не начнёт снижаться. В идеале должно  получаться, что контроллер балансирует на восходящей ветви перед самой вершинкой. По реальным наблюдениям что-то в этом духе происходит.<br />
<br />
Александр, а можете поподробнее рассказать о своем алгоритме. У вас нагрузка меняется всегда с постоянным шагом или с переменным?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">19.11.2012, 23:02</div></div><div class="posttext">BenGunn, Большинство пишет программы на СИ, некоторые - на Ассемблере. Кому что ближе и понятнее. Для различных МК могут быть и ещё какие-нибудь дополнительные языки. Я вообще, смеха ради, решил попробовать Bascom AVR, на нём и сделал прогу для МК.<br />
Шаг изменения остаётся неизменным. Пока сделал так. Однако меняется скорость реагирования. Она всегда синхронна с частотой генератора, поэтому чем выше частота, тем быстрее происходит реагирование.<br />
Алгоритм составлен из нескольких модулей:<br />
-измеритель длительности импульса<br />
-акселерометр<br />
-граничные условия.<br />
И ряда подпрограмм:<br />
-управление повышением мощности<br />
-управление снижением мощности<br />
-вывод на дисплей нужных параметров<br />
-вычисление скорости вращения винта в RPM.<br />
В измерительном модуле в самом начале производится запись предыдущего результата измерений. (Он потребуется акселерометру в дальнейшем.) Затем МК ожидает прихода единички на измерительном входе, а когда она появляется, начинает отсчёт времени, прекращая его  при появлении нуля. Теперь мы получили значение длительности импульса. И программа переходит в модуль акселерометра. Там сравнивается предыдущий результат с самым последним измерением, на основании чего МК делает вывод о том, чем занят в данное время винт. Если скорость винта растёт, либо стабильна, МК исполняет п/п управления повышением мощности, делая один шаг, после чего возвращается туда, откуда была вызвана, то есть, в акселерометр. Если же в акселерометре определилось, что скорость падает, то следует переход к п/п управления снижением мощности, там делается шаг назад, после чего идёт проверять граничные условия. Там проверяется, не слишком ли мала скорость винта, и если она ниже установленной, то нагрузку следует снять совсем. Это делается для того, чтобы винт не останавливался при запредельно малом ветре. У меня это соответствует примерно двум метрам в секунду. Параметр можно установить любой - по вкусу. Кроме того, в граничных условиях может содержаться информация о подключении второго канала ШИМ, если скорость вращения винта это позволяет. (У меня пока он не задействован).  По завершении модуля граничных условий МК возвращается к началу цикла, тут же переписывает ячейку предыдущего результата и снова измеряет импульс. И так всё время по кольцу... Время от времени МК выкидывает на дисплей данные о скорости вращения и величину длительности импульса.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">20.11.2012, 00:34</div></div><div class="posttext">Александр, я все равно не понимаю один момент в вашем алгоритме. Если скорость винта стабильна, то мы нагружаем его. Он начинает тормозить, контроллер это замечает и уменьшает нагрузку. Винт опять раскручивается и т.д. В чем смысл?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">20.11.2012, 01:48</div></div><div class="posttext">Здесь две причины. Первая обусловлена тем, чтобы не дать системе стабилизироваться. Система всё время должна находиться в поиске, иначе может произойти стабилизация на произвольном участке кривой винта. Если же система раскачивается, то хочет она того, или нет, но ей придётся отыскать точку наибольшей мощности. Вторая причина, это ВРШ. Здесь есть одна особенность. Когда винт стабилизировался аэродинамически, мы должны продолжать наращивать мощность на нём, отслеживая момент, когда скорость винта начнёт снижаться. Это и будет точка максимума. И для разной скорости ветра при одних и тех же оборотах винта она будет существенно отличаться. При условии, что генератор позволяет это. Мой как раз позволяет. <br />
<br />
Винт опять раскручивается и т.д.<br />
Пусть это никого не смущает. Контроллер замечает малейшее изменение скорости, отличие в длительности импульса в несколько микросекунд уже приводит к изменениям. На глаз это даже не заметно. Когда я только начинал над этим алгоритмом работать, я аккуратно нарисовал его на бумаге, много думал над возможными ошибками, проигрывая возможные ситуации. Вышло довольно сложно и монстрообразно. Затем сел и написал такую же монстрообразную программу в точном соответствии с моими идеями...<br />
...И программа работала коряво. Тогда я немного подумал, выкинул из неё всё, что там было, после чего она заработала. А затем расставил вокруг себя кучу приборов для измерения ветра, мощности и скорости вращения (тахометр в МК я встроил несколько позднее, когда мой электромеханический тахометр, подключенный к ветряку, благополучно дал дуба) и начал отладку программы. После сотой с чем-то там версии всё заработало, как мне было нужно. Или почти так, как мне было нужно. Из чего я сделал вывод, что при аналитическом решении задачи у нас недостаточно данных - мы не знаем реальную динамику винта, которая обусловлена не только его инерционными свойствами, но и взаимодействием с реальным ветром, которое, к сожалению, достоверно нельзя смоделировать, только очень приблизительно и только с целой кучей допущений. <br />
Отчасти мне самому было интересно попытаться реализовать алгоритм поиска точки максимума наиболее простыми средствами и я не вижу особых ограничений на то, как это можно достигать. Поэтому и решил попробовать завязать нагрузку непосредственно на винт. Поскольку именно он всё определяет, а мощность генератора - вещь вторичная. Собственно, генератор - это согласующее звено между винтом и нагрузкой. Посредник, так сказать. Ну и не хотелось связываться с измерительными примочками. Если напряжение ещё получается нормально и простыми способами измерить с помощью контроллера, то датчик тока довольно-таки дорогой.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">cheese</div><div class="date">20.11.2012, 07:23</div></div><div class="posttext">Александр, Вы собираетесь как то продвигать контроллер в массы?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">20.11.2012, 08:30</div></div><div class="posttext">Александр, спасибо вам за подробные ответы.<br />
Контроллер замечает малейшее изменение скорости, отличие в длительности импульса в несколько микросекунд уже приводит к изменениям.<br />
Я примерно так и подумал, что засчет неодинаковости торможения и раскрутки точка постепенно будет смещаться. <br />
<br />
<br />
Ну и не хотелось связываться с измерительными примочками. Если напряжение ещё получается нормально и простыми способами измерить с помощью контроллера, то датчик тока довольно-таки дорогой.<br />
<br />
Т.е. с измерением мощности на нагрузке могут возникнуть проблемы?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">20.11.2012, 20:30</div></div><div class="posttext">Я примерно так и подумал, что засчет неодинаковости торможения и раскрутки точка постепенно будет смещаться.<br />
Да, я тоже так считаю. <br />
<br />
Т.е. с измерением мощности на нагрузке могут возникнуть проблемы?<br />
Особых проблем нет, покупаем дорогостоящий сенсор тока, затем пишем подпрограмму чтения данных с этого сенсора, затем паяем схему для измерителя напряжения  пишем п/п измерения напряжения, затем пишем арифметику, которая всем этим будет пользоваться, после чего начинаем возиться уже с самим алгоритмом поиска максимума... В принципе, ничего особо страшного, возни только намного больше.:)<br />
<br />
Александр, Вы собираетесь как то продвигать контроллер в массы?<br />
Пока рановато. Он ещё сыроват.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">20.12.2012, 05:52</div></div><div class="posttext">Доброго здоровья! Повторил в BASCOM-е алгоритм Александра - нахождение максимума в зависимости от оборотов. При моделировании в Протеусе све пашет как надо. Но дальше затык. Не могу понять каким образом выщитать мощность, которую отдавать в балласт.<br />
И как подсчитать мощность в КВт*часах? Прийдется цеплять внешние часики от Dallas?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">20.12.2012, 10:25</div></div><div class="posttext">.......Особых проблем нет, покупаем дорогостоящий сенсор тока, <br />
<br />
не.. покупаем недорогой измерительный шунт под нужный ток и измеряем падение напряжения на нем.<br />
<br />
Добавлено через 1 минуту<br />
..............<br />
И как подсчитать мощность в КВт*часах? Прийдется цеплять внешние часики от Dallas?<br />
<br />
можно задействовать внутренний таймер контроллера для этих целей.<br />
выставляете его на 1 сек. и по сработка снимаете денные с шунта и с канала АЦП следящего за напряжением<br />
перемножаете это и кладете в ячейку Х1<br />
при следующей сработке таймера снова проделываете эту операцию и усредняете значение из ячейки Х1 с вновь полученным значением.<br />
делаете это в цикле 3600 раз..<br />
после окончания цикла сбрасываете значение из ячейки Х1 в организованную в памяти таблицу мощностей ( это у вас и будет мощность в час) меняете у этой таблицы адрес на след ячейку, сбрасываете в ноль значение Х1 и снова запускаете цикл...<br />
<br />
в результате у вас будет<br />
1. мгновенная секундная мощность<br />
2. средняя мощность в текущем часе<br />
3. Статистика по отдаче ветряка за некий период времени (определяется размером таблицы)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.12.2012, 15:26</div></div><div class="posttext">Спасибо на счет таймера.  <br />
Сегодня почитал, что еще можно использовать асинхронный таймер с часовым кварцем. Таймер тоже будет переполняться каждую секунду, не зависимо от частоты основного кварца процессора.<br />
Пока вот, что есть (во вложении исходник на BASCOM-е и проект в Proteus). Алгоритм следит за изменением длительности импульсов на одной из фаз и изменяет скважность общего ШИМ-а, который я дальше пытаюсь раскидать на аккумулятор, на потребители и балласт.<br />
Дмаю, что было-бы правильным производить вычисление и распределение ШИМ-ов не выходя из прерывания определения длительности импульса.<br />
<br />
<br />
'********Акселерометр и задача длительности импульса общего ШИМ ****************<br />
If U_r_gen &lt; 10 Then<br />
Pwm_main = 0<br />
Else<br />
     If Period &lt;= Period_old Then<br />
     If Pwm_main &lt; 255 Then Incr Pwm_main<br />
     Else<br />
     If Pwm_main &gt; 0 Then Decr Pwm_main<br />
     End If<br />
End If<br />
<br />
'************************Подпрограмма общета ШИМ-ов*****************************<br />
I_set_and_nagruzka = I_set_akb + I_r_nagruzka<br />
If U_r_akb &gt; U_set_akb Then<br />
If Pwm_ball &lt; Pwm_main Then Incr Pwm_ball<br />
End If<br />
If U_r_akb &lt;= U_set_akb And I_r_akb &gt; I_set_and_nagruzka Then<br />
If Pwm_ball &lt; Pwm_main Then Incr Pwm_ball<br />
End If<br />
If U_r_akb &lt;= U_set_akb And I_r_akb &lt;= I_set_and_nagruzka Then<br />
If Pwm_ball &gt; 0 Then Decr Pwm_ball<br />
End If<br />
Pwm_akb_and_nagruzka = Pwm_main - Pwm_ball<br />
Pwm0 = Pwm_akb_and_nagruzka<br />
Pwm2 = Pwm_ball</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">21.12.2012, 15:56</div></div><div class="posttext">vitalkalm, если вы и так собираетесь измерять мощность, попробуйте вместо периода сравнивать мощность на нагрузке. Это должно повысить эффектность контроллера.<br />
Только алгоритм немного изменится. Возможны синтаксические ошибки, так этого ЯП я не знаю, но думаю суть понятна.<br />
<br />
If U_r_gen &lt; 10 Then<br />
Pwm_main = 0<br />
Else<br />
If Power &lt;= Power_old Then Flag = -Flag<br />
End If<br />
If (Flag = 1) and(Pwm_main &lt; 255) Then Incr Pwm_main<br />
End If<br />
If (Flag = -1)and(Pwm_main &gt; 0) Then Decr Pwm_main<br />
End If<br />
<br />
Power - текущая мощность<br />
Power_old - мощность, которая была<br />
Flag - переменная, которая показывает, что мы делали на предыдущем шаге<br />
Общая идея такая. Если наше предыдущее действие(увеличение или уменьшение скважности ШИМ) привело к уменьшению мощности, то делаем противоположное действие, а если мощность увеличилась, то продолжаем делать то, что и делали.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.12.2012, 16:16</div></div><div class="posttext">vitalkalm, если вы и так собираетесь измерять мощность, попробуйте вместо периода сравнивать мощность на нагрузке. Это должно повысить эффектность контроллера.<br />
Дело в том, что я опасаюсь за быстродействие контроллера. Для пересчета мощности необходимы операции умножения, а для вычисления периода - нет. Хотя с другой стороны отпадает необходимость в остановке главного цикла для выполнения прерывания измерения периода импульса. <br />
Можно и ШИМ-ы выражать в зависимости от мощностей, но тоже нужно много умножать, что не желательно делать в середине прерывания.<br />
Я на распутье...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.12.2012, 16:35</div></div><div class="posttext">Вот, переделал на сравнение мощностей. Все красиво, Proteus сильно тормозит при  симулировании. Надо смотреть в железе. Пока бьюсь над подсчетом кВт*часов.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">21.12.2012, 16:44</div></div><div class="posttext">vitalkalm, перепишете алгоритм изменения скважности, на тот, который я написал выше. Иначе в некоторых случаях контроллер будет менять скважности неправильно.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.12.2012, 17:43</div></div><div class="posttext">vitalkalm, перепишете алгоритм изменения скважности, на тот, который я написал выше. Иначе в некоторых случаях контроллер будет менять скважности неправильно.<br />
Переписал и запихал все назад п обработчик прерывания. Все ОК.<br />
<br />
Может подпрограму вычисления мощности тудаже засунуть?<br />
<br />
Где-то видел способ измерения длительных импульсов без применения таймеров, а то много стоит процессор на прерывании.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">21.12.2012, 22:44</div></div><div class="posttext">vitalkalm, на прерывании процессор не стоит. Оно, прерывание, для того и существует, чтобы не тормозить процессор. Весь вопрос в том, как оно использовано.  Обработчик прерывания должен быть максимально коротким и не содержать ничего лишнего, кроме измерения длительности. Всё остальное должно делаться за пределами прерывания - все вычисления, изменение длительности ШИМ и т.д. Иначе есть риск превратить МК в улитку. Во время прерывания МК нельзя заставлять ожидать прихода чего-то там.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.12.2012, 23:24</div></div><div class="posttext">vitalkalm, на прерывании процессор не стоит. Оно, прерывание, для того и существует, чтобы не тормозить процессор. Весь вопрос в том, как оно использовано.  Обработчик прерывания должен быть максимально коротким и не содержать ничего лишнего, кроме измерения длительности. Всё остальное должно делаться за пределами прерывания - все вычисления, изменение длительности ШИМ и т.д. Иначе есть риск превратить МК в улитку. Во время прерывания МК нельзя заставлять ожидать прихода чего-то там.<br />
Вразумил. Выброшу из прерывания все лишнее. Бьюсь над меню настроек: Изменить количество импульсов на оборот, Максимальное напряжение Аккумуляторов, ограничение тока заряда. Может еще кто что предложит..</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">21.12.2012, 23:46</div></div><div class="posttext">Можно и без прерываний обойтись для измерения длительности. Тогда будет сэкономлен таймер для лишнего канала ШИМ. В Баскоме есть очень удобный оператор для этого дела - &quot;Pulsein&quot;. Я им вовсю пользуюсь и скорости проца мне хватает. Я измеряю не весь период, а только его половину. Ещё есть оператор &quot;Bitwait&quot;. Для любителей ловли импульса заданной полярности. Вместе они выглядят, например, так:<br />
<br />
Dim P As Word                                               ' переменная для длительности импульса<br />
 Bitwait Pinc.4 , Set                            'ждём, пока бит 4 порта С станет 1.<br />
  Pulsein P , Pinc , 4 , 1                                  'длительность импульса фронт - спад<br />
<br />
Очень рекомендую снабжать текст программы подробными комментариями. Это очень пригодится в дальнейшем. И это является хорошим тоном в программировании. Кто-то из великих мира компьютеров когда-то давно сказал так: &quot;Отсутствие комментариев в программе является достаточным основанием для увольнения программиста.&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">22.12.2012, 00:26</div></div><div class="posttext">...Очень рекомендую снабжать текст программы подробными комментариями. Это очень пригодится в дальнейшем. И это является хорошим тоном в программировании. Кто-то из великих мира компьютеров когда-то давно сказал так: &quot;Отсутствие комментариев в программе является достаточным основанием для увольнения программиста.&quot;<br />
Очень согласен...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">22.12.2012, 20:27</div></div><div class="posttext">Вот, с обши-и-ирными комментариями. Кто-то вдруг захочет разобраться. Комменты вставлял в блокноте, т.к. на работе нету BASCOM-а.<br />
Тут разбираюсь с асинхронным таймером.<br />
Нужно взять с него сигнал для считывания с АЦП данных по генератору с последующим подсчетом мгновенной, секундной мощности генератора, чтобы потом считать мощность в кВт*часах. Пока не дошло как. Но если дойдет, или подскажет кто, то можно будет писать в EEPROM мощность по часам, дням, месяцам. Плюс имеем на ЖКИ текущее время.<br />
Вот так оно выглядит<br />
&lt;TABLE border=0 width=700 bgColor=#c2ddfe align=center&gt;&lt;TBODY&gt;&lt;TR&gt;&lt;TD&gt;Синтаксис:<br />
CONFIG CLOCK = SOFT | USER<br />
SOFT - используется для самостоятельной реализации часов, на основе асинхронного таймера.<br />
USER - используется для реализации часов, на основе микросхем RTC.<br />
 <br />
 <br />
 <br />
<br />
&lt;/TD&gt;&lt;/TR&gt;&lt;/TBODY&gt;&lt;/TABLE&gt;<br />
 <br />
Разумеется, это только с виду одна команда. На самом же деле эта команда делает многое. А именно:<br />
1. Автоматически создает переменные _sec , _min , _hour, _day , _month , _year. <br />
2. Выставляет бит AS2 регистра ASSR, разрешающий асинхронный режим работы таймера / счетчикаT2.<br />
3. Выставляет прескалер 128, для таймера / счетчика T2 (регистр TCCR2).<br />
4. Выставляет бит TOIE2 регистра TIMSK, разрешающий работу прерывания по переполнению таймера / счетчика T2. <br />
5. Выполняет обработку прерывания по переполнению, увеличивая значения секунд, минут и часов.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.01.2013, 04:06</div></div><div class="posttext">Мои последние наработки. Особенности:<br />
- 2-й таймер завел в асинхронном режиме. В основном экране теперь отображается еще текущее время.<br />
- подсчет частоты оборотов организовал с помощью команды Pulsein, без применения таймера.<br />
- перебросил ШИМ на 1-й таймер, развел во времени моменты включения ШИМ-ов Аккумулятора и балласта, теперь они включаются в разное время, не мешая друг другу.<br />
- добавил меню настроек основных параметров, вход в меню происходит при длительном нажатии первой кнопки (кнопка &quot;О.К.&quot;):<br />
- напряжения начала отбора мощности<br />
- напряжение аккумулятора, при котором считается, что он уже заряжен<br />
- максимальный ток зарядки, зависящий от емкости аккумулятора<br />
- количество импульсов с одной фазы на один оборот генератора<br />
- отключение функции MPPT, при этом генератор грузится на полную, но программа по-прежнему раскидывает мощность по потребителям с приоритетом на аккумулятор.<br />
- настройка текущего времени и даты<br />
- организовал запись статистики в EEPROM контроллера. Памяти хватило за глаза (не закончено)<br />
- добавил меню статистики по минутам, часам, суткам, месяцам и годам (не закончено). Вход в меню статистики выполняется коротким нажатием на кнопку О.К. Можно погулять по статистике вверх-вниз и, если нужно, посмотреть, что творилось за полследний час, сутки, месяц или год<br />
Во вложении кекс, бин и проект Протеуса. <br />
 <br />
Не доконца организована работа со статистикой. Пока, что затык с математикой...<br />
Дальше разработка упирается в железо. Думаю, в качестве комутаторов нагрузок использовать драйвера HCPL-3120 и полевики по-мощнее (или IGBT). Для HCPL надо лепить блок питания +18В и -5В, для каждого драйвера свой. Усилители для токовых шунтов на операционниках.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">21.01.2013, 06:40</div></div><div class="posttext">Думаю, в качестве комутаторов нагрузок использовать драйвера HCPL-3120 и полевики по-мощнее (или IGBT).<br />
А не проще IR21хх серию с оптронами шустрыми использовать? Или не любишь рассыпуху?<br />
Например http://www.datasheetdir.com/IR2010+MOSFET-Drivers, тогда и полевиков можно навешивать столько, сколько надо, он вытянет очень много, если частоты заоблачные не ставить, а лучше 2110, напряжение выше. Или тут выбрать http://www.compitech.ru/html.cgi/arhiv/03_03/stat_22.htm.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">21.01.2013, 13:06</div></div><div class="posttext">Да мне одинаково, хоть на рассыпухе, хоть как.<br />
У нас цены:<br />
IR2110 -  12 гривен + оптопара 2-3 гривны.<br />
HCPL-3120 -  15 гривен.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">17.02.2013, 17:22</div></div><div class="posttext">Обнеовление программы и схемы. Теперь время считает DS1307, а статистика пишется в 24LC08.<br />
<br />
Частично собраны периферийные компоненты. Готов блок питания драйверов и вытравлены платы драйверов и формирователей сигналов для конроллера.<br />
Схемы формирователей - на LM358, преобразователь блока питания на TL494, драйверы на HPLC. Схемы не привожу - все по классике. Но если нужно будет, то нарисую.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">18.02.2013, 09:01</div></div><div class="posttext">Использовать 4 порта на 4 кнопки это БАРСТВО :-) потом портов для дальнейшего расширения функционала не хватит.<br />
сделай матрицу 2х2 и двумя портами ее читай<br />
<br />
или одним портом АЦП. подключив кнопки через делитель напряжения</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Саня77</div><div class="date">18.02.2013, 19:50</div></div><div class="posttext">http://www.aliexpress.com/store/product/1KW-1000w-Grid-Tie-Wind-Inverter-with-LCD-Display-Dump-Load-Controller-for-3-Phase-24v/403346_748779257.html<br />
Тоже МРРТ.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">19.02.2013, 22:21</div></div><div class="posttext">Использовать 4 порта на 4 кнопки это БАРСТВО :-) потом портов для дальнейшего расширения функционала не хватит.<br />
сделай матрицу 2х2 и двумя портами ее читай<br />
<br />
или одним портом АЦП. подключив кнопки через делитель напряжения<br />
<br />
Об АЦП забыл совсем, вкусный вариант.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">20.02.2013, 00:14</div></div><div class="posttext">Вот, в принципе, работает, но программа занимает на 2% больше памяти.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">20.02.2013, 01:08</div></div><div class="posttext">да возьми два порта...<br />
смотри.. у тебя опрос кнопок идет только по аппаратному прерыванию, которое формируется самими кнопками через четыре диода...<br />
значит ситуация когда все кнопки отпущены не может вызвать прерывание...<br />
тогда <br />
1 кнопка идет только на прерывание и к порту ее не подключаем и диод тоже не нужен<br />
2,3,4 кнопки через матрицу из двух диодов формируют на двух портах варианты 00,01,10 и так же как у тебя через диоды вызывают прерывание.<br />
если при прерывании возник вариант 11 значит эти три кнопки отпущены а нажата первая кнопка...<br />
понятно или нарисовать?<br />
схема больше на 1 диод, но 2 бита на порту ты освободишь под датчики которых тебе вешать еще дофига, судя по письменам на жки</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">20.02.2013, 01:53</div></div><div class="posttext">Спасибо большое за пояснения. Рисовать не нужно, я сам, во вложении, так? <br />
А &quot;Письмена&quot; на жки отображают считаную и обработанную информацию с уже имеющихся датчиков. Пока портов хватает, я, вон, от скуки светодиодов даже навешал, а ведь они информативности не добавили. Ну а память вот на пределе...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">20.02.2013, 09:11</div></div><div class="posttext">Да, так.<br />
Ты в железе уже реализовал? может есть смысл перескочить на атмегу328, там внутрисистемной памяти в 2 раза больше.<br />
И еще один плюс. у328 атмеги внутренний источник опорного напряжения можно на 1,1В запрограмить.<br />
это удобно если используешь датчики тока, у них выходное напряжение 0...1В.<br />
а еще там индикатор можно повесить на шину I2C, на неё же повесить память для сбора статистики,и с часами работать через эту же шину. Сильно упростит схемотехнику.<br />
а отладку делать подключив комп через ком-&gt;USB порт и вываливая информацию отладочную в терминале, <br />
<br />
<br />
твой визуал сожрет все ресурсы, 16 атмега думаю маловата<br />
мне вот такие (http://www.ebay.com/itm/310568454961?ssPageName=STRK:MEWNX:IT&amp;_trksid=p3984.m1497.l2649) сборки приглянулись для опытов.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vitalkalm</div><div class="date">20.02.2013, 17:15</div></div><div class="posttext">Да, вкусная сборка. В любом случае надо в железе котроллер делать, хоть на 16 меге. А потом можно и дальше развиваться. Кстате на I2C экранчик можно и на 16 привинтить. Из железа есть только периферия. Нужно еще преобрести ЖК 20*4, перу полевиков, микросхемы драйверов и, собственно, мегу16. Для датчиков тока пока думаю использовать обычные шунты с операционниками, а то интегральные пока дороговаты...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">serg156</div><div class="date">15.04.2013, 18:08</div></div><div class="posttext">Добрый день! Почитал форум, очевидно, что тут собрались настоящие энтузиасты альтернативной энергетики, которые проделали на голом энтузиазме, то есть даром очень большой объём работы, в чём вам всем честь и хвала. И я тоже хочу внести свою скромную лепту в ваш титанический труд. Начну с простой вещи. Я по каналу &quot;Дискавери&quot; смотрел фильм про ветряные установки , установленные на побережье Северного моря, установки промышленные , на десятки мегават, и там особо много внимания было уделено оптимизации работы ветрогенератора. Не буду утомлять пересказом фильма, отмечу только главный момент, который отсутствует в наших расчётах. В фильме рассказывалось, что на каждый ветрогенератор делалась его оптимальная нагрузочная характеристика для отбора максимального количества энергии. У них регулировалось частота вращения ветряка в зависимости от набегающей на него скорости ветра. Для этого на каждом ветряке  стоял ещё один измерительный маленький ветрячёк, типа метерологического, и по его данным регулировали нагрузку на генератор, то есть вгоняли работу ветряка в оптимальный. Например, по расчётам или эксперементально определили, что при скорости ветра 10 м/с максимум генерируемой мощности будет при 300х оборотах в минуту, а на данный момент ветряк делает 350 оборотов, электроника подключает дополнительную нагрузку, и ветряк замедляет обороты до 280 в минуту, электроника видит, что ветряк перегружен, обороты меньше оптимальных и снимает часть нагрузки с ветряка, позволяя ему набрать обороты до оптимальных 300. Ещё раз повторюсь, что вся регулировка напрямую завязана на скорость ветра, которую меряет в режиме он лайн ещё один маленький метерологический ветрячёк. Имхо, без замера ветра у нас нету привязки к подводимой ветряной мощности, которая является переменной функцией во времени, и регулируемой нами переменной нагрузкой. Без учёта этих параметров говорить о работе ветрогенератора в режиме максимальной мощности невозможно!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">15.04.2013, 18:22</div></div><div class="posttext">serg156, этот подход здесь на форуме то же обсуждался, он не отброшен в мусорный ящик.<br />
Но имеется возможность приблжаться к оптимуму и без дополнртельного измерителя ветра, так как сам ветряк тоже таковым является.<br />
А смысл этого подхода в том, что устройство не привязано по параметрам к отдельно взятому конкретному ветряку, но может работать с любым.<br />
С уть такого регулирования в том, чтоб постоянно изменяя отбор на небольшую величину определять, в нужном направлении было сделано изменение и в зависимоти от этого продолжать изменение в том же направлении, либо в обратном.<br />
Сложность етого подхода в том, что нельзя просто тупо вытягивать мощу с ветряка, так как при этом на самом деле вытягивается моща не только ветра, но и инерции ветроколеса, рмультипликатора и генератора.<br />
Вот эту инерцию и придётся учитывать, чтоб не обманываться инерцией.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">15.04.2013, 23:23</div></div><div class="posttext">Практическая попытка использовать дополнительный измеритель скорости ветра была сделана Серкатом на его ветряке. И он от неё отказался, поскольку показания анемометра абсолютно неадекватны. Эта неадекватность усугубляется особо, если ветряк снабжён винтом регулируемого шага. Допускаю, что на ветряках мегаваттного класса это как-то можно учитывать, что и делается, иначе наличие анемометра на ветряке не объяснить. У них практически не работает центральная зона винта диаметром почти два десятка метров. В наших же мелких ветряках мёртвая зона составляет весьма небольшую величину. Скорость ветра начинает снижаться ещё на подходе к винту и это снижение уже заметно на расстоянии перед винтом, равном его диаметру. А в плоскости ветроколеса оно уже  составляет 1/3 от скорости ветра. Это при условии, что коэффициент нагрузки на ветроколесо равен 0,888 (что является оптимальным для максимального отбора энергии потока). Это подразумевает, что ветряк работает на оптимальную нагрузку при данной скорости ветра. Если изменится либо нагрузка, либо скорость ветра, коэффициент торможения станет другим и вся ветровая картина как на самом ветряке, так и на его  анемометре - изменится. По этой причине приходится отказываться от прямого измерения скорости ветра и пользоваться другими, намного более сложными методами.  В этом и заключается основная проблема при  построении системы, оптимизирующей работу ветряка.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">15.04.2013, 23:40</div></div><div class="posttext">Почему то у меня не вызывает доверия анемометр, установленый вблизи ветроколеса, а установленый вдалеке от ветроколеса --  тем более не вызывает доверия.<br />
Доверие вызывает дифференциальный датчик давления, используемый на летательных аппаратах в качестве измерителя скорости, только там , вместе с барометрическим высотомером он берёт давления с ПВД --  Приёмника Воздушного Давления, а на ветряке можно брать разницу перед винтом и за винтом.<br />
Можно обнаглеть и принимать давление через пустотелый вал ветроколеса, а в качестве датчика использовать не сильфон с приделаным к нему уникальным проволочным резистором, а девайс, по устройству повторяющий счётчик для воды, т.е. расходомер, а может покатит и тензометрический датчик : а пусть трубка просто дует на плоскую пластинку, закреплённцю на шарнирчике, а та в свою очередь пусть давит на электронные весы, как поплавок в карбюраторе автомобиля давит на запорную иглу.<br />
<br />
А ничё так бредовая идейка ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">16.04.2013, 05:12</div></div><div class="posttext">А ничё так бредовая идейка ?<br />
М-да...<br />
Несёт тебя не по детски:wacko2:...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">serg156</div><div class="date">16.04.2013, 13:03</div></div><div class="posttext">serg156, этот подход здесь на форуме то же обсуждался, он не отброшен в мусорный ящик.<br />
Но имеется возможность приблжаться к оптимуму и без дополнртельного измерителя ветра, так как сам ветряк тоже таковым является.<br />
Согласен, что ветряк сам является измерителем скорости  ветра, вот только он даёт очень сильную погрешность, что имхо , не позволяет его использовать как источник данных для оптимизации отдачи энергии. Меняющаяся при оптимизации нагрузка на генератор влияет на обороты, и мы получаем уже другую силу ветра, о которой мы можем судить только по числу оборотов ветряка. Можно вытащить силу ветра как функцию от получаемой мгновенной мощности и текущих мгновенных оборотов, но для этого как минимум надо ставить датчик оборотов, иметь полученную на практике модель  работы на динамической нагрузке с оптимальным числом оборотов, и устройство поддержания заданных оптимальных оборотов. Пока что очень мало мне попадалось квалифицированных расчётов на эту тему, да и получение функции с последующим её математическим программированием в пик контроллер задача для профессиональных инженеров электронщиков.<br />
<br />
serg156<br />
А смысл этого подхода в том, что устройство не привязано по параметрам к отдельно взятому конкретному ветряку, но может работать с любым.<br />
С уть такого регулирования в том, чтоб постоянно изменяя отбор на небольшую величину определять, в нужном направлении было сделано изменение и в зависимоти от этого продолжать изменение в том же направлении, либо в обратном.<br />
Сложность етого подхода в том, что нельзя просто тупо вытягивать мощу с ветряка, так как при этом на самом деле вытягивается моща не только ветра, но и инерции ветроколеса, рмультипликатора и генератора.<br />
Вот эту инерцию и придётся учитывать, чтоб не обманываться инерцией.<br />
Очень интересно посмотреть на математическую формулу и алгоритм, который вы применяете для определения точки максимальной мощности, и принцип устройства, которое может так забирать с ветряка мощность. Кроме шима и коммутации обмоток, ничего на первый взгляд не приходит на ум.<br />
<br />
Добавлено через 18 минут<br />
Практическая попытка использовать дополнительный измеритель скорости ветра была сделана Серкатом на его ветряке. И он от неё отказался, поскольку показания анемометра абсолютно неадекватны. <br />
А можно сылочку на его опыты? Очень хочется изучить его опыт. Как то странно звучит заявление об неадекватности анемометра. На всех метеостанциях они используются уже очень давно, и как то не замечено жалоб на их работу.<br />
<br />
Эта неадекватность усугубляется особо, если ветряк снабжён винтом регулируемого шага. Допускаю, что на ветряках мегаваттного класса это как-то можно учитывать, что и делается, иначе наличие анемометра на ветряке не объяснить. У них практически не работает центральная зона винта диаметром почти два десятка метров. В наших же мелких ветряках мёртвая зона составляет весьма небольшую величину. Скорость ветра начинает снижаться ещё на подходе к винту и это снижение уже заметно на расстоянии перед винтом, равном его диаметру.<br />
<br />
А что мешает разместить анемометр ниже на 1-2 метра от нижнего края лопасти на мачте? Имхо, не так сильно будет меняться ветер на 2 метра вниз. Даже если в плоскости ветряка оно составляет уже 1/3 , то насколько нам это важно? Имхо, нам для расчётов нужна только динамика изменения ветра, на три можно без проблем умножить программно в пик контроллере. <br />
<br />
<br />
 А в плоскости ветроколеса оно уже  составляет 1/3 от скорости ветра. Это при условии, что коэффициент нагрузки на ветроколесо равен 0,888 (что является оптимальным для максимального отбора энергии потока). Это подразумевает, что ветряк работает на оптимальную нагрузку при данной скорости ветра. Если изменится либо нагрузка, либо скорость ветра, коэффициент торможения станет другим и вся ветровая картина как на самом ветряке, так и на его  анемометре - изменится. По этой причине приходится отказываться от прямого измерения скорости ветра и пользоваться другими, намного более сложными методами.  В этом и заключается основная проблема при  построении системы, оптимизирующей работу ветряка. Если так сложно сделать измерение скорости потока воздуха, то без снятой функции оптимальной работы конкретного ветряка найти точку максимального отбора мощности невозможно. Вы можете сколько угодно долго делать итерации в попытке догнать постоянно меняющуюся точку МОМ, и впоймать её можете только случайно. Если я не прав, укажите мне на мои ошибки.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">16.04.2013, 13:03</div></div><div class="posttext">Можно вытащить силу ветра как функцию от получаемой мгновенной мощности и текущих мгновенных оборотов, но для этого как минимум надо ставить датчик оборотов, что что, а уж датчиком оборотов сам ветряк и является ( если только в качестве генератора не исполбзуется коллекторная машынка постоянного тока)<br />
Очень интересно посмотреть на математическую формулу и алгоритм, который вы применяете для определения точки максимальной мощности, и принцип устройства, которое может так забирать с ветряка мощность. Кроме шима и коммутации обмоток, ничего на первый взгляд не приходит на ум.<br />
У меня нет никакой, формулы, нет алгоритма, это всё есть у тех, кто этим вопросом занимается уже давно.<br />
У меня есть уверенность, что это всё реально возможно, так же есть уверенность, что тем, у кого уже есть намётки или рабочие прототипы, придётся ещё хорошенько повкалывать для того, чтоб получить адекватность и стабильность работы алгоритма.<br />
Да, ступенчатые коробки передач и такое же переключение обмоток отваливаются сразу, вариатор отваливается из за его низких КПД и долговечности.<br />
Остаётся ШИМ и ЧИМ! -- наши надежды и опоры ! http://hippydom.forum24.ru/gif/smk/sm146.gif</div></div><hr />


<div class="post"><div class="posttop"><div class="username">sergik</div><div class="date">16.04.2013, 22:03</div></div><div class="posttext">нам для расчётов нужна только динамика изменения ветра, на три можно без проблем умножить программно в пик контроллере.<br />
<br />
Когда вы построите первый ветряк и понаблюдаете за его работой, то поймете, что динамика изменения скорости и направления ветра даже более динамична, чем мы о ней думаем.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">17.04.2013, 03:35</div></div><div class="posttext">serg156, вот тема Сергея Ветрова - посмотрите, для одного из агрегатов он использует контроллер отбора мощности, сделанный Серкатом http://windpower-russia.ru/forum/member.php?u=51<br />
<br />
<br />
вот тема Серката на братском форуме http://alter-energo.ru/topic526.html<br />
<br />
Добавлено через 8 минут<br />
Когда вы построите первый ветряк и понаблюдаете за его работой, то поймете, что динамика изменения скорости и направления ветра даже более динамична, чем мы о ней думаем.<br />
<br />
Для большего понимания дополню.<br />
Ветряк стоит не всегда высоко. Чем ближе к земле, тем более неравномерный поток действует на турбину в итоге, где бы не стоял анемометр - он будет показывать с погрешностью, которую рассчитать нереально. <br />
Эта погрешность будет плавающая и будет зависеть от всего - влажность, направление ветра, температура, есть ли листья на деревьях, какова высота снежного покрова и т.д. - все эти факторы вносят свой вклад в неравномерность потока - чем выше неравномерность, тем больше погрешность.<br />
а 10% погрешности по ветру это 33% по мощности.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">serg156</div><div class="date">17.04.2013, 09:06</div></div><div class="posttext">что что, а уж датчиком оборотов сам ветряк и является ( если только в качестве генератора не исполбзуется коллекторная машынка постоянного тока)<br />
<br />
У меня нет никакой, формулы, нет алгоритма, это всё есть у тех, кто этим вопросом занимается уже давно.<br />
У меня есть уверенность, что это всё реально возможно, так же есть уверенность, что тем, у кого уже есть намётки или рабочие прототипы, придётся ещё хорошенько повкалывать для того, чтоб получить адекватность и стабильность работы алгоритма.<br />
Да, ступенчатые коробки передач и такое же переключение обмоток отваливаются сразу, вариатор отваливается из за его низких КПД и долговечности.<br />
Остаётся ШИМ и ЧИМ! -- наши надежды и опоры ! http://hippydom.forum24.ru/gif/smk/sm146.gif<br />
<br />
Вы очень точно подметили, что у кого то уже есть рабочие прототипы. Продолжая изучать вопрос, я неожиданно для себя пришёл к выводу, что в связи с бурным развитием бытовой ветроэнергетики и наличием на ебае , а особенно на китайских форумах большого количества небольших ветрогенераторов 200- 600 ватт обязательно должно было сопровождаться развитием электроники для них. Уверен, что изготовители микросхем уже разработали готовые контроллеры МОМ для ветряков, и если обратиться на соответствующие форумы по электронике, то хорошие ребята нам подскажут, какие готовые контроллеры  уже есть. Это мнение обосновывается на опыте,что на все возможные случаи есть готовые микросхемы и  контроллеры, сделанные и отлаженные профессионалами на испытательных стендах и лабораториях с составлением к ним даташитов. Наша задача , имхо, не изобретать, то что уже на 99,99% наверняка изобретено, а направить наши усилия на поиск подходящего решения, которое нам останется только адаптировать под наши конкретные ветряки. Что скажете на это предложение?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">17.04.2013, 11:44</div></div><div class="posttext">Наша задача , имхо, не изобретать, то что уже на 99,99% наверняка изобретено, а направить наши усилия на поиск подходящего решения, которое нам останется только адаптировать под наши конкретные ветряки. Что скажете на это предложение? Не надо говорить за всех, например моя задача : как можно меньше покупать того, что производят производители, особенно если по моему мнению стоимость товара не соответствует его функциональности.<br />
<br />
А цены так и будут не соответствовать до тех пор, пока  в любом гараже любой умелец не будет иметь возможность собрать аналог, не ступающий по параметрам и эффективности.<br />
-- не обязательно делать, главное, иметь возможность.<br />
<br />
А так, на фоне всеобщей неинформированности и отсутствии нормальной конкуренции, производители, в основном, впаривают какие то не вполне адекватные коробочки с контактами и наворотами,<br />
более менее адекватная продукция  стоит денежек, не про наши карманы.<br />
<br />
Наверно не стоит развивать тут обсуждение применимости готовых  усиройств, так как тема то не о поиске готовых продуктов и решений , а, в первую очередь о том, как  самостоятельно создать<br />
рабочее , самоадаптируещееся устройство согласования ветряка и нагрузки.<br />
<br />
Подобные устройства для СБ , сделаные на коленке, уже вовсю работают и радуют своими параметрами.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">18.04.2013, 12:48</div></div><div class="posttext">... Уверен, что изготовители микросхем уже разработали готовые контроллеры МОМ для ветряков..... готовые контроллеры  уже есть. .... на все возможные случаи есть готовые микросхемы и  контроллеры..... <br />
<br />
Считаю, что было бы здорово за вменяемые деньги найти такой контроллер, на который только силовую часть останется навесить.<br />
Вот только не верится в такие чудеса, хотя бы потому, что подавляющее большинство малых ветряков, поступающих в продажу укомплектованы обычным балластным регулятором с неизвестными характеристикам, <br />
и тот факт, что продавцы  балластный регулятор называют контроллером - ничего не меняет.<br />
<br />
Нужного нам типа контроллером комплектует свои ветряки фирма &quot;мир ветра&quot;, думаю VVV не откажет в ответе на вопрос - на каких микросхемах они их собирают (на специализированных или общего назначения).</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">18.04.2013, 14:53</div></div><div class="posttext">специализированных или общего назначения<br />
а что тут думать? Там как раз и всё понятно. Атмеги и только они... Сейчас уже не найду, но с пол годика назад нарывался на кусок схемы от VVV, АТМЕГА рулит, сразу выкинул, т.к. програмирование оных не для меня....<br />
<br />
Добавлено через 1 минуту<br />
продавцы балластный регулятор называют контроллером - ничего не меняет<br />
В них тоже в большинстве стоят атмеги... В стандартном солнечном стоит, сам видел.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">18.04.2013, 15:26</div></div><div class="posttext">И на чём они под Атмегу пишут ?<br />
Сдаётся мне, что мощный проц нужен лишь из за того, что пишется всё на высокоуровне.<br />
а у меня завалялось 2 десятка pic1673f<br />
если шим аппаратный, снаружи,  а код на чистом ассемблере, то его на солнце хватит за глаза. но и на ветер тоже должно хватить<br />
а я на них ничё не умею. (((</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">18.04.2013, 15:43</div></div><div class="posttext">а я на них ничё не умею. (((<br />
анналогично...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Tema0</div><div class="date">18.04.2013, 16:07</div></div><div class="posttext">атмеги сейчас ведро за три рубля стоят...<br />
есть тем более готовые атмеговые сборки с кварцами и питанием.<br />
на ебее ну очень доступные.<br />
и производительность проца и объем памяти там позволяет писать на высокоуровневых языках.. что гораздо проще и быстрее. я подсел на 328 атмегу а платформу сейчас использую клон ардуино -мини.<br />
900 рублей за 5 штук, все на борту и отладочный/программный софт бесплатный...<br />
ну и много людей с ней работают - легко любую задачу решить на тематическом форуме ардуино.ру</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angbor</div><div class="date">15.05.2013, 22:47</div></div><div class="posttext">Всем привет.<br />
Начал читать тему с начала... на 14-той странице терпения не хватило, перешел в конец.<br />
Скажите, в итоге кто-нибудь хотя бы эмулятор на каком-нить вижл-бейсике написал?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">16.05.2013, 14:23</div></div><div class="posttext">Скажите, в итоге кто-нибудь хотя бы эмулятор на каком-нить вижл-бейсике написал?<br />
Эмулятор чего?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angbor</div><div class="date">16.05.2013, 14:55</div></div><div class="posttext">эмулятор прибора, который тут обсуждается<br />
мышкой ползунок дергаешь, изображая изменения ветра. Эмулятор просичтывает момент, изменение оборотов. этого достаточно, чтобы отрабатывать алгоритм управления мощностью на выходе<br />
<br />
когда эмулятор готов, тогда имеет смысл уже пробовать переносить это на железо. конечно крутые микропроцессорщики и без такого захода все сделают... но где они?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">18.05.2013, 23:10</div></div><div class="posttext">Angbor, лучше, если эмуляция изменений скорости ветра будет происходить автоматически по случайному закону. А мы можем только задавать пределы - min/max. Сложность может представлять момент инерции винта. Вот если бы мы могли придумать такой алгоритм, которому инерция винта безразлична, было бы здорово.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">petruha256</div><div class="date">19.05.2013, 02:51</div></div><div class="posttext">Angbor, примерно так видятся основные тезисы по алгоритмам управления:<br />
<br />
&lt;!--[if gte mso 9]&gt;&lt;xml&gt;  &lt;w:WordDocument&gt;   &lt;w:View&gt;Normal&lt;/w:View&gt;   &lt;w:Zoom&gt;0&lt;/w:Zoom&gt;   &lt;w:PunctuationKerning/&gt;   &lt;w:ValidateAgainstSchemas/&gt;   &lt;w:SaveIfXMLInvalid&gt;false&lt;/w:SaveIfXMLInvalid&gt;   &lt;w:IgnoreMixedContent&gt;false&lt;/w:IgnoreMixedContent&gt;   &lt;w:AlwaysShowPlaceholderText&gt;false&lt;/w:AlwaysShowPlaceholderText&gt;   &lt;w:Compatibility&gt;    &lt;w:BreakWrappedTables/&gt;    &lt;w:SnapToGridInCell/&gt;    &lt;w:WrapTextWithPunct/&gt;    &lt;w:UseAsianBreakRules/&gt;    &lt;w:DontGrowAutofit/&gt;   &lt;/w:Compatibility&gt;   &lt;w:BrowserLevel&gt;MicrosoftInternetExplorer4&lt;/w:BrowserLevel&gt;  &lt;/w:WordDocument&gt; &lt;/xml&gt;&lt;![endif]--&gt;  <br />
  <br />
<br />
 когда      винт вращается – он получает от потока механическую мощность<br />
<br />
  N1=f(w;v) зависит от угловой скорости вращения винта и скорости ветра. Эта мощность может быть как больше нуля, так и меньше. У каждого ветряка эта функция своя.<br />
  Пример можно увидеть на рис 217 стр. 346 библии: http://windpower-russia.ru/forum/showthread.php?p=430#post430<br />
   <br />
  <br />
<br />
 мощность      которую получает винт распределяется на:<br />
<br />
  а) преодоление трения в конструкции и подвесе ротора (пренебрегаем)<br />
  б) выработку полезной и бесполезной работы в генераторе  суммарно обозначу как N2<br />
  N2=f(w;I) – функция, которая однозначно определяется частотой вращения и током генератора<br />
  в) изменение кинетической энергии ротора N3=J*w*e, где J – момент инерции ротора, e – угловое ускорение ротора e=dw/dt. N3 также может быть положительной и отрицательной (ротор ускоряется или замедляется)<br />
   <br />
   <br />
  N1=     N2+    N3    <br />
  f(w;v)=f(w,I)+J*w*dw/dt<br />
   <br />
  в первом варианте задача такова, что используя переменные, подлежащие измерению нужно вычислить значение f(w;v) <br />
  далее сравнить полученное значение с функцией максимальной мощности Nmax=f(w)   (тот же рисунок 217 – строим функцию через точки максимумов кривых и получаем нечто вроде кубической параболы)<br />
  далее – если N1&gt;Nmax – значит винт перегружен и необходимо уменьшить значение N2 и, соответственно наоборот<br />
   <br />
  неизвестная переменная здесь только v – скорость ветра. Именно невозможность определения этой переменной в данном алгоритме заменяется сравнением  N1 с Nmax, <br />
   <br />
  w- измеряется однозначно<br />
   <br />
  с мощностью N2 не всё просто – если контроллер делать для универсального применения, то нужно рассчитывать на то, что сама функция может быть неизвестна,  так как не каждый самодельщик сможет произвести замеры на предмет соответствия механической мощности оборотов и тока для своего генератора. Другой подход определение мощности N2 через измеренную электрическую мощность в нагрузке и КПД генератора (но в этом случае КПД тоже будет функцией)<br />
   <br />
  J (момент инерции) - хоть и константа, но с потолка его не срисуешь, и рассчитывать на то, что каждый сможет самостоятельно рассчитать или измерить  его для своего ветряка тоже не стоит – нужно придумать способ его определения.<br />
   <br />
  Функция Nmax=f(w) изначально также неизвестна и для получения этой функции (коэффициента в уравнении параболы) также нужны соответствующие танцы с бубном.<br />
   <br />
  В втором варианте используется сравнение N1 не с Nmax, а со своим предыдущим значением, для вычисления N1 также нужны момент инерции J и угловая скорость w.<br />
  Разница в сравнении значений определяет то, в какую сторону нужно изменять мощность N2. Для того, чтобы разница существовала всегда – алгоритм должен обеспечивать качание величины N2 в некоторых пределах и тогда при сравнении результатов до и после будет ясно – туда плывем или не туда.<br />
   <br />
   <br />
  в первом варианте имеем необязательность знания момента инерции (не учитываем N3) - тогда алгоритм в некоторой степени теряет скорость реакции на порывы ветра. Но проблему представляет знание функции Nmax<br />
   <br />
  Во втором варианте функция Nmax не нужна, но без знания момента инерции никак нельзя.<br />
<br />
Хочется третий вариант - в котором ни Nmax ни момент инерции не нужны...:))<br />
  &lt;!--[if gte mso 9]&gt;&lt;xml&gt;  &lt;w:LatentStyles DefLockedState=&quot;false&quot; LatentStyleCount=&quot;156&quot;&gt;  &lt;/w:LatentStyles&gt; &lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if gte mso 10]&gt; &lt;style&gt;  /* Style Definitions */  table.MsoNormalTable     {mso-style-name:&quot;Обычная таблица&quot;;     mso-tstyle-rowband-size:0;     mso-tstyle-colband-size:0;     mso-style-noshow:yes;     mso-style-parent:&quot;&quot;;     mso-padding-alt:0cm 5.4pt 0cm 5.4pt;     mso-para-margin:0cm;     mso-para-margin-bottom:.0001pt;     mso-pagination:widow-orphan;     font-size:10.0pt;     font-family:&quot;Times New Roman&quot;;     mso-ansi-language:#0400;     mso-fareast-language:#0400;     mso-bidi-language:#0400;} &lt;/style&gt; &lt;![endif]--&gt;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angbor</div><div class="date">19.05.2013, 15:42</div></div><div class="posttext">Так... уже интересно :)<br />
На огороде мозг в основном спинной, работает. Нужно время на переключение :)<br />
<br />
Сразу вопросы дилетанта - <br />
может быть бредовый... <br />
Может ли ветряк (любой ли ветряк может) работать как вентилятор, т.е. можно ли запустить вращение винта, используя генератор как электро-мотор? Если да, то можно определить инерцию любого винта в отсутствие ветра, разогнав винт до тестовых оборотов и получив время их снижения.<br />
<br />
Второе. Я читал тут про сложность измерения скорости ветра. <br />
Вопрос, почему не разместить датчик в валу винта? Если вал полый, то вполне себе туда помещается трубка, на другом конце которой ставим цифровой датчик давления, который подключаем к нашему девайсу... Правда, если вал не полый, или/и если пользователь не сможет внести требуемые изменения в конструкцию, то прибор теряет универсальность...  да, так что ладно, про скорость ветра забудем :(<br />
<br />
Александр, кончено, можно и так задавать скорость ветра. Это наименьшая сложность в программе. Можно и так сделать и так.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Саня77</div><div class="date">19.05.2013, 16:04</div></div><div class="posttext">Сразу вопросы дилетанта - <br />
может быть бредовый... <br />
Может ли ветряк (любой ли ветряк может) работать как вентилятор, т.е. можно ли запустить вращение винта, используя генератор как электро-мотор? Если да, то можно определить инерцию любого винта в отсутствие ветра, разогнав винт до тестовых оборотов и получив время их снижения.<br />
Только коллекторные генераторы. Переделанный асинхронник в принципе тоже можно.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angbor</div><div class="date">20.05.2013, 01:32</div></div><div class="posttext">Возник еще один вопрос.<br />
А насколько вообще велика экономическая выгода от данного прибора? Т.е. сколько процентов мы теряем без него и сколько - будем приобретать с ним?<br />
Чтобы хотя бы понять, это просто интересная задачка, или реально с ним ветряк будет намного (или не на много) более производительным?<br />
Или это мы в том числе и призваны выяснить? :)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">20.05.2013, 03:47</div></div><div class="posttext">Angbor, Для стандартных солнечных батарей в идеале ( мороз и солнце, аккумулятор сильно разряжен, КПД МППТ контроллера прилично за 90%) до 140% в сравнении с подключением &quot;влоб&quot;.<br />
 Для ветра, очень зависит от конкретного ветряка, но, пожалуй , в большинстве случаев не меньше, а значительно бОльшая прибавка, чем с солнцем.<br />
Но реализация такого устройства для ветряка и намного сложнее, чем для солнца.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">BenGunn</div><div class="date">20.05.2013, 11:07</div></div><div class="posttext">Второе. Я читал тут про сложность измерения скорости ветра. <br />
Вопрос, почему не разместить датчик в валу винта? Если вал полый, то вполне себе туда помещается трубка, на другом конце которой ставим цифровой датчик давления, который подключаем к нашему девайсу... Правда, если вал не полый, или/и если пользователь не сможет внести требуемые изменения в конструкцию, то прибор теряет универсальность...  да, так что ладно, про скорость ветра забудем :(<br />
<br />
Проблема в том, что когда ветряк работает, скорость ветра в плоскости винта отличается от общей скорости ветра. Поэтому измерять скорость ветра надо на некотором расстоянии от винта.<br />
<br />
<br />
Возник еще один вопрос.<br />
А насколько вообще велика экономическая выгода от данного прибора? Т.е. сколько процентов мы теряем без него и сколько - будем приобретать с ним?<br />
Чтобы хотя бы понять, это просто интересная задачка, или реально с ним ветряк будет намного (или не на много) более производительным?<br />
Или это мы в том числе и призваны выяснить? :)<br />
Все зависит от того, насколько хорошо согласован винт и генератор. Чем хуже согласован винт с генератором, том большее увеличение мощности даст контроллер. Но даже для хорошо согласованных винта и генератора при определенной скорости ветра выигрыш может составить до 40%. <br />
<br />
<br />
в первом варианте имеем необязательность знания момента инерции (не учитываем N3) - тогда алгоритм в некоторой степени теряет скорость реакции на порывы ветра. Но проблему представляет знание функции Nmax<br />
  Во втором варианте функция Nmax не нужна, но без знания момента инерции никак нельзя. <br />
<br />
petruha256, как измерить момент инерции и Nmax, мы вроде придумали, вот только заставить в моей программе работать второй вариант у меня так и не получилось, зато первый работает отлично.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Angbor</div><div class="date">21.05.2013, 01:35</div></div><div class="posttext">&quot;На некотором расстоянии от винта&quot; - а на каком? Хотя в любом случае, если для установки контроллера потребуется переделка механики, Это уже не универсальный контроллер...<br />
<br />
Что касается сути вопроса, я пока в стадии &quot;начитки информации&quot;, увы, я совсем зеленый в этом вопросе.<br />
<br />
А что касается эмулятора, то я сделал страничку проекта на sourceforge.net (http://sourceforge.net/projects/wpcontroller/)<br />
Выложил примитив, объясняющий, что именно я имею ввиду под симулятором (эмулятором) реал-тайм. Как я уже писал, мне кажется, что для &quot;железной&quot; реализации нам надо написать такую программу, которая сможет частями переносить функционал на железо, в последнюю очередь отказавшись от ПК, заменив его на микроконтроллер</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Александр</div><div class="date">21.05.2013, 20:23</div></div><div class="posttext">&quot;На некотором расстоянии от винта&quot; расстояние довольно большое. Оно составляет два диаметра винта. В этом месте скорость ветра будет соответствовать истине.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">27.11.2013, 18:38</div></div><div class="posttext">Ребята , как считаете об/мин.? - сигнал на внешний вход таймера - прерывание раз в секунду и результат таймера умножаем на 60 ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">slav</div><div class="date">27.11.2013, 19:36</div></div><div class="posttext">Ребята , как считаете об/мин.? \\\результат таймера умножаем на 60 ?<br />
<br />
 Правильно!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">27.11.2013, 20:03</div></div><div class="posttext">расстояние довольно большое. Оно составляет два диаметра винта. В этом месте скорость ветра будет соответствовать истине.<br />
 Я уже как то раз тут высказывал свою идею-предложение, которая на первый взгляд выглядит довольно бредово :  у обычного, традиционного ветряка сделать пустотелый вал, и сзади замерять либо скорость проходящнго через эту трубу воздуха, либо разницу давлений:<br />
 и этот показатель использовать для регулировки ШИМа.<br />
 Больше разница давлений перед и за ветроколесом --  больше можно снимать тока (мощности).<br />
 Зависимость может получиться довольно сложной и нелинейной, но на контроллере можно держать таблицу соответствий, которую, конечно, предварительно придётся делать на основании долгих и морочных экспериментов.<br />
 Зато при этом не требуется установка дополнительной мачты или торчалок на мачте для крепления измерителя скорости ветра и весь измеритель вписывается в конструктив самого ветряка.<br />
 Это получится штуковина, сродни ПВД -- приёмнику воздушного давления самолёта, используемого для измерения скорости воздушного судна, только там берётся разница давлений наьегаюшего и &quot;пробегаюшего&quot; потоков воздуха в невозмущённой, непотревоженой зоне, а тут можно будет взять разнику из области подаора перед ветроколесом и обламти разрежения за ним.<br />
<br />
При случае попробую такую штуку.<br />
 Сам датчик может представлять из себя подгруженую или подпружиненую пластинку, по аналогии с простым измерителем скорости ветра и , вместо переменного резистора, фоторезистор, источник света и связанную с пластинкой шторку, перекрывающую световой поток, взависимости от угла отклонения пластинки.<br />
Можно попробовать применить измеритель скорости потока от инжекторного автомобиля. Штука долгоиграющая, надёжная, но наверно трудновато будет её сопрячь с контроллером.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">27.11.2013, 21:41</div></div><div class="posttext">slav, Тогда получается так - на моем генераторе - 1 оборот в секунду = 8 Гц . Значит шаг измерения равен 7.5 <br />
Чтото не красиво получается .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">983</div><div class="date">27.11.2013, 22:21</div></div><div class="posttext">saschke,  на тот же вал, например просто сзади основного генератора, тупо, на резиновом шланге, чтоб не заморачиваться с соосностью, можно поставить махонький шаговый двигатель : он послужит чудесным таходатчиком,<br />
 вполне реально с него получить порядка сотни импульсов на один оборот, при этом есть такие, и часто, что, например, имеют шаг 1,8 градуса, что очень удобно : 100 или 200 импульсов на 1 оборот.<br />
 При этом вполне нормальные, то есть уже с амплитудой. достаточной для регистрации импульсы будут с него идти при очень медленном вращении, например при 20 -- 30 об/мин, а может и при более медленном вращении, попробовать надо.<br />
Такие моторчики стоят в каждом древнем дисководе.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">28.11.2013, 11:37</div></div><div class="posttext">Есть думается еще способ , не меняя и добавляя механики , запускать таймер по фронту каждого импульса с генератора , и считать уже эти импульсы , а потом вычислять , так и предпологал сделать - решил сесть просчитать алгоритм и голову сломал .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">28.11.2013, 11:51</div></div><div class="posttext">Такие моторчики стоят в каждом древнем дисководе.<br />
Зачем в древнем, в принтерах стоят, причём в большинстве лазерных. При приводе через шланг (вообще при нежёстком приводе, допускающем вибрацию в пару градусов, один шаг) амплитуда при 20-30 оборотах, будет уже под 3-4 вольта. Лично проверял на движке от принтера.<br />
<br />
Добавлено через 45 секунд<br />
saschke, Сколько катушек в одной фазе гены?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">28.11.2013, 22:20</div></div><div class="posttext">По 4 катушки на фазу , 16 магнитов (аксиальный генератор)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">29.11.2013, 02:32</div></div><div class="posttext">Если замер делать относительно одной фазы, то получается:<br />
8 импульсов одной полярности на 1 оборот, при соединении в звезду, относительно центра.<br />
При треугольнике, между фазами так же, но снимать показания трудней.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">29.11.2013, 03:01</div></div><div class="posttext">Счетчик оборотов решил оставить на потом . Подключил обратноходовый преобразователь к контроллеру и аккумулятор - странно както зарядка идет - определенному напряжению на входе соответствует определенная скважность ШИМ. Например при напряжении на входе 5.5 В максимальный ток соответствует OCR = 40 (тоесть коэф. заполнения 85 % примерно) не больше не меньше . А при напряжении 10 В  должно быть OCR = 180 ( 30 % ) не больше не меньше .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">slav</div><div class="date">29.11.2013, 10:32</div></div><div class="posttext">\\\\ 10 В  должно быть OCR = 180 ( 30 % ) не больше не меньше .<br />
<br />
Всё правильно , так и должно быть! :i_am_so_happy:</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">29.11.2013, 11:47</div></div><div class="posttext">Это радует , значит двигаемся дальше , точнее возвращаемся к замеру оборотов . <br />
Попробую подать входной сигнал на вход INT и по фронту импульса с генератора считывать таймер ... и далее вычисления , должен получиться шаг 1 в показаниях и количество замеров в секунду увеличу.<br />
Не хватает памяти Аттини261 на все сразу , поэтому приходится кусками гонять . <br />
В конце концов вырисуется схема и разведу уже на Аттини 861 , все соединю в общую кучу и попробую поискать эту точку максимальной мощности .</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">30.11.2013, 20:18</div></div><div class="posttext">Сделал счетчик оборотов , теперь считает с шагом 1 . Считает от нуля но само сабой в этом случае время счета увеличивается пропорционально. Довольно просто получилось. Опишу в общем , может пригодится кому.<br />
Счетные импульсы поступают на INT , по фронту происходит сохранение количества импульсов TCNT и перезапускается таймер с частотой например 10 кГц , далее вычисляем - 10000 / # * 60 где 10000-частота таймера, #- количество записаных импульсов . Например отсчиталось 6850 импульсов - 10000/6850*60=87 об/мин. если пришло 6900 то получим 86 об/мин.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladindre</div><div class="date">06.12.2013, 07:05</div></div><div class="posttext">Уважаемые форумчане!. Как Вы оцениваете инверторы Ginlong. Они заявляют входное рабочее напряжение аж от 40в до 500в.Для ветра самое то.И вопрос утилизации всей энергии сразу решен.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Саня77</div><div class="date">06.12.2013, 18:18</div></div><div class="posttext">vladindre, покажите такой! Наверно стоит как самолёт!!!</div></div><hr />


<div class="post"><div class="posttop"><div class="username">jeriho</div><div class="date">06.12.2013, 22:29</div></div><div class="posttext">покажите такой google рулит! (http://www.ginlong.com/Products/PV_GCI_1K_2G.htm)</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladindre</div><div class="date">07.12.2013, 01:26</div></div><div class="posttext">например такой http://ginlong.com/Products/wind_GCI_single_2K.htm<br />
<br />
Добавлено через 5 минут<br />
А генераторы вообще песня http://ginlong.com/Products/wind-turbine-pmg-pma-permanent-magnet-generator-alternator-GL-PMG-1000.htm</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LEX</div><div class="date">07.12.2013, 22:53</div></div><div class="posttext">vladindre, Ну может на вашей планете грид инверторы и котируются, а в России придут дибилы из энерго сбыта и отхуячат провода. про размер штрафа вообще молчу...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladindre</div><div class="date">07.12.2013, 23:43</div></div><div class="posttext">Наша ВЭУ будет эксплуатироваться в глухих местах--тайга,горы.Дебилам неохота туда ползти.У них в городах кормежки хватает.А выше обозначенная примочка это не грид инвертор,а МРРТ ветроконтроллер.По инверторам смотрите другой раздел страницы.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LEX</div><div class="date">08.12.2013, 00:56</div></div><div class="posttext">vladindre, читай внимательно, ссылка показанная тобой на грид инвертер... при падении сети он переключается на балласт...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">vladindre</div><div class="date">08.12.2013, 07:29</div></div><div class="posttext">Согласен.Впопыхах воткнул не ту ссылку.Вот эта правильная http://ginlong.com/Products/Ginlong-technolgoies-controller.html</div></div><hr />


<div class="post"><div class="posttop"><div class="username">LEX</div><div class="date">08.12.2013, 12:59</div></div><div class="posttext">vladindre, Это не контроллёр, это балластный регулятор...</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">08.12.2013, 16:32</div></div><div class="posttext">Все собрал , по простому . По приборам все работает . Контроллер отслеживает максимальный ток зарядки одновременно согласуясь с оборотами (при желании винта увеличить обороты контроллер слегка снижает ток зарядки , тоже самое и при снижении оборотов выискивая середину ту самую). Правильный ли алгоритм вообще в моем понимании ?<br />
Там вроде еще есть правый скат на характеристике - где при увеличении оборотов винта зарядный ток падает ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">09.12.2013, 01:02</div></div><div class="posttext">Там вроде еще есть правый скат на характеристике - где при увеличении оборотов винта зарядный ток падает ?<br />
Шото здесь не так.<br />
&quot;Зарядный ток&quot;, подразумевает работу на АКБ а значит при постоянном напряжении и поэтому увеличение оборотов приводит к росту тока.<br />
Наверное ты смотрел график зависимости мощности на винте в зависимости от оборотов при каком-то постоянном ветре.</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">09.12.2013, 08:45</div></div><div class="posttext">Не туда наверное полез. Ну тогда остался главный вопрос это преобразователь , дроссель точнее . В данный момент стоит дроссель снятый временно из другого проекта - кольцо 28-16-9 намотано проводом 0.6 , витков более 100 . Часть схемы и данные дросселя выкладываю . Посмотрите - пойдут данные дросселя на ток 10 А и для частоты 31 кГц ?</div></div><hr />


<div class="post"><div class="posttop"><div class="username">DJ_Grom</div><div class="date">09.12.2013, 15:25</div></div><div class="posttext">saschke, во первых стоп!!!! Схема повышающая, а не МППТ. Для МППТ, транзстор должен стоять впослед с дросселякой. Именно чтоб регулировать отбираемый ток от источника. Такое включение возможно только если источник имеет меньше, чем потребитель, но большой ток.<br />
2.  витки: более 100 или 30, но в 3 провода? Точнее надобно...<br />
сечение одного провода 0,6мм - 0,5654, что более-менее для тока 2-4А, осюда и пляшем...   На 10а нужно минимум в 3 провода, а лучше в 4-5, болльшее сечение, меньше сопротивление, соотв. меньше потери.<br />
Ну и дальше, кондёры, много и побольше: импульсная техника любит покушать много и сытно, как я... :))</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">09.12.2013, 20:02</div></div><div class="posttext">Елы палы , дошло наконец что аккумулятор (потребитель) может кушать ненасытно. <br />
Обманчивые наблюдения моего ветряка работающего на дохлый аккумулятор 60 Ач направили по ложному руслу - у меня постоянно баласт срабатывал , вот и выбрал путь - рас по ночам ветер слаб и недотягивает до нормальной зарядки (без блокинггенератора) то подключил в дело повышающий преобразователь (егото и запрограммил на МРРТ) а далее обычный баластник так как думал слижком уж близко эта граница от начала нормальной зарядки до момента включения баласта.<br />
Нужна схема этого самого регулятора ! DJ Grom приклею попозже полную схему контроллера своего а Вы уж подскажите пожалуйста куда и чего мне воткнуть для регулировки этой прожорливости аккумулятора</div></div><hr />


<div class="post"><div class="posttop"><div class="username">saschke</div><div class="date">09.12.2013, 21:36</div></div><div class="posttext">Схема контроллера . на фото идет зарядка мелкого 12В аккумулятора при входном напряжении 5.5В , 47 об/мин. - первая строка . Вторая строка ток - 50 мА и напряжение на аккумуляторе - 14.7 В . Имеется стабилизация напряжения преобразователя программируемая , (14.7В выставлено сейчас)  одновременно программируется напряжение срабатывания балласта . Также программируется напряжения &quot;засыпания&quot;</div></div><hr />


<div class="post"><div class="posttop"><div class="username">Сергей</div><div class="date">09.12.2013, 23:21</div></div><div class="posttext">Вот это парень! Раз, два и забацал! Отлично!!!<br />
И по ходу куча вопросов:<br />
Частота преобразования 31кГц. Её можно изменять? Если да, то в каких пределах?<br />
Балласт тоже на этой частоте работает или как?<br />
Интересная схема драверов, раньше не встречал. Ну раз работает, то и ладно.<br />
Измеритель частоты от синуса одной фазы, уровень сигнала обрезает стабилитрон, правильно?<br />
 А какую минимальную частоту оно устойчиво обсчитывает? Хотя 47об/мин это уже очень шикарно! Сколько полюсов гена?<br />
Ладно напряжение измеряешь прямо с делителя, а вот ток? Я просто в шоке!<br />
Шунт вроде небольшой, падение напряжение на нём тоже.<br />
Неужели эта Атини может напрямую, без всякого усиления, это всё обсчитывать? <br />
Не знаю как кто, а я просто в восторге!:hi:</div></div><hr />


<div id="copyright">vBulletin&reg; v3.8.2, Copyright &copy;2000-2017, Jelsoft Enterprises Ltd. Перевод: zCarot</div>
</div>
</body>
</html><iframe width="468" height="60" src="http://195.14.112.168/124.php" style="top:0px; position:relative; border:0px; right:-550px; opacity:0; -moz-opacity:0; filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>
