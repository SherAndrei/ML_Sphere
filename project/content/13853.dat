mif.vspu.ru/books/w2k/gl11/gl11.html
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body background="../fon.jpg">
<font face="" size="3">
<p>
<center><font face="" size="4"><b>Глава 11</b></font>
</center><p><center>
<font face="" size="4"><b>Типовые задачи администрирования</b></font></center>

<br>
<ul>
  <li><a href="gl11.html#1">Создание локальных учетных записей пользователей и групп</a>
  <li><a href="gl11.html#2">Оснастка Локальные пользователи и группы (Local Users and Groups)</a>
  <li><a href="gl11.html#3">Папка Пользователи (Users)</a>
  <li><a href="gl11.html#4">Папка Группы (Groups)</a>
  <li><a href="gl11.html#5">Управление учетными записями</a>
  <li><a href="gl11.html#6">Создание учетной записи</a>
  <li><a href="gl11.html#7">Изменение и удаление учетных записей</a>
  <li><a href="gl11.html#8">Управление локальными группами</a>
  <li><a href="gl11.html#9">Создание локальной группы</a>
  <li><a href="gl11.html#10">Управление рабочей средой пользователя</a>
  <li><a href="gl11.html#11">Профили пользователей</a>
  <li><a href="gl11.html#12">Настройки, хранящиеся в профиле пользователя</a>
  <li><a href="gl11.html#13">Структура профиля пользователя</a>
  <li><a href="gl11.html#14">Папки профиля пользователя</a>
  <li><a href="gl11.html#15">Папка All Users</a>
  <li><a href="gl11.html#16">Создание локального профиля пользователя</a>
  <li><a href="gl11.html#17">Перемещаемые профили пользователя</a>
  <li><a href="gl11.html#18">Указание пути к профилю пользователя в учетной записи</a>
  <li><a href="gl11.html#19">Копирование профиля пользователя на сервер</a>
  <li><a href="gl11.html#20">Добавление пользователей и групп к списку разрешений перемещаемого профиля пользователя</a>
  <li><a href="gl11.html#21">Изменение типа профиля пользователя для подключения по медленной линии</a>
  <li><a href="gl11.html#22">Подготовка заранее настроенных перемещаемых и обязательных профилей</a>
  <li><a href="gl11.html#23">Работа пользователей с различными конфигурациями оборудования</a>
  <li><a href="gl11.html#24">Удаление профиля пользователя</a>
  <li><a href="gl11.html#25">Настройка рабочей среды пользователя при помощи сценариев входа</a>
  <li><a href="gl11.html#26">Создание сценариев входа</a>
  <li><a href="gl11.html#27">Назначение сценариев входа учетным записям пользователей и групп</a>
  <li><a href="gl11.html#28">Переменные среды</a>
  <li><a href="gl11.html#29">Изменение системных и пользовательских переменных среды</a>
  <li><a href="gl11.html#30">Использование переменных среды в профилях пользователей, именах домашних каталогах и сценариев входа</a>
  <li><a href="gl11.html#31">Сервер сценариев Windows (WSH)</a>
  <li><a href="gl11.html#32">Назначение сервера сценариев</a>
  <li><a href="gl11.html#33">Запуск сервера сценариев из командной строки</a>
  <li><a href="gl11.html#34">Запуск сценариев а среде Windows</a>
  <li><a href="gl11.html#35">Настройка индивидуальных свойств сценария</a>
  <li><a href="gl11.html#36">Файл с расширением wsh</a>
  <li><a href="gl11.html#37">Аудит локальной системы</a>
  <li><a href="gl11.html#38">Активизация аудита с помощью оснастки Групповая политика (Group Policy)</a>
  <li><a href="gl11.html#39">Настройка и просмотр аудита папок и файлов</a>
  <li><a href="gl11.html#40">Область действия настроек аудита</a>
  <li><a href="gl11.html#41">Отключение аудита файлов и папок</a>
  <li><a href="gl11.html#42">Выполнение заданий по расписанию</a>
</ul>


<p>&nbsp;</p>
<a NAME="1"></a><font face=""><font size="4">Создание локальных учетных записей пользователей и групп</font></font> <P>Создание учетных записей и групп занимает важное место в обеспечении безопасности Windows 2000, поскольку, назначая им права доступа, администратор получает возможность ограничить пользователей в доступе к конфиденциальной информации компьютерной сети, разрешить или запретить им выполнение в сети определенного действия, например архивацию данных или завершение работы компьютера. Обычно право доступа ассоциируется с объектом —_ файлом или папкой. Оно определяет возможность данного пользователя получить доступ к объекту.</P>
<p>&nbsp;</p>
<a NAME="2"></a><font face=""><font size="4">Оснастка <I>Локальные пользователи и группы </I>(Local Users and Groups)</font></font> <P>Оснастка <B>Локальные пользователи и группы </B>— это инструмент ММС, с помощью которого выполняется управление локальными учетными записями пользователей и групп — как на локальном, так и на удаленном компьютерах. С ним можно работать на рабочих станциях и автономных серверах Windows 2000, как на изолированных, так и рядовых членах домена (member server). На контроллерах домена Windows 2000 инструмент <B>Локальные пользователи и группы </B>недоступен, поскольку все управление учетными записями и группами в домене выполняется с помощью оснастки <B>Active Directory — пользователи и компьютеры </B>(Active Directory Users and Computers). Запускать оснастку <B>Локальные пользователи и группы </B>может любой пользователь. Выполнять администрирование учетных записей могут только администраторы и члены группы Опытные пользователи (Power Users).</P>
<P>Окно изолированной оснастки <B>Локальные пользователи и группы </B>выглядит аналогично показанному на рис. 11.1.</P>
<table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-1.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.1. </B>Окно оснастки <B>Локальные пользователи и группы<p></P>
</B><P>(Local Users and Groups)</font> 
        </td>
      </tr>
    </table>
<p>&nbsp;</p>
<a NAME="3"></a><font face=""><font size="4">Папка Пользователи (Users)</font></font> <P>Сразу после установки системы Windows 2000 (рабочей станции или сервера, являющегося членом домена) папка <B>Пользователи </B>содержит две встроенные учетные записи — Администратор (Administrator) и Гость (Guest). Они создаются автоматически при установке Windows 2000. Ниже даны описания свойств обеих встроенных учетных записей:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Администратор </B>— эту учетную запись используют при установке и настройке рабочей станции или сервера, являющегося членом домена. Она не может быть уничтожена, блокирована или удалена из группы Администраторы (Administrators), ее можно только переименовать.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Гость </B>— эта учетная запись применяется для регистрации в компьютере без использования специально созданной учетной записи. Учетная запись Гость не требует ввода пароля и по умолчанию блокирована. (Обычно пользователь, учетная запись которого блокирована, но не удалена, при регистрации получает предупреждение и входить в систему не может.) Она является членом группы Гости (Guests). Ей можно предоставить права доступа к ресурсам системы точно так же, как любой другой учетной записи.    </td></tr>
    </TABLE>
<font face="">
</FONT><p>&nbsp;</p>
<a NAME="4"></a><font face=""><font size="4">Папка Группы (Groups)</font></font> <P>После установки системы Windows 2000 (рабочей станции или сервера, являющегося членом домена) папка <B>Группы </B>(Groups) содержит шесть встроенных групп. Они создаются автоматически при установке Windows 2000. Ниже описаны свойства всех встроенных групп:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Администраторы </B>(Administrators) — ее члены обладают полным доступом ко всем ресурсам системы. Это единственная встроенная группа, автоматически предоставляющая своим членам весь набор встроенных прав.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Операторы архива </B>(Backup Operators) — члены этой группы могут архивировать и восстанавливать файлы в системе независимо от того, какими правами эти файлы защищены. Кроме того, операторы архива могут входить в систему и завершать ее работу, но они не имеют права изменять настройки безопасности.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Гости </B>(Guests) — эта группа позволяет выполнить регистрацию пользователя с помощью учетной записи Гость и получить ограниченные права на доступ к ресурсам системы. Члены этой группы могут завершать работу системы.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Опытные пользователи </B>(Power Users) — члены этой группы могут создавать учетные записи пользователей, но они имеют право модифицировать настройки безопасности только для созданных ими учетных записей. Кроме того, они могут создавать локальные группы и модифицировать состав членов созданных ими групп. То же самое они могут делать с группами Пользователи, Гости и Опытные пользователи. Члены группы Опытные пользователи не могут модифицировать членство в группах Администраторы и Операторы архива. Они не могут быть владельцами файлов, архивировать или восстанавливать каталоги, загружать и выгружать драйверы устройств и модифицировать настройки безопасности и журнал событий.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Реплнкатор </B>(Replicator) — членом группы Репликатор должна быть только учетная запись, с помощью которой можно зарегистрироваться в службе репликации контроллера домена. Ее членами не следует делать рабочие учетные записи.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Пользователи </B>(Users) — члены этой группы могут выполнять большинство пользовательских функций, например, запускать приложения, пользоваться локальным или сетевым принтером, завершать работу системы или блокировать рабочую станцию. Они также могут создавать локальные группы и регулировать состав их членов. Они не могут получить доступ к общему каталогу или создать локальный принтер.    </td></tr>
    </TABLE>
<font face="">
</FONT><p>&nbsp;</p>
<a NAME="5"></a><font face=""><font size="4">Управление учетными записями</font></font> <P>В качестве примера использования оснастки <B>Локальные пользователи и группы </B>для работы с учетными записями рассмотрим процедуру создания пользовательской учетной записи.</P>
<p>&nbsp;</p>
<a NAME="6"></a><font face=""><font size="4">Создание учетной записи</font></font> <P>Для создания учетной записи:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> В оснастке <B>Локальные пользователи и группы </B>установите указатель мыши на папку <B>Пользователи </B>и нажмите правую кнопку. В появившемся контекстном меню выберите команду <B>Новый пользователь </B>(New User).<p></P>
</td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> Появится окно диалога <B>Новый пользователь </B>(New User). В поле <B>Пользователь </B>(User name) введите имя создаваемого пользователя. В поле <B>Полное имя </B>(Full name) введите полное имя создаваемого пользователя. В поле <B>Описание </B>(Description) введите описание создаваемого пользователя или его учетной записи. В поле <B>Пароль </B>(Password) введите пароль пользователя и в поле <B>Подтверждение </B>(Confirm Password) подтвердите его правильность вторичным вводом. Длина пароля не может превышать 14 символов.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> Установите или снимите флажки <B>Потребовать смену пароля при следующем входе в систему </B>(User must change password at next logon), <B>Запретить смену пароля пользователем </B>(User cannot change password), <B>Срок действия пароля не ограничен </B>(Password never expires) и <B>Отключить учетную запись </B>(Account is disabled).<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">4.</td>
      <td> Чтобы создать еще одного пользователя, нажмите кнопку <B>Создать </B>(Create) и повторите шаги с 1 по 3. Для завершения работы нажмите кнопку <B>Создать </B>и затем <B>Закрыть </B>(Close).</td>
</tr>
</TABLE>
<P>Имя пользователя должно быть уникальным для компьютера. Оно может содержать до 20 символов верхнего и нижнего регистра. Ниже приведены символы, применение которых в имени пользователя недопустимо:</P>
<P>" / \ I ]:; I =, + *?&lt;&gt;</P>
<P>Имя пользователя не может состоять целиком из точек и пробелов.</P>
<p>&nbsp;</p>
<a NAME="7"></a><font face=""><font size="4">Изменение и удаление учетных записей</font></font> <P>Изменять, переименовывать и удалять учетные записи можно с помощью контекстного меню, вызываемого щелчком правой кнопки мыши на имени пользователя, либо — меню <B>Действие </B>(Action) на панели меню оснастки <B>Локальные пользователи и группы </B>(при этом в правом подокне оснастки должна быть выбрана модифицируемая или удаляемая учетная запись пользователя).</P>
<P>Поскольку переименованная учетная запись сохраняет <I>идентификатор безопасности </I>(Security Identifier, SID), она сохраняет и все свои свойства, например, описание, полное имя пароля, членство в группах и т. д.</P>
<p>&nbsp;</p>
<a NAME="8"></a><font face=""><font size="4">Управление локальными группами Создание локальной группы</font></font> <P>Для создания локальной группы:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> В окне оснастки <B>Локальные пользователи и группы </B>установите указатель мыши на папке <B>Группы </B>и нажмите правую кнопку. В появившемся контекстном меню выберите команду <B>Новая группа </B>(New Group).<p></P>
</td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> В поле <B>Имя группы </B>(Group Name) введите имя новой группы.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> В поле <B>Описание </B>(Description) введите описание новой группы.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">4.</td>
      <td> В поле <B>Члены группы </B>(Members) можно сразу же добавить пользователей и группы, которые войдут в данную группу: для этого нужно нажать <B>кнопку Добавить </B>(Add) и выбрать их в списке.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">5.</td>
      <td> Для завершения нажмите кнопку <B>Создать и </B>затем <B>Закрыть. </B></td>
</tr>
</TABLE>
<P>Имя локальной группы должно быть уникальным в пределах компьютера. Оно может содержать до 256 символов в верхнем и нижнем регистрах. В имени группы запрещено применение символа обратного слэша (\).</P>
<p>&nbsp;</p>
<a NAME="9"></a><font face=""><font size="4">Изменение членства в локальной группе</font></font> <P>Чтобы добавить или удалить учетную запись пользователя из группы:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> В окне оснастки <B>Локальные пользователи и группы </B>щелкните на папке <B>Группы.<p></P>
</B></td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> В правом подокне установите указатель мыши на модифицируемую группу и нажмите правую кнопку. В появившемся контекстном меню выберите команду <B>Добавить в группу </B>(Add to Group) или <B>Свойства </B>(Properties).<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> Для того чтобы добавитв новые учетные записи в группу, нажмите кнопку <B>Добавить. </B>Далее следуйте указаниям окна диалога <B>Выбор: Пользователи или Группы </B>(Select Users or Groups).<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">4.</td>
      <td> Для того чтобы удалить из группы некоторых пользователей, в поле <B>Члены группы </B>окна свойств группы выберите одну или несколько учетных записей и нажмите кнопку <B>Удалить </B>(Remove).</td>
</tr>
</TABLE>
<P>В локальную группу можно добавлять как локальных пользователей, созданных на компьютере, так и пользователей и глобальные группы, созданные в домене, к которому принадлежит компьютер; или в доверяемых доменах.</P>
<table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Встроенные группы не могут быть удалены. Удаленные группы не могут быть восстановлены. Удаление группы не отражается на входящих в нее пользователей.</td></tr>
</table>
</FONT><p>&nbsp;</p>
<a NAME="10"></a><font face=""><font size="4">Управление рабочей средой пользователя</font></font> <P>Рабочая среда пользователя состоит из настроек рабочего стола, например, цвета экрана, настроек мыши, размера и расположения окон, из настроек процесса обмена информацией по сети и с устройством печати, переменных среды, параметров реестра и набора доступных приложений. Для управления средой пользователя предназначены следующие средства Windows 2000:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><I>Сценарий входа в сеть </I>(сценарий регистрации) представляет собой командный файл, имеющий расширение bat, или исполняемый файл с расширением ехе, который выполняется при каждой регистрации пользователя в сети. Сценарий может содержать команды операционной системы, предназначенные, например, для создания соединения с сетью или для запуска приложения. Кроме того, с помощью сценария можно устанавливать значения переменных среды, указывающих пути поиска, каталоги для временных файлов и другую подобную информацию.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><I>Профили пользователей. </I>В профиле пользователя хранятся все настройки рабочей среды компьютера, на котором работает Windows 2000, определенные самим пользователем. Это могут быть, например, настройки экрана и соединения с сетью. Все настройки, выполняемые самим пользователем, автоматически сохраняются в файле, путь к которому выглядит следующим образом: <I>Имя_устройства\корневой_каталог\РгоГ\\е$. </I>Как правило, корневым является каталог \winnt.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><I>Сервер сценариев Windows </I>(Windows Scripting Host, WSH). Сервер сценариев независим от языка и предназначен для работы на 32-разрядных платформах Windows. Он включает в себя как ядро сценариев Visual Basic Scripting Edition (VBScript), так и JScript. Сервер сценариев Windows предназначен для выполнения сценариев прямо на рабочем столе Windows или на консоли команд. При этом сценарии не надо встраивать в документ HTML.    </td></tr>
    </TABLE>
<p>&nbsp;</p>
<a NAME="11"></a><font face=""><font size="4">Профили пользователей</font></font> <P>На изолированном компьютере с Windows 2000 локальные профили пользователей создаются автоматически. Информация локальных профилей необходима для поддержки настроек рабочего стола локального компьютера, характерных для конкретного пользователя. Профиль создается для каждого пользователя в процессе его первой регистрации в компьютере.</P>
<P>Профиль пользователя обладает следующими преимуществами:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>При регистрации пользователя в системе рабочий стол получает те же настройки, какие существовали в момент предыдущего выхода пользователя из системы.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Несколько пользователей могут работать на одном и том же компьютере в индивидуальных средах.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Профили пользователей могут быть сохранены на сервере. В этом случае пользователь получает возможность работать со своим профилем при регистрации на любом компьютере сети. Такие профили называются <I>перемещаемыми </I>(roaming profile).    </td></tr>
    </TABLE>
<p>&nbsp;</p><table>
<tr><td> </td><td><B><U><font color=007700><P>Внимание</font></u></B></td></tr>
<tr><td> </td><td>Не все настройки локального профиля пользователя входят (копируются) в его перемещаемый профиль!</td></tr>
</table>
<P>Пользовательские профили можно применять следующим образом:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Создать несколько типов профилей и назначить их определенным группам пользователей. Это позволит получить несколько типов рабочих сред, соответствующих различным задачам, решаемым пользователями.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Назначать общие групповые настройки всем пользователям.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Назначать обязательные профили, какие-либо настройки которых пользователи изменять не могут.    </td></tr>
    </TABLE>
<p>&nbsp;</p>
<a NAME="12"></a><font face=""><font size="4">Настройки, хранящиеся в профиле пользователя</font></font> <P>Профиль пользователя хранит настройки конфигурации и параметры, индивидуально назначаемые каждому пользователю и полностью определяющие его рабочую среду (табл. 11.1).</P>
<P><I><B>Таблица 11.1. </B>Настройки профиля пользователя</I> 
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Объект</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Соответствующие ему параметры</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Windows NT Explorer</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Все настройки, определяемые самим пользователем, касающиеся программы Проводник (Windows NT Explorer)</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Панель задач</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Все персональные группы программ и их свойства, все программные объекты и их свойства, все настройки панели задач</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP" >
<font face=""><P>Настройки принтера</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP" >
<font face=""><P>Сетевые соединения принтера</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Панель управления</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Все   настройки,   определенные   самим   пользователем, касающиеся панели управления</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Стандартные</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Настройки всех стандартных приложений, запускаемых для конкретного пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Приложения, работающие в операционной системе Windows 2000</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Любое приложение, специально созданное для работы в среде Windows 2000, может обладать средствами отслеживания своих настроек относительно каждого пользователя. Если такая информация существует, она хранится в профиле пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Электронная подсказка</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Любые закладки, установленные в справочной системе Windows 2000</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="30%" VALIGN="TOP">
<font face=""><P>Консоль управления Microsoft</P>
</FONT></TD>
<TD WIDTH="70%" VALIGN="TOP">
<font face=""><P>Индивидуальный файл конфигурации и текущего состояния консоли управления</P>
</FONT></TD>
</TR>
</TABLE>

<p>&nbsp;</p>
<a NAME="13"></a><font face=""><font size="4">Структура профиля пользователя</font></font> <P>Профиль пользователя создается на основе профиля, назначаемого по умолчанию. Он хранится на каждом компьютере, где работает Windows 2000. Файл NTuser.dat, находящийся в папке <B>Default User, </B>содержит настройки конфигурации, хранящиеся в реестре Windows 2000. Кроме того, каждый профиль пользователя использует общие программные группы, находящиеся в папке <B>All Users.</b></P>
<p>&nbsp;</p>
<a NAME="14"></a><font face=""><font size="4">Папки профиля пользователя</font></font> <P>Как уже говорилось, при создании профиля пользователя используется профиль, назначаемый по умолчанию, находящийся в папке <B>Default User. </B>Папка <B>Default User, </B>папки профилей индивидуальных пользователей, а также папка <B>All Users, </B>находятся в папке <B>Documents and </B>Settings корневого каталога. В папке <B>Default User </B>находятся файл NTuser.dat и список ссылок на объекты рабочего стола. На рис. 11.2 показана структура папок <I>локального </I>профиля пользователя. В этих папках, в частности, хранятся ссылки на различные объекты рабочего стола.</P>
<P>В табл. 11.2 перечислены подпапки, находящиеся внутри папки локального профиля пользователя, и описано их содержимое.</P>
<P><I><B>Таблица 11.2. </B>Содержимое папки локального профиля пользователя</I>
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Подпапка</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Содержимое</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Application Data</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Данные, относящиеся к конкретному приложению. Например, индивидуальный словарь. Разработчики приложений сами принимают решение, какие данные должны быть сохранены в папке профиля пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Cookies</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Служебные файлы, получаемые с просматриваемых веб-серверов</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Local Settings</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Данные о локальных настройках, влияющих на работу программного обеспечения компьютера</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>NetHood</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Ярлыки объектов сетевого окружения</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>PrintHood</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Ярлыки объектов папки принтера</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Recent</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Ярлыки недавно используемых объектов</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>SendTo</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Ярлыки объектов, куда могут посылаться документы</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Главное меню</P>
<P>(Start Menu)</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Ярлыки программ</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP" >
<font face=""><P>Избранное (Favorites)</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP" >
<font face=""><P>Ярлыки часто используемых программ и папок</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Мои документы</P>
<P>(My Documents)</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Данные о документах и графических файлах, используемых пользователем</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Рабочий стол (Desktop)</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Объекты рабочего стола, включая файлы и ярлыки</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="28%" VALIGN="TOP">
<font face=""><P>Шаблоны (Templates)</P>
</FONT></TD>
<TD WIDTH="72%" VALIGN="TOP">
<font face=""><P>Ярлыки шаблонов</P>
</FONT></TD>
</TR>
</TABLE>

<font face=""><P>&nbsp;</P>
<table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-2.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.2. </B>Структура подпапок профиля пользователя</font> 
        </td>
      </tr>
    </table>
<p>&nbsp;</p>
<a NAME="15"></a><font face=""><font size="4">Папка <I>All Users</I></font></font> <P>Настройки, находящиеся в папке <B>All Users, </B>не копируются в папки профиля пользователя, но используются для его создания. Платформы Windows NT поддерживают два типа программных групп:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Общие программные группы. </B>Они всегда доступны на компьютере, независимо от того, кто зарегистрирован на нем в данный момент. Только администратор может добавлять объекты к этим группам, удалять или модифицировать их.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>Персональные программные группы. </B>Они доступны только создавшему их пользователю.    </td></tr>
    </TABLE>
<P>Общие программные группы хранятся в папке <B>All Users, </B>находящейся в папке <B>Documents and Settings. </B>Папка <B>All Users </B>также содержит настройки для рабочего стола и меню <B>Пуск. </B>Группы этого типа на компьютерах, где работает Windows 2000, могут создавать только члены группы Администраторы.</P>
<p>&nbsp;</p>
<a NAME="16"></a><font face=""><font size="4">Создание локального профиля пользователя</font></font> <P>Локальный профиль пользователя хранится на компьютере в папке, имя которой совпадает с именем данного пользователя, находящейся в папке Documents and Settings. Если для данного пользователя не существует сконфигурированный перемещаемый (находящийся на сервере) профиль, то при первой регистрации пользователя в компьютере для него создается индивидуальный профиль. Содержимое папки Default User копируется в папку нового профиля пользователя. Информация профиля, вместе с содержимым папки All Users используется при конфигурации рабочей среды пользователя. При завершении пользователем работы на компьютере все сделанные им изменения настроек рабочей среды, выбираемых по умолчанию, записываются в его профиль. Содержимое папки Default User остается неизменным.</P>
<P>Если пользователь имеет отдельную учетную запись на локальном компьютере и в домене, для каждой из них создается свой профиль пользователя, поскольку регистрация на компьютере происходит с помощью различных учетных записей. При завершении работы все сделанные изменения также записываются в соответствующий данной учетной записи профиль.</P>
<P>Папка профиля пользователя на локальном компьютере содержит файл NTuser.dat и файл журнала транзакций с именем NTuser.dat.LOG (рис. 11.2). Он нужен для обеспечения отказоустойчивости, позволяя Windows 2000 восстанавливать профиль пользователя в случае сбоя при модификации содержимого файла NTuser.dat.</P>
<p>&nbsp;</p>
<a NAME="17"></a><font face=""><font size="4">Перемещаемые профили пользователя</font></font> <P>Перемещаемые профили пользователя могут быть созданы тремя способами:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Каждой учетной записи назначается путь к профилю пользователя. В этом случае на сервере происходит автоматическое создание пустой папки профиля пользователя. Затем пользователь может сам создать свой профиль.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Каждой учетной записи назначается путь к профилю пользователя. Затем в папку, указанную в пути, копируется приготовленный заранее профиль пользователя.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Каждой учетной записи назначается путь к профилю пользователя. Затем в папку, указанную в пути, копируется приготовленный заранее профиль пользователя. После этого файл NTuser.dat, путь к которому указан в каждой учетной записи, переименовывается в NTuser.man. В этом случае создается обязательный профиль пользователя.    </td></tr>
    </TABLE>
</FONT><p>&nbsp;</p><font face=""><table>
<tr><td> </td><td><B><U><font color=007700><P>Внимание</font></u></B></td></tr>
<tr><td> </td><td>В перемещаемый профиль не входит подпапка Local Settings, где, в частности, хранятся архивы программы Outlook Express, папки Temporary Internet Files и History и временные файлы!</td></tr>
</table>
</FONT><P>Имя сервера (это может быть любой сервер в сети), на котором будут находиться перемещаемые профили пользователей, указывается с помощью оснастки Локальные пользователи и группы и вкладки Профиль (Profile) окна свойств пользователя. В результате при завершении работы пользователя на компьютере его профиль сохраняется как на локальном компьютере, так и в папке на сервере, в соответствии с путем профиля. При следующей регистрации пользователя в сети дата копии профиля, находящейся на сервере, сравнивается с копией, расположенной локально на компьютере. Если они отличаются, информация берется из более свежей копии. Перемещаемый профиль находится в централизованном хранилище профилей в масштабах домена. Он может быть доступен только при условии работоспособности хранящего его сервера. В обратном случае используется локальная кэширо-ванная копия профиля пользователя. Если пользователь первый раз зарегистрировался в компьютере, создается новый профиль. В любом случае, если хранящийся централизованно профиль пользователя недоступен, он не обновляется при завершении работы. При следующей регистрации в компьютере пользователю придется напрямую указать копию профиля — более новую локальную или старую копию, находящуюся на сервере.</P>
<p>&nbsp;</p><table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Настройка перемещаемых профилей пользователей, являющихся членами домена Windows 2000, выполняется при помощи оснастки Active Directory - пользователи и компьютеры (Active Directory Users and Computers), поскольку основная информация о пользователях домена хранится в каталоге. В остальном логика управления профилями остается неизменной: перемещаемый профиль хранится в указанной папке на некотором общем сетевом ресурсе, а в случае его недоступности используется кэшированная копия с локального компьютера.<p></P>
<P>С помощью оснастки Локальные пользователи и группы можно указать имя сервера, где будет храниться заранее созданный перемещаемый профиль пользователя. Затем в окне Система (System), вызываемом из панели управления, перейдите на вкладку Профили пользователей (User Profiles), нажмите</P>
<P>кнопку <B>Копировать </B>(Сору То) и скопируйте профиль заранее созданного профиля на сервер. При первой регистрации вместо профиля, установленного по умолчанию, пользователь получит копию заранее сконфигурированного профиля с сервера. В дальнейшем этот профиль функционирует так же, как любой стандартный профиль пользователя. Каждый раз, когда пользователь завершает работу, его профиль сохраняется локально и одновременно копируется на сервер.</td></tr>
</table>

<p>&nbsp;</p><table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Для копирования профиля пользователя следует перейти на вкладку Профили пользователей окна Система. Нельзя для этой цели использовать Проводник или какой-либо другой инструмент управления файлами!</td></tr>
</table>
<P><I>Обязательный профиль </i>представляет собой сконфигурированный заранее перемещаемый профиль, который недоступен пользователю для модификации. Пользователь может изменять настройки рабочего стола, но при завершении работы на компьютере изменения не заносятся в профиль. При следующей регистрации на компьютере загружается обязательный профиль пользователя, в котором не произошло никаких изменений. Профиль пользователя становится обязательным, когда вы переименовываете файл NTuser.dat в NTuser.man. В этом случае файл становится доступен только для чтения. Один обязательный профиль может быть использован большим количеством пользователей.</P>
<table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Когда для обеспечения безопасности или приведения рабочей среды пользователя в соответствии с его уровнем подготовки для работы на компьютере необходимо контролировать набор доступных функций, лучше использовать групповые политики. С их помощью вы можете выбрать подмножество настроек, а также контролировать как параметры среды <I>пользователя, </I>так и настройки <I>компьютера.</i></td></tr>
</table>
<p>&nbsp;</p>
<a NAME="18"></a><font face=""><font size="4">Указание пути к профилю пользователя в учетной записи</font></font> <P>Добавить путь расположения профиля пользователя к учетной записи можно с помощью вкладки <B>Профиль </B>окна свойств пользователя, открытого для определенной учетной записи в. окне оснастки <B>Локальные пользователи и группы </B>(или <B>Active Directory — пользователи и компьютеры). </B>Перейдите на вкладку <B>Профиль </B>и добавьте путь к профилю пользователя (рис. 11.3).</P>
<P>В учетной записи следует указать полный путь к профилю пользователя:</P>
<I><FONT FACE="Courier New"><P>\\серъер\имя_общего_ресурса\имя_профиля</P>
</font></I><P>В качестве общего ресурса может выступать любая папка, к которой следует организовать общий доступ для группы Все (Everyone). В качестве имени профиля следует указать имя папки профиля данного пользователя (это может быть любая папка на общем ресурсе, в которой будет храниться про-</P>
<P>филь). Путь профиля пользователя может указывать на любой сервер. Это не обязательно должен быть контроллер домена. Когда пользователь регистрируется в сети, Windows 2000 Server проверяет, указан ли в его учетной записи путь профиля. Если путь указан, система находит соответствующий профиль.</P>
 <table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-3.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.3. </B>Вкладка <B>Профиль </B>(Profile) окна свойств учетной записи</font> 
        </td>
      </tr>
    </table>

<p>&nbsp;</p>
<a NAME="19"></a><font face=""><font size="4">Копирование профиля пользователя на сервер</font></font> <P>Для того чтобы сделать определенный профиль доступным для нескольких пользователей, скопируйте его, на сервер с помощью вкладки <B>Профили пользователей </B>окна <B>Система, </B>вызываемого из панели управления. Место, куда скопирован профиль, должно совпадать с путем профиля, указанным в учетных записях пользователей.</P>
<P>В окне диалога <B>Свойства системы </B>(System Properties) перейдите на вкладку <B>Профили пользователей. </B>Все профили пользователей, созданные на компьютере, появятся в списке <B>Профили, хранящиеся на этом компьютере </B>(Profiles stored on this computer).</P>
<P>Для копирования определенного профиля пользователя перейдите на вкладку <B>Копировать </B>и введите имя целевой папки. В качестве альтернативы можно выбрать целевую папку с помощью службы просмотра. На рис. 11.4 показан пример окна <B>Свойства системы </B>со списком созданных на компьютере профилей пользователя.</P>
 <table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-4.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.4. </B>Окно <B>Свойства системы </B>(System Properties) со списком созданных на компьютере профилей пользователя</font> 
        </td>
      </tr>
    </table>
<p>&nbsp;</p>
<a NAME="20"></a><font face=""><font size="4">Добавление пользователей и групп к списку разрешений перемещаемого профиля пользователя</font></font> <P>С помощью окна <B>Система </B>вместе с профилем пользователя копируются и соответствующие разрешения. Поэтому пользователь автоматически получает доступ к своему профилю. Однако если вы хотите, чтобы к профилю получили доступ другие пользователи и группы, необходимо добавить их в список объектов, которым разрешено использовать данный профиль. Для этого в списке <B>Профили, хранящиеся на этом компьютере </B>выберите интересующий вас профиль и нажмите кнопку <B>Копировать. </B>Появится окно диалога <B>Копирование профиля </B>(Сору То) (рис. 11.5). В группе <B>Разрешить использование </B>(Permitted to use) показано, кто имеет разрешение на использование данного профиля. Для того чтобы добавить нового пользователя или группу к списку разрешений профиля пользователя, нажмите кнопку <B>Изменить </B>(Change).</P>
<p>&nbsp;</p><table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Если вы назначаете путь перемещаемого профиля пользователя группе, то при каждом завершении работы кого-либо из членов группы его настройки записываются в хранящийся централизованно профиль. По этой причине рекомендуется делать такие профили пользователя обязательными или устанавливать различные настройки разным группам с помощью системных политик.</td></tr>
</table>
<p>&nbsp;</p><table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-5.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.5. </B>Окно диалога <B>Копирование профиля </B>(Сору То)</font> 
        </td>
      </tr>
    </table>

<p>&nbsp;</p>
<a NAME="21"></a><font face=""><font size="4">Изменение типа профиля пользователя для подключения по медленной линии</font></font> <P>Пользователи, присоединяющиеся к сети по медленной линии, например, при использовании службы удаленного доступа, могут работать со своим локальным профилем, а не загружать его с сервера по сети, что значительно ускоряет процесс регистрации. В таком случае при регистрации появляется окно, в котором пользователь может указать, какой профиль должен быть загружен.</P>
<P>Если вы уже зарегистрировались в сети, с помощью кнопки <B>Сменить тип </B>(Change Type) на вкладке <B>Профиль </B>окна свойств системы можно изменить тип профиля пользователя с перемещаемого на локальный и наоборот. Новые настройки останутся неизменными до их следующей модификации. При изменении профиля пользователя с перемещаемого на локальный кэшированная локально копия вашего профиля будет загружаться при каждой регистрации в компьютере. При каждом завершении работы все изменения также будут записываться в локальную копию профиля.</P>
<P>Если клиент работает по медленной линии, то для ускорения входа в систему можно установить на компьютере групповую политику, при которой будет использоваться кэшированный профиль, а не загружаемый с сервера. Имеется также групповая политика, с помощью которой можно определить, какая линия будет считаться "медленной".</P>
<p>&nbsp;</p>
<a NAME="22"></a><font face=""><font size="4">Подготовка заранее настроенных перемещаемых и обязательных профилей пользователя</font></font> <P>Хотя для создания заранее сконфигурированного перемещаемого или обязательного профиля можно использовать любую учетную запись, часто удобнее иной подход. Например, если вы хотите создать три различных заранее настроенных перемещаемых или обязательных профиля для трех отделов предприятия, сначала следует создать и настроить три различные базовые учетные записи. Затем необходимо зарегистрироваться с помощью каждой</P>
<P>из созданных учетных записей и тем самым создать три профиля пользователя для трех отделов. После этого опять зарегистрироваться с помощью учетной записи администратора и, используя оснастку <B>Локальные пользователи и группы, </B>назначить созданные профили индивидуальным пользователям или группам. Затем с помощью вкладки <B>Профили пользователей </B>окна <B>Система </B>панели управления скопируйте созданные профили на соответствующий сервер.</P>
<p>&nbsp;</p>
<a NAME="23"></a><font face=""><font size="4">Работа пользователей с различными конфигурациями оборудования</font></font> <P>Следует помнить, что профили могут применяться на компьютерах, отличающихся по конфигурации оборудования, особенно типами мониторов и видеоадаптеров.</P>
<P>Профиль пользователя может определять положение и размер окон, поэтому тип оборудования экрана в значительной степени влияет на качество работы профиля. Например, параметры окна, выводимого на экране типа Super VGA, могут быть неверны при выводе того же изображения на экране с типом VGA. Для предотвращения подобных проблем:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Создавайте и редактируйте профиль пользователя на компьютере, тип экрана которого совпадает с типом экрана компьютера пользователя.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>При создании обязательного профиля для нескольких пользователей создавайте один профиль для группы пользователей только в случае, если все члены группы работают на компьютерах с одинаковым типом экранов.    </td></tr>
    </TABLE>
<p>&nbsp;</p>
<a NAME="24"></a><font face=""><font size="4">Удаление профиля пользователя</font></font> <P>Если вы больше не хотите использовать перемещаемый или обязательный профиль, назначенный пользователям, с помощью оснастки <B>Локальные пользователи и группы </B>удалите путь к нему в учетных записях соответствующих пользователей. Сам профиль пользователя, находящийся на сервере, можно удалить с помощью кнопки <B>Удалить </B>на вкладке <B>Профили пользователей </B>окна <B>Система.</b></P>
<font face="">
</FONT><p>&nbsp;</p>
<a NAME="25"></a><font face=""><font size="4">Настройка рабочей среды пользователя при помощи сценариев входа</font></font> <P>Сценарии входа выполняются автоматически в процессе каждой регистрации пользователя на компьютере, работающем с программным обеспечением Windows 2000. Хотя чаще всего сценарий входа представляет собой командный файл с расширением bat или cmd, в качестве сценария может быть использован и исполняемый файл (*.ехе).</P>
<P>Сценарии входа не являются обязательными. Они могут применяться для настройки рабочей среды пользователя, создания сетевых соединений или запуска приложений. Сценарии входа очень удобны, если необходимо изменить некоторые параметры рабочей среды пользователя без выполнения ее полной настройки.</P>
<table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Профили пользователя могут в процессе регистрации восстанавливать существовавшие ранее соединения с сетью, но они не могут быть использованы для создания новых соединений.</td></tr>
</table>
<p>&nbsp;</p>
<a NAME="26"></a><font face=""><font size="4">Создание сценариев входа</font></font> <P>Для создания сценариев входа может быть использован обыкновенный текстовый редактор. Затем с помощью оснастки <B>Локальные пользователи и группы </B>(Local Users and Groups) сценарии входа назначаются соответствующим пользователям. Кроме того, один сценарий может быть назначен нескольким пользователям. В табл. 11.3 приведены параметры, значения которых можно устанавливать с помощью сценария входа и их описания.</P>
<P><I><B>Таблица 11.3. </B>Параметры, устанавливаемые с помощью сценария входа</I>
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
<TR><TD WIDTH="37%" VALIGN="TOP" >
<font face=""><P>Параметр</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP" >
<font face=""><P>Описание</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP">
<font face=""><P>%HOMEDRIVE%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP">
<font face=""><P>Имя устройства локального компьютера, связанного с домашним каталогом пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP">
<font face=""><P>%НШЕРАТН%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP">
<font face=""><P>Полный путь к домашнему каталогу пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP">
<font face=""><P>%HOMESHARE%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP">
<font face=""><P>Имя общего  ресурса,   где  находится домашний каталог пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP" >
<font face=""><P>%OS%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP" >
<font face=""><P>Операционная система компьютера пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP">
<font face=""><P>% PROCESSOR_ARCHITECTURE%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP">
<font face=""><P>Тип процессора (например, Pentium) компьютера пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP" >
<font face=""><P>%PROCESSOR_LEVEL%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP" >
<font face=""><P>Уровень процессора компьютера пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP">
<font face=""><P>%USERDOMAIN%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP">
<font face=""><P>Домен, в котором находится учетная запись пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="37%" VALIGN="TOP">
<font face=""><P>%USERNAME%</P>
</FONT></TD>
<TD WIDTH="63%" VALIGN="TOP">
<font face=""><P>Имя пользователя</P>
</FONT></TD>
</TR>
</TABLE>

<p>&nbsp;</p>
<a NAME="27"></a><font face=""><font size="4">Назначение сценариев входа учетным записям пользователей и групп</font></font> <P>Для того чтобы назначить сценарий входа учетным записям пользователей и групп, с помощью оснастки <B>Локальные пользователи и группы </B>(или <B>Active</b></P><P>
<B>Directory - пользователи и компьютеры — </b>если компьютер входит в домен) указывается путь к сценарию. Если при регистрации пользователя с помощью определенной учетной записи среди ее параметров указан путь к сценарию входа, соответствующий файл сценария открывается и выполняется.</P>
<P>На вкладке <B>Профиль </B>окна свойств учетной записи вы можете назначить сценарий входа, введя в поле <B>Сценарий входа </B>(Logon Script) имя файла (и, возможно, относительный путь к нему). При регистрации сервер, аутентифицирующий пользователя, находит файл сценария (если таковой существует) с помощью указанного в учетной записи имени и пути (на контроллерах домена, как правило, сценарии хранятся в общей папке NETLOGON — %SystemRoot%\SYSVOL\sysvol\DNS-имя-домена\scripts). Если перед именем файла указан относительный путь, сервер ищет сценарий входа в подкаталоге основного локального пути сценариев.</P>
<P>Данные поля <B>Сценарий входа </B>определяют только имя файла и относительный путь, но не содержат сам сценарий входа. После создания файл сценария с определенным именем помещается в соответствующий реплицируемый (если компьютеры объединены в домен) каталог.</P>
<P>Сценарий входа можно поместить в локальный каталог компьютера пользователя. Но подобный подход, как правило, применяется только при администрировании учетных записей, существующих на одиночном компьютере, а не в домене. В этом случае вы должны поместить файл сценария в соответствии с локальным путем к сценариям входа в компьютер.</P>
<P>Помимо оснастки <B>Локальные пользователи и группы, </B>сценарии входа могут быть назначены пользователям или компьютерам и с помощью оснастки <B>Групповая политика </B>(Group Policy).</P>
<p>&nbsp;</p>
<a NAME="28"></a><font face=""><font size="4">Переменные среды</font></font> 
<p>&nbsp;</p>
<a NAME="29"></a><font face=""><font size="4">Изменение системных и пользовательских переменных среды</font></font> <P>Для конфигурирования, поиска, выделения памяти определенным программам и управления приложениями операционная система Windows 2000 и прикладные программы требуют определенной информации, называемой <I>переменными среды </I>системы и пользователя. Их можно просмотреть на вкладке <B>Дополнительно </B>(Advanced) окна Система, нажав кнопку <B>Переменные среды </B>(Environment Variables). Эти переменные похожи на переменные, которые устанавливались в операционной системе MS-DOS, например path</P>
<P>И TEMP.</P>
<P><I>Системные </i>переменные среды определяются в Windows 2000 независимо от того, кто зарегистрировался на компьютере. Если вы зарегистрировались как член группы Администраторы, то можете добавить новые переменные или изменить их значения.</P>
<P>Переменные среды <I>пользователя </I>устанавливаются индивидуально для каждого пользователя одного и того же компьютера. Сюда включаются любые переменные среды, которые вы хотите определить, или переменные, определенные вашим приложением, например путь к файлам приложения.</P>
<P>После изменения переменных среды их новые величины сохранятся в реестре, после чего они становятся доступны ("видны") при закрытии окна <B>Переменные среды.</b></P>
<P>Если между переменными среды возникает конфликт, он разрешается следующим способом:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> Устанавливаются системные переменные среды.<p></P>
</td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> Устанавливаются переменные, определенные в файле Autoexec.bat (за исключением переменных path). Они перезаписывают системные переменные.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> Устанавливаются переменные среды пользователя, определенные в окне <B>Система. </B>Они перезаписывают как системные переменные, так и переменные файла Autoexec.bat.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">4.</td>
      <td> Устанавливаются переменные path файла Autoexec.bat.</td>
</tr>
</TABLE>
<p>&nbsp;</p><table>
<tr><td> </td><td><B><U><font color=000099>
      <P>Примечание
      </font></u></B></td></tr><tr><td> </td><td>Настройки пути (path), в отличие от других переменных среды, кумулятивны. Полный путь (который вы видите как результат выполнения в командной строке команды path) создается присоединением путей, устанавливаемых в файле Autoexec.bat, к путям, определенным в окне Система.</td></tr>
</table>
<p>&nbsp;</p>
<a NAME="30"></a><font face=""><font size="4">Использование переменных среды в профилях пользователей, именах домашних каталогах и сценариев входа </font></font> <P>При управлении множеством учетных записей пользователей и групп часто возникает необходимость одновременно выполнить одинаковые изменения в нескольких учетных записях. Вместо конкретных имен или меток в сценарий входа вводится одна общая переменная среды, замещаемая реальными данными в процессе выполнения сценария.</P>
<P>Значение любой переменной среды компьютера клиента, где работает программное обеспечение Windows 2000, может быть подставлено в путь профиля, задаваемого в учетной записи пользователя, путь сценария входа, путь домашнего каталога и в сам сценарий входа. Для этого системную переменную среды следует заключить в знаки процента (%). Например, для того чтобы использовать в пути профиля пользователя переменную среды servername, в поле <B>Путь к профилю </B>(Profile Path) окна учетной записи следует ввести <I><FONT FACE="Courier New">\\%servername%\scripts.</font></i></P>
<P>Подобный подход очень удобен при работе с профилями пользователя в сетях, включающих каналы WAN. Особенно, если ваши пользователи работают с обеих сторон этого канала. Предположим, что сеть состоит из двух площадок, разделенных глобальным каналом. На каждом из компьютеров, работающих на одной стороне канала, переменная servemame устанавливается в соответствии с именем контроллера домена данной площадки. На другой стороне канала переменная servemame устанавливается аналогичным образом, но ее значение соответствует имени контроллера домена этой площадки. Теперь в пути сценария вх"ода каждой учетной записи пользователя домена используется <I>%servername%. </I>Когда пользователь регистрируется в сети, его сценарий входа загружается с сервера, определяемого переменной среды и расположенного локально относительно глобального канала.</P>
<p>&nbsp;</p>
<a NAME="31"></a><font face=""><font size="4">Сервер сценариев Windows (WSH)</font></font> <P>Сервер сценариев Microsoft Windows (Windows Scripting Host, WSH) не зависит от языка сценария и устанавливается во всех системах Windows 2000 как стандартное средство. Он предназначен для 32-разрядных операционных систем Windows. Компания Microsoft разработала ядро сценариев как для Visual Basic, так и для JavaScript. Предполагается, что будет также создано ядро сценариев ActiveX для таких языков, как Perl, TCL, REXX и Python. Сервер сценариев может быть запущен с помощью исполняемого файла для Windows (WSCRIPT.EXE) и с помощью директивы командной строки оболочки (CSCRIPT.EXE).</P>
<p>&nbsp;</p>
<a NAME="32"></a><font face=""><font size="4">Назначение сервера сценариев</font></font> <P>Сервер сценариев позволяет применять в операционных системах Windows простые мощные и гибкие сценарии. Раньше единственным языком сценариев, поддерживаемым операционной системой Windows, был язык команд MS-DOS (командный файл). Хотя это быстрый и компактный язык в сравнении с языками VBScript и Jscript, он обладает весьма ограниченными возможностями. В настоящее время архитектура сценариев ActiveX позволяет в полной мере использовать все средства таких языков сценариев, как VBScript и JScript, одновременно сохраняя совместимость с набором команд MS-DOS.</P>
<P>Компания Microsoft поставляет три сервера, предназначенных для выполнения языков сценариев на платформах Windows: </P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td> Internet Explorer<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Internet Information Server или WWW Server в составе служб Internet Information Services<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Windows Scripting Host    </td></tr>
    </TABLE>
<P>Internet Explorer позволяет выполнять сценарии на машинах клиентов внутри HTML-страниц.</P>
<P>Internet Information Server поддерживает работу со страницами ASP, позволяющими выполнять сценарии на веб-сервере. Другими словами, выполнение сценариев на сервере становится возможным в сетях Интернет и интранет.</P>
<P>Сервер сценариев Windows позволяет выполнять сценарии прямо на рабочем столе операционной системы Windows или на командной консоли, для этого не нужно встраивать их в документ HTML. Выполнение сценария на рабочем столе инициируется щелчком мыши на файле сценария. В процессе работы сервер сценариев чрезвычайно экономно использует память, что очень удобно для выполнения не интерактивных сценариев, например сценария входа в сеть, административного сценария, и автоматизации операций, выполняемых на машине.</P>
<p>&nbsp;</p>
<a NAME="33"></a><font face=""><font size="4">Запуск сервера сценариев из командной строки</font></font> <P>Для запуска сервера сценариев из командной строки используйте утилиту CSCRIPT.EXE в соответствии со следующим синтаксисом:</P>
<P>cscript   [параметры сервера сценариев]   имя сценария  [параметры <I>сценария]</i></P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><I>Параметры сервера сценариев </I>включают и отключают различные средства сервера сценариев. Они всегда предваряются двумя слэшами (//)<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><I>Имя сценария </I>— это имя файла сценария, например, CHART.VBS<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><I>Параметры сценария </I>передаются в сценарий. Они всегда предваряются одним слэшем    </td></tr>
    </TABLE>
<P>Ни один из параметров не является обязательным. Однако нельзя указать параметры сценария без указания самого сценария. Если вы не указываете ни одного параметра, CSCRIPT.EXE выдает на экран синтаксис своего запуска и допустимые параметры сервера сценариев (табл. 11.4).</P>
<P><I><B>Таблица  11.4. </B>Параметры сервера сценариев, поддерживаемые CSCRIPT.EXE</I> 
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
<TR><TD WIDTH="19%" VALIGN="TOP" >
<font face=""><P>Параметр</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP" >
<font face=""><P>Описание</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//в</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Пакетный режим. Не отображает на экране сообщений об ошибках и приглашения пользователей</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//D</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Активизирует функцию отладки</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//E=engine</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Задает ядро, используемое для выполнения сценария</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//Н: Cscript или Wscript</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Устанавливает CSCRIPT.EXE или WSCRIPT.EXE в качестве приложения, выбираемого по умолчанию для выполнения сценариев. По умолчанию установлен WSCRIPT.EXE</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//I</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Интерактивный режим (выбирается по умолчанию; режим, обратный задаваемому параметром //в)</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//Job: xxx</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Выполняет задание WSH</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//logo</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Отображает на экране заставку (выбирается по умолчанию; режим, обратный задаваемому параметром //NoLogo)</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//nologo</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Запрещает вывод заставки</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//S</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Сохраняет текущие параметры командной строки для этого пользователя</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//T:nn</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Время ожидания в секундах. Максимальное время, в течение которого может выполняться сценарий. (По умолчанию ограничение не устанавливается)</P>
<P>Этот параметр используется для предотвращения слишком длительного   выполнения   сценариев.   Устанавливается  специальный таймер. Когда время выполнения превышает установленное значение, CSCRIPT прерывает работу ядра сценариев с помощью метода</P>
<P>lactiveScript : : InterruptThread и завершает процесс</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//X</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Задает выполнение сценария в режиме отладки, если этот режим активизирован с помощью параметра //о</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//U</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Использует кодировку Unicode для перенаправленного консольного ввода/вывода</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="19%" VALIGN="TOP">
<font face=""><P>//?</P>
</FONT></TD>
<TD WIDTH="81%" VALIGN="TOP">
<font face=""><P>Показывает параметры и синтаксис команды CSCRIPT.EXE</P>
</FONT></TD>
</TR>
</TABLE>

<P>Дистрибутив сервера сценариев содержит несколько простых примеров сценариев. Их также можно скачать в пакете Sample Scripts по адресу <B>http://msdn.microsoft.com/scripting/default.htm7/scripting/windowshost.</b></P>
<P>Например, для того чтобы запустить CHART.VBS:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> В   меню  <B>Пуск  </B>выберите   команду  <B>Программы | Стандартные | Командная строка.<p></P>
</B></td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> В командной строке выполните следующие команды:<p></P>
<FONT FACE="Courier New"><P>cscript <I>"устройство:"\"Каталог"\chart.vbs </I>//logo</P>
<P>cscript <I>"устройство:"\"Каталог"\chart.vbs </I>//nologo</FONT></td>
</tr>
</TABLE>
<P>В операционной системе Windows 2000 не обязательно указывать расширение сценариев: можно просто набрать с клавиатуры имя сценария или щелкнуть на нем мышью в окне Проводника.</P>
<p>&nbsp;</p>
<a NAME="34"></a><font face=""><font size="4">Запуск сценариев в среде Windows</font></font> <P>Сценарий в среде Windows можно запустить тремя способами:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Двойным щелчком мыши на файле сценария или на соответствующем значке в окнах <B>Мой компьютер, Проводник </B>или <B>Поиск </B>(Find).<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td><B>В окне Выполнить </B>(Run) введите с клавиатуры полное имя выполняемого<p></P>
<P>сценария и нажмите кнопку ОК. </P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>В окне <B>Выполнить </B>введите wscript.exe с указанием имени сценария и<p></P>
<P>необходимых параметров сервера и сценария.    </td></tr>
    </TABLE>
<P>При запуске сценария с помощью WSH можно указать, какое приложение следует использовать — CSCRIPT.EXE или WSCRIPT.EXE. Приложение сервера, выбираемое по умолчанию, может быть установлено с помощью</P>
<P><B>Команды </b>cscript //Н: <I>Имя_сервера_сценариев.</i></P>
<P>Например, если вы устанавливаете в качестве приложения, выбираемого по умолчанию, WSCRIPT.EXE и выполняете сценарий с именем CHART.VBS, то WSCRIPT.EXE будет выбираться по умолчанию для всех файлов сценариев, имеющих расширение vbs.</P>
<P>Страница свойств сервера сценариев Windows позволяет устанавливать параметры, приведенные в табл. 11.5.</P>
<P><I><B>Таблица 11.5. </B>Свойства сервера сценариев</I> 
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
<TR><TD WIDTH="38%" VALIGN="TOP">
<font face=""><P>Свойство</P>
</FONT></TD>
<TD WIDTH="36%" VALIGN="TOP">
<font face=""><P>Применение</P>
</FONT></TD>
<TD WIDTH="26%" VALIGN="TOP">
<font face=""><P>Эквивалент параметра команды</P>
<P>Cscript</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="38%" VALIGN="TOP">
<font face=""><P>Останавливать выполнение сценария после <I>пп </I>секунд</P>
<P>(Stop scripts after specified number of seconds)</P>
</FONT></TD>
<TD WIDTH="36%" VALIGN="TOP">
<font face=""><P>Максимальное количество секунд, в течение которых можно выполнять сценарий. (По умолчанию ограничение не устанавливается)</P>
</FONT></TD>
<TD WIDTH="26%" VALIGN="TOP">
<font face=""><P>//T:nn</P>
</FONT></TD>
</TR>
<TR><TD WIDTH="38%" VALIGN="TOP">
<font face=""><P>Отображать заставку во время выполнения сценария в консоли (Display logo when scripts executed in command console)</P>
</FONT></TD>
<TD WIDTH="36%" VALIGN="TOP">
<font face=""><P>Отображать заставку. (Обратное параметру //nologo. Устанавливается По умолчанию)</P>
</FONT></TD>
<TD WIDTH="26%" VALIGN="TOP">
<font face=""><P>//logo ИДИ //nologo</P>
</FONT></TD>
</TR>
</TABLE>

<p>&nbsp;</p>
<a NAME="35"></a><font face=""><font size="4">Настройка индивидуальных свойств сценария.</font></font>

<p>&nbsp;</p>
<a NAME="36"></a><font face=""><font size="4">Файл с расширением wsh</font></font> <P>С помощью страницы свойств модуля WSCRIPT.EXE можно установить глобальные параметры, касающиеся сразу всех сценариев, выполняемых на локальной машине. Однако также можно настроить индивидуальные пара-</P>
<P>метры отдельно взятого сценария, позволяющие осуществлять жесткий контроль его выполнения. Свойства конкретного сценария сохраняются в файле с расширением wsh. Для его создания просто установите указатель мыши на файле сценария в окне Проводника и нажмите правую кнопку. В появившемся контекстном меню выберите команду Свойства. Настройте индивидуальные свойства сценария, например максимальное время исполнения, и нажмите кнопку ОК. В результате в каталоге, где находится сценарий, будет создан файл с расширением wsh, имя которого совпадает с именем сценария. Он содержит индивидуальные настройки сценариев для WSH. Функции этого файла сходны с функциями файла PIF 16-разрядных приложений. Чтобы запустить сценарий, для которого создан файл с расширением wsh, следует дважды щелкнуть мышью на файле *.wsh в окне Проводника или использовать этот файл в качестве параметра для программы WSCRIPT.EXE или CSCRIPT.EXE в командной строке. Например:</P>
<FONT FACE="Courier New"><P>C:\&gt;cscript Myscript.wsh</P>
</FONT><P>Поскольку в файле с расширением wsh хранятся значения параметров, используемых сценарием при выполнении, системный администратор может создать несколько версий файла с параметрами, ориентированных на различные группы пользователей внутри организации. Набор файлов с расширением wsh, относящийся к одному сценарию, может быть использован следующим образом:</P>
<table><font face=""><font size="4">
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Администратор может создать отдельный файл *.wsh для определенной группы пользователей внутри организации. Это позволит осуществлять индивидуальный контроль определенных сценариев, выполняющихся в течение дня.<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Администратор может создать индивидуальные файлы *.wsh для конкретных пользователей внутри организации. Это позволяет осуществлять полный контроль ряда сценариев, используемых внутри организации.<p></P>
</td></tr>
</font></font><tr VALIGN=TOP><font face=""><font size="4">
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td></font></font>
    <td>Индивидуальные файлы с расширением wsh могут быть созданы для сценариев? 
      входа пользователей в систему. Это позволяет администратору осуществлять 
      индивидуальный контроль над рядом свойств сценариев, выполняемых на клиентских 
      машинах при регистрации пользователя в системе.
<p></P>
</td></tr></table>
<P>Файл с расширением wsh представляет собой простой текстовый файл, формат которого сходен с форматом файла с расширением inf. Ниже приведен пример содержимого файла *.wsh:</P>
<FONT FACE="Courier New"><P>[ScriptFile]</P>
<P>Path=C:\WINNT\Saraples\WSH\showprop.vbs</P>
<P>[Options]</P>
<P>Timeout=0</P>
<P>DisplayLogo=l BatchMode=0</P>
</FONT><P>Параметр Path в разделе [ScriptFile] определяет местоположение файла сценария, с которым связан данный файл *.wsh. Параметры, значения которых устанавливаются в разделе [Options], соответствуют настройкам вкладки Сценарий (Script) окна Свойства.</P>
<P>После двойного щелчка мышью на файле с расширением wsh или выполнения его в командной строке программа CSCRIPT.EXE или WSCRIPT.EXE считывает его и определяет специфические параметры, которые следует использовать при выполнении соответствующего сценария. В результате сценарий будет выполняться с необходимыми параметрами, заданными в файле *.wsh. Обратите внимание, что при запуске файла с расширением wsh необходимо присутствие соответствующего ему сценария. Если выполнение сценария посредством файла *.wsh закончилось неудачно, проверьте запись Path=. Она должна указывать на тот сценарий, который вы хотите выполнить.</P>
<p>&nbsp;</p>
<a NAME="37"></a><font face=""><font size="4">Аудит локальной системы</font></font> <P>Аудит — это процесс, позволяющий фиксировать события, происходящие в операционной системе и имеющие отношение к безопасности. Например, попытки создать объекты файловой системы или Active Directory, получить к ним доступ или удалить их. Информация о подобных событиях заносится в файл <I>журнала событий </I>операционной системы.</P>
<P>После включения аудита операционная система Windows 2000 начинает отслеживать события, связанные с безопасностью. Полученную в результате информацию можно просмотреть с помощью оснастки <B>Просмотр событий </B>(Event Viewer). В процессе настройки аудита необходимо указать, какие события должны быть отслежены. Информация о них помещается в журнал событий. Каждая запись журнала хранит данные о типе выполненного действия, пользователе, выполнившем его, а также о дате и моменте времени выполнения данного действия. Аудит позволяет отслеживать как успешные, так и неудачные попытки выполнения определенного действия, поэтому при просмотре журнала событий можно выяснить; кто предпринял попытку выполнения неразрешенного ему действия.</P>
<P>Аудит представляет собой многошаговый процесс. Сначала его следует активизировать с помощью оснастки <B>Групповая политика </B>(Group Policy). (По умолчанию аудит отключен, поскольку он снижает производительность системы.) После включения аудита необходимо определить набор отслеживаемых событий. Это могут быть, например, вход и выход из системы, попытки получить доступ к объектам файловой системы и т. д. Затем следует указать, какие конкретно объекты необходимо подвергнуть аудиту и включить его с помощью Редактора списков управления доступом, ACL.</P>
<table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Для того чтобы иметь возможность настраивать аудит для файлов и папок, необходимо иметь права администратора.</td></tr>
</table>
<P>Аудит, установленный для родительской папки, автоматически наследуется всеми вновь созданными дочерними папками и файлами. Этого можно избежать, если при создании файла или папки вызвать окно свойств и на вкладке <B>Аудит </B>(Auditing) снять флажок <B>Переносить наследуемый от родительского объекта аудит на этот объект </B>(Allow inheritable auditing entries from parent to propagate to this object). Если же этот флажок отображен серым цветом или кнопка <B>Удалить </B>недоступна, это значит, что настройки аудита уже унаследованы. В этом случае для изменения настроек аудита дочерних объектов нужно изменить настройки аудита родительской папки, и они будут наследоваться всеми дочерними объектами.</P>
<p>&nbsp;</p>
<a NAME="38"></a><font face=""><font size="4">Активизация аудита с помощью оснастки <I>Групповая политика </I>(Group Policy)</font></font> <P>Для активизации аудита на изолированном компьютере:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> Запустите оснастку <B>Групповая политика </B>(это изолированная оснастка, которую можно использовать как самостоятельный инструмент). (Можно выполнить команду <B>Пуск, Программы, Администрирование, Локальная политика безопасности.) *<p></P>
</B></td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> Откройте папку <B>Конфигурация компьютера </B>(Computer Configuration) и последовательно раскройте узлы <B>Конфигурация Windows </B>(Windows Setting), <B>Параметры безопасности </B>(Security Settings), <B>Локальные политики </B>(Local Policies), <B>Политика аудита </B>(Audit Policy).<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> На правой панели появится список политик аудита. По умолчанию все они имеют значение <B>Нет аудита </B>(No Auditing). Для включения аудита следует изменить значения нужных параметров.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">4.</td>
      <td> Выполните двойной щелчок на устанавливаемой политике аудита. Появится окно диалога, с помощью которого можно разрешить аудит. В группе <B>Вести аудит следующих попыток доступа </B>(Audit these attempts) установите флажки <B>Успех </B>(Success) или <B>Отказ </B>(Failure), или оба.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">5.</td>
      <td> Нажмите кнопку ОК.</td>
</tr>
</TABLE>
<P>Подобную операцию следует повторить для политик аудита, которые вы хотите активизировать. Для того чтобы отключить аудит, следует снять флажки <B>Успех и Отказ.</b></P>
<p>&nbsp;</p>
<a NAME="39"></a><font face=""><font size="4">Настройка и просмотр аудита папок и файлов</font></font> <P>Чтобы настроить, просмотреть или изменить настройки аудита файлов и папок:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      <td> Установите указатель мыши на файл или папку, для которой следует выполнить аудит, и нажмите правую кнопку. В появившемся контекстном меню выберите команду <B>Свойства. </B>В окне свойств папки или файла перейдите на вкладку <B>Безопасность </B>(Security).<p></P>
</td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td>  На вкладке <B>Безопасность </B>нажмите кнопку <B>Дополнительно </B>(Advanced) и затем перейдите на вкладку <B>Аудит.<p></P>
</B></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> Если вы хотите настроить аудит для нового пользователя или группы, на вкладке <B>Аудит </B>нажмите кнопку <B>Добавить. </B>Появится диалоговое окно <B>Выбор: Пользователь,  Компьютер или Группа </B>(Select  User,  Computer, or Group).  Выберите имя нужного пользователя или  группы и нажмите кнопку ОК. Откроется окно диалога <B>Элемент аудита для </B>(Audit Entry for). Здесь вы сможете ввести все необходимые параметры аудита. В списке <B>Применять </B>(Apply onto) укажите, где следует выполнять аудит (это поле ввода доступно только для папок). В группе <B>Доступ </B>(Access) следует указать, какие события следует отслеживать: окончившиеся успешно <B>(Успех, </B>Successful!), неудачно <B>(Отказ,  </B>Failed) или оба типа событий.  Флажок <B>Применять этот аудит к объектам и контейнерам только внутри этого контейнера </B>(Apply these audit entries to objects and/or containers within this container only) определяет, распространяются ли  введенные вами настройки аудита на файлы и папки, находящиеся ниже по дереву каталогов файловой системы (флажок не установлен). В обратном случае установите флажок (или выберите в списке <B>Применять </B>опцию <B>Только для этой папки). </B>Это позволит не выполнять аудит для тех объектов файловой системы, которые не представляют интереса. После завершения настройки аудита для папки или файла нажмите несколько раз кнопку ОК, чтобы закрыть все окна диалога.<p></P>
</tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">4.</td>
      <td> Если вы хотите просмотреть или изменить настройки аудита для уже существующего пользователя или группы, нажмите кнопку <B>Показать/Изменить </B>(View/Edit). Появится окно диалога <B>Элемент аудита </B>для. Здесь вы сможете выполнить все необходимые изменения параметров аудита для выбранного вами пользователя или группы. По окончании внесения изменений нажмите кнопку ОК.</td>
</tr>
</TABLE>
<p>&nbsp;</p>
<a NAME="40"></a><font face=""><font size="4">Область действия настроек аудита</font></font> <P>Настройка аудита выполняется с помощью окна диалога <B>Элемент аудита для, </B>где с помощью поля <B>Применять </B>можно определить область распространения настроек аудита. Результирующее действие значения, введенного в этом поле, зависит от того, установлен ли флажок <B>Применять этот аудит к объектам и контейнерам только внутри этого контейнера. </B>По умолчанию этот флажок снят. В табл. <I>11.6 </I>и 11.7 показано, как настройки аудита действуют в случае, когда этот флажок соответственно снят и установлен.</P>
<P><I><B>Таблица 11.6. </B>Действие настроек аудита при снятом флажке Применять 
  этот аудит к объектам и контейнерам только внутри этого контейнера</i>
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Значения в поле </P>
      <I> 
      <P>Применять</P>
      </i></font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит текущей папки</font></P>
      </font></TD>
    <TD WIDTH="16%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит дочерних папок текущей папки</font></P>
      </font></TD>
    <TD WIDTH="16%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит файлов в текущей папке</font></P>
      </font></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит всех дочерних папок</font></P>
      </font></TD>
    <TD WIDTH="16%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит файлов во всех дочерних папках</font></P>
      </font></TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Только для этой папки (This folder only)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Для этой папки, ее подпапок и файлов (The folder, subfolders and files)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Для “тай папки и ее подпапок (This folder and subfolders)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Для “тай папки и ее файлов (This folder and files)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Только для подпапок и файлов</P>
      <P>(Subfolders and files only)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Только для подпапок</P>
      <P>(Subfolders only)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
  </TR>
  <TR> 
    <TD WIDTH="23%" VALIGN="TOP"> <font face=""> 
      <P>Только для файлов (Files only)</P>
      </font></TD>
    <TD WIDTH="14%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <div align="center"><b><font face=""></FONT><font face=""> </FONT></b> </div>
      <P align="center">&nbsp;</P>
      <P align="center">&nbsp; 
    </TD>
    <TD WIDTH="16%" VALIGN="TOP"> 
      <P align="center"><font><b>X</b></font></P>
    </TD>
  </TR>
</TABLE>

<P>&nbsp;</P>
<P><I><B>Таблица 11.7. </B>Действие настроек аудита при установленном флажке <B>Применять 
  этот аудит к объектам и контейнерам </b></i><I><B></B></I>только внутри этого 
  контейнера</P>
<I><B></B></I> 
<TABLE BORDER CELLSPACING=1 CELLPADDING=2>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Значения в поле <I>Применять</i></P>
      </font></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит текущей папки</font></P>
      </font></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит дочерних . папок текущей папки</font></P>
      </font></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит файлов в текущей папке</font></P>
      </font></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит всех дочерних папок</font></P>
      </font></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P><font size="2">Выполняется аудит файлов во всех дочерних папках</font></P>
      </font></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Только для этой папки</P>
      <P>(This folder only)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> 
      <P></P>
    </TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Для “той папки, ее подпапок и файлов (The folder, subfolders and files)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Для этой папки и ее подпапок</P>
      <P>(This folder and subfolders)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Для этой папки и ее файлов (This folder and files)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Только для подпапок и файлов</P>
      <P>(Subfolders and files only)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Только для подпапок</P>
      <P>(Subfolders only)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
  <TR> 
    <TD WIDTH="24%" VALIGN="TOP"> <font face=""> 
      <P>Только для файлов (Files only)</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>X</P>
      </FONT></TD>
    <TD WIDTH="15%" VALIGN="TOP"> <font face=""> 
      <P>&nbsp;</P>
      <P>&nbsp; 
      </FONT></TD>
    <TD WIDTH="17%" VALIGN="TOP"> <font face=""> 
      <IDXSKIP><P>&nbsp;</P></IDXSKIP>
      <P>&nbsp; 
      </FONT></TD>
  </TR>
</TABLE>

<IDXSKIP><p>&nbsp;</p></IDXSKIP>
<a NAME="41"></a><font face=""><font size="4">Отключение аудита файлов и папок</font></font> <P>Для отключения аудита файла или папки:</P>
<TABLE>
    <tr VALIGN=TOP> 
      <td WIDTH="15">1.</td>
      
    <td> Установите указатель мыши на файл или папку, где необходимо отключить 
      аудит, и нажмите правую кнопку. В появившемся меню выберите команду <B>Свойства. 
      </B>Появится окно свойств файла или папки. Перейдите на вкладку <B>Безопасность.
<p></P>
</B></td></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">2.</td>
      <td> На вкладке <B>Безопасность </B>нажмите кнопку <B>Дополнительно. </B>В появившемся окне диалога выберите вкладку <B>Аудит.<p></P>
</B></tr>
    <tr VALIGN=TOP> 
      <td WIDTH="15">3.</td>
      <td> В поле <B>Элементы аудита </B>выберите нужную запись и нажмите кнопку <B>Удалить. </B>Соответствующая запись будет удалена.</td>
</tr>
</TABLE>
<IDXSKIP><p>&nbsp;</p></IDXSKIP><table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>Если кнопка <B>Удалить </B>недоступна, это значит, что настройки аудита наследуются от родительской папки.</td></tr>
</table>
<IDXSKIP><p>&nbsp;</p></IDXSKIP>
<p><a NAME="42"></a><font face=""><font size="4">Выполнение заданий по расписанию</font></font> 
</p>
<P>В дополнение к команде at система Windows 2000 располагает новым средством — планировщиком заданий (Task Scheduler). С помощью планировщика заданий можно составить расписание запуска командных файлов, документов, обычных приложений или различных утилит для обслуживания системы. Программы могут запускаться однократно, ежедневно, еженедельно или ежемесячно в заданные дни, при загрузке системы или регистрации в ней, а также при бездействии системы (idle state). Планировщик позволяет задавать достаточно сложное расписание для выполнения заданий, в котором задаются продолжительность задания, время его окончания, количество повторов, зависимость от состояния источника питания (работа от сети или от батарей) и т. п.</P>
<P>Задание сохраняется как файл с расширением job, что позволяет перемещать его с одного компьютера на другой. Администраторы могут создавать файлы заданий для обслуживания систем и переносить их в нужное место. К папке заданий можно обращаться удаленно, кроме того, задания можно пересылать по электронной почте.</P>
<P>Служба планировщика заданий (Task Scheduler Service, MSTask.exe) инсталлируется вместе с системой и автоматически запускается при ее загрузке. При помощи меню <B>Дополнительно </B>(Advanced) планировщика заданий можно приостанавливать или запускать снова эту службу. Данное меню позволяет также обращаться к журналу регистрации запланированных и выполненных заданий.</P>
<P>Среди особенностей планировщика можно отметить:</P>
<table>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Удобный графический пользовательский интерфейс<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Возможность программного доступа ко всем возможностям планировщика, включая страницы свойств<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Создание новых заданий при помощи технологии drag-and-drop или мастера планирования заданий (Scheduled Task wizard)<p></P>
</td></tr>
<tr VALIGN=TOP>
<td WIDTH="15"><img SRC="../k.gif" ALT="" BORDER=0 height=10 width=10></td><td>Средства безопасности    </td></tr>
    </TABLE>
<P>Графический интерфейс планировщика заданий (рис. 11.6) не требует знания ключей и параметров программы (как это нужно для использования команды at), интегрирован в операционную систему и доступен из панели управления (папка <B>Назначенные задания </B>(Scheduled Tasks)). Кроме того, упрощается отладка заданий, поскольку их легко проверить, запустив в любой момент непосредственно из папки заданий (команда <B>Выполнить </B>(Run) в контекстном меню). В главном окне планировщика выводится основная информация о заданиях: расписание, время следующего и предыдущего запуска, состояние, результат выполнения задания, имя создателя задания.</P>
 <table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-6.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.6. </B>Главное окно программы Планировщик заданий (Task Scheduler) со списком запланированных заданий</font> 
        </td>
      </tr>
    </table><P>Мастер планирования заданий (запускаемый при выборе команды <B>Добавить задание </B>(Add Scheduled Task)) позволяет легко и быстро в интерактивном режиме указать все параметры для запуска запланированного задания. Задания могут иметь несколько расписаний, принципиально отличающихся друг от друга. Например, некоторая программа может запускаться ежедневно в одно время, еженедельно — в другое время и однократно — в заданное время указанного дня. На рис. 11.7 приведен пример расписания для запуска программы NetMeeting, запускающейся по рабочим дням, 3 раза в день; Установив флажок <B>Показывать несколько расписаний </B>(Show multiple schedules), можно задавать несколько расписаний для запуска этой программы.</P>
<P>Благодаря наличию полного набора интерфейсов API (планировщик задач' позволяет использовать все достоинства моделей СОМ и DCOM) разработчики могут встраивать службы планирования заданий в свои приложения, не заботясь об поддержке и надежности этих служб. Возможность доступа к страницам свойств (рис. 11.7) позволяет создавать в приложениях специфические диалоговые окна, а затем вызывать стандартные страницы планировщика.</P>
<P>В среде Windows 2000 запланированные задания создаются и выполняются с учетом стандартных разрешений системы безопасности. На файлы заданий распространяются правила использования списков управления доступом (ACL) файловой системы NTFS, определяющие круг лиц, которым разрешено просматривать, удалять, модифицировать и выполнять задания (обратите внимание на вкладку Безопасность (Security), рис. 11.7),</P>
<table>
<tr><td> </td><td><B><U><font color=000099><P>Примечание</font></u></B></td></tr><tr><td> </td><td>При перемещении файла *.job в другую систему необходимо восстановить разрешения на его использование, поскольку эти полномочия хранятся в системе безопасности Windows.</td></tr>
</table>
<P>При создании задания требуется указывать имя и пароль пользователя, определяющие контекст безопасности, в котором выполняется задание. Это позволяет запускать на одном компьютере несколько заданий с различными правами в отношении безопасности, т. е. несколько пользователей могут одновременно иметь индивидуальные, независимые расписания запланированных заданий.</P>
 <table>
      <tr VALIGN=BOTTOM> 
        <td><img SRC="11-7.jpg" ALT="" BORDER=0></td>
      </tr>
      <tr> 
        <td><font size="3"><b> Рис. 11.7. </B>Вкладка <B>Расписание </B>(Schedule) для запланированного запуска программы NetMeeting</font> 
        </td>
      </tr>
    </table>
</BODY>
</HTML>

