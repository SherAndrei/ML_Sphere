axforum.info/forums/showthread.php?t=22058
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru">
<head  profile="http://a9.com/-/spec/opensearch/1.1/">
<link rel="search" type="application/opensearchdescription+xml" href="/axforum.info.xml" title="AXForum.info"/>
<link rel="search" type="application/opensearchdescription+xml" href="/axforum.info.google.xml" title="AXForum.info.Google"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="vBulletin 3.8.5" />

<meta name="keywords" content=" Копирование в Excel, Dynamics 365 AX Axapta Аксапта Microsoft CRM ERP MRP" />
<meta name="description" content=" Копирование в Excel DAX:&nbsp;Программирование" />

<!-- CSS Stylesheet -->
<style type="text/css" id="vbulletin_css">
/**
* vBulletin 3.8.5 CSS
* Style: 'Default 2017'; Style ID: 16
*/
@import url("/forums/clientscript/vbulletin_css/style-2bbdc190-00016.css");
</style>
<link rel="stylesheet" type="text/css" href="/forums/clientscript/vbulletin_important.css?v=385" />


<!-- / CSS Stylesheet -->

<script type="text/javascript" src="/forums/clientscript/yui/yahoo-dom-event/yahoo-dom-event.js?v=385"></script>
<script type="text/javascript" src="/forums/clientscript/yui/connection/connection-min.js?v=385"></script>
<script type="text/javascript">
<!--
var SESSIONURL = "s=5cd6bd225f7fa707c1fa499383fda4ba&";
var SECURITYTOKEN = "guest";
var IMGDIR_MISC = "http://img.axforum.info/misc";
var vb_disable_ajax = parseInt("0", 10);
// -->
</script>
<script type="text/javascript" src="/forums/clientscript/vbulletin_global.js?v=385"></script>



	<link rel="alternate" type="application/rss+xml" title="AXForum RSS Feed" href="/forums/external.php?type=RSS2" />
	
		<link rel="alternate" type="application/rss+xml" title="AXForum - DAX:&nbsp;Программирование - RSS Feed" href="/forums/external.php?type=RSS2&amp;forumids=31" />
	

<link rel="Shortcut Icon" href="/favicon.ico" type="image/x-icon" />
	<title> Копирование в Excel - DAX:&nbsp;Программирование - AXForum</title>
	<script type="text/javascript" src="clientscript/vbulletin_post_loader.js?v=385"></script>
	<style type="text/css" id="vbulletin_showthread_css">
	<!--
	
	#links div { white-space: nowrap; }
	#links img { vertical-align: middle; }
	-->
	</style>
</head>
<body onload="">
<!-- logo -->
<a name="top"></a>
<div id="axforum_header" style="max-width:100%; max-height:90px; min-height:60px; background: url(http://img.axforum.info/misc/axforum-logo-02.gif) repeat-x; margin-bottom:10px;">
<div class="hide-w4" style="float: right; width:728px; height:90px;">
<!-- TOP Banner begin -->

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- top adapt -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6789043741886825"
     data-ad-slot="9538868638"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- TOP Banner end -->
</div>
<a href="/?s=5cd6bd225f7fa707c1fa499383fda4ba"><img src="http://img.axforum.info/misc/axforum-logo-01.gif" alt="AXForum" border="0" style="max-width:100%;" /></a>
<!-- Rating@Mail.ru counter -->
<script type="text/javascript">
var _tmr = window._tmr || (window._tmr = []);
_tmr.push({id: "274305", type: "pageView", start: (new Date()).getTime()});
(function (d, w, id) {
  if (d.getElementById(id)) return;
  var ts = d.createElement("script"); ts.type = "text/javascript"; ts.async = true; ts.id = id;
  ts.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//top-fwz1.mail.ru/js/code.js";
  var f = function () {var s = d.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ts, s);};
  if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); }
})(document, window, "topmailru-code");
</script><noscript><div>
<img src="//top-fwz1.mail.ru/counter?id=274305;js=na" style="border:0;position:absolute;left:-9999px;" alt="" />
</div></noscript>
<!-- //Rating@Mail.ru counter -->
<!--LiveInternet counter--><script language="JavaScript"><!--
document.write('<img src="http://counter.yadro.ru/hit?r'+
escape(document.referrer)+((typeof(screen)=='undefined')?'':
';s'+screen.width+'*'+screen.height+'*'+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+';u'+escape(document.URL)+
';'+Math.random()+
'" width=1 height=1 alt="">')//--></script><!--/LiveInternet-->
&nbsp;
</div>
<!-- /logo -->

<!-- content table -->
<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">





<!-- breadcrumb, login, pm info -->
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
	<td class="hide-w1" style="background-color: #F0FAFF; background-position: right top; background-repeat: no-repeat; background-image: none;" width="100%">
		
			<table cellpadding="0" cellspacing="0" border="0">
			<tr valign="bottom">
				<IDXSKIP><td><a href="#" onclick="history.back(1); return false;"><img src="http://img.axforum.info/misc/navbits_start.gif" alt="Вернуться" border="0" /></a></td></IDXSKIP>
				<IDXSKIP><td>&nbsp;</td></IDXSKIP>
				<td width="100%"><span class="navbar"><a href="index.php?s=5cd6bd225f7fa707c1fa499383fda4ba" accesskey="1">AXForum</a></span> 
	<span class="navbar">&gt; <a href="forumdisplay.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;f=40">Microsoft Dynamics AX</a></span>


	<span class="navbar">&gt; <a href="forumdisplay.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;f=31">DAX:&nbsp;Программирование</a></span>

</td>
			</tr>
			<tr>
				<td class="navbar" style="padding-top:1px" colspan="3"><a href="/forums/showthread.php?t=22058"><img class="inlineimg" src="http://img.axforum.info/misc/navbits_finallink_ltr.gif" alt="Обновить" border="0" /></a> <strong>
	 Копирование в Excel

</strong></td>
			</tr>
			</table>
		
	</td>
<td class="smallfont hide-w1" align="center" valign="center" nowrap="nowrap" style="background-color: #F0FAFF;">
<div><a href="http://dax.axforum.info/?s=5cd6bd225f7fa707c1fa499383fda4ba">DAX</a></div>
<div><a href="http://crm.axforum.info/?s=5cd6bd225f7fa707c1fa499383fda4ba">CRM</a></div>
<div><a href="http://nav.axforum.info/?s=5cd6bd225f7fa707c1fa499383fda4ba">NAV</a></div>
<div>All</div>
</td>

	<td class="alt2" nowrap="nowrap" style="padding:0px">
		<!-- login form -->
		<form action="/forums/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
		<script type="text/javascript" src="/forums/clientscript/vbulletin_md5.js?v=385"></script>
		<table cellpadding="0" cellspacing="3" border="0">
		<tr>
			<td class="smallfont" style="white-space: nowrap;"><label for="navbar_username">Имя</label></td>
			<td><input type="text" class="bginput" style="font-size: 11px" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="Имя" onfocus="if (this.value == 'Имя') this.value = '';" /></td>
			<td class="smallfont" nowrap="nowrap"><label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" tabindex="103" id="cb_cookieuser_navbar" accesskey="c" />Запомнить?</label></td>
		</tr>
		<tr>
			<td class="smallfont"><label for="navbar_password">Пароль</label></td>
			<td><input type="password" class="bginput" style="font-size: 11px" name="vb_login_password" id="navbar_password" size="10" tabindex="102" /></td>
			<td><input type="submit" class="button" value="Вход" tabindex="104" title="Введите ваше имя пользователя и пароль, чтобы войти, или нажмите кнопку 'Регистрация', чтобы зарегистрироваться." accesskey="s" /></td>
		</tr>
		<tr>
		<td></td>
		<td colspan="2"><a class="smallfont" href="/forums/login.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=lostpw">Забыли пароль?</a></td>
		</tr>
		</table>
		<input type="hidden" name="s" value="5cd6bd225f7fa707c1fa499383fda4ba" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" name="do" value="login" />
		<input type="hidden" name="vb_login_md5password" />
		<input type="hidden" name="vb_login_md5password_utf" />
		</form>
		<!-- / login form -->
	</td>

</tr>
</table>
<!-- / breadcrumb, login, pm info -->

<!-- nav buttons bar -->
<noindex>
	<table class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="border-top-width:0px">
	<tr align="center">
		
		
			<td class="vbmenu_control"><a href="/forums/register.php?s=5cd6bd225f7fa707c1fa499383fda4ba" rel="nofollow" accesskey="1"><font color="red">Зарегистрироваться</font></a></td>
		
		
		<td class="vbmenu_control hide-w3"><a rel="help" href="/rules/?s=5cd6bd225f7fa707c1fa499383fda4ba" accesskey="2">Правила</a></td>
		<td class="vbmenu_control hide-w3"><a href="/forums/faq.php?s=5cd6bd225f7fa707c1fa499383fda4ba" accesskey="3">Справка</a></td>
		
			
				<td class="vbmenu_control hide-w2"><a href="/forums/memberlist.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;order=DESC&amp;sort=reputation"  accesskey="4">Пользователи</a></td>
			
			
		
		
		
			
				
				<td class="vbmenu_control"><a href="/forums/search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=getdaily" accesskey="6">Сообщения за день</a></td>
				
				<td class="vbmenu_control"><a href="/forums/search.php?s=5cd6bd225f7fa707c1fa499383fda4ba" accesskey="7">Поиск</a></td>
			
			<td class="vbmenu_control"><a href="/forums/forumdisplay.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=markread&amp;markreadhash=guest" rel="nofollow">Все разделы прочитаны</a></td>
			
		
		
		
		</tr>
	</table>
</noindex>
<!-- / nav buttons bar -->

<br />















<a name="poststop" id="poststop"></a>

<!-- controls above postbits -->
<IDXSKIP><table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-bottom:3px">
<tr valign="bottom">
	
		<td class="smallfont">&nbsp;</td>
	
	
</tr>
</table></IDXSKIP>
<!-- / controls above postbits -->

<!-- toolbar -->
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center" style="border-bottom-width:0px">
<tr>
	<IDXSKIP><td class="tcat" width="100%">
		<div class="smallfont">
		
		&nbsp;
		</div>
	</td></IDXSKIP>
	<IDXSKIP><td class="vbmenu_control" id="threadtools" nowrap="nowrap">
		<a href="#goto_threadtools">Опции темы</a>
		
	</td></IDXSKIP>
	
		<IDXSKIP><td class="vbmenu_control hide-w1" id="threadsearch" nowrap="nowrap">
			<a href="#goto_threadsearch">Поиск в этой теме</a>
			
		</td></IDXSKIP>
	
	
	
	
	<IDXSKIP><td class="vbmenu_control hide-w1" id="displaymodes" nowrap="nowrap">
		<a href="#goto_displaymodes">Опции просмотра</a>
		
	</td></IDXSKIP>
	

	

</tr>
</table>
<!-- / toolbar -->



<!-- end content table -->

		</div>
	</div>
</div>

<!-- / close content container -->
<!-- / end content table -->





<div id="posts"><!-- post #159705 -->

	<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">

	<div id="edit159705" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post159705" class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="table-layout: fixed">
<tr>
	
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-right: 0px; width: 15em;" >
			<!-- status icon and date -->
			<a name="post159705"><img class="inlineimg" src="http://img.axforum.info/statusicon/post_old.gif" alt="Старый" border="0" /></a>
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159705#post159705" target="new">13.02.2008, 11:15</a>
			
			<!-- / status icon and date -->
		</td>
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-left: 0px" align="right">
			
			&nbsp;
			
			#<a href="showpost.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159705&amp;postcount=1" target="new" rel="nofollow" id="postcount159705" name="1"><strong>1</strong></a>
			&nbsp;
			
			
		</td>
	
</tr>
<tr valign="top">
	<td class="alt2" style="border: 1px solid #C2DBF2; border-top: 0px; border-bottom: 0px; width: 15em;" rowspan="2">

			<div id="postmenu_159705">
			<div style="float:right"><img class="inlineimg" src="http://img.axforum.info/statusicon/user_offline.gif" alt="Михаил Петрович is offline" border="0" />

</div>
				
				<a class="bigusername" href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=9328">Михаил Петрович</a>
				<script type="text/javascript"> vbmenu_register("postmenu_159705", true); </script>
				
			</div>

			<IDXSKIP><div class="smallfont">Участник</div></IDXSKIP>
		<table class="hide-w1" cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
			<tr><td align="left" valign="top">
			
			</td>
			<td align="right" valign="bottom">
			
			
			</td>
			</tr>
		</table>

			<div class="smallfont hide-w1">
				&nbsp;<br /><div><span title="Сообщения"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=9328" rel="nofollow">20</a></span>
				
					<span title="Репутация">/ <a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=9328&amp;tab=rep_received">10</a></span> 
					(<span title="Вес репутации 1" id="reppower_159705_9328">1</span>)
					<span id="repdisplay_159705_9328" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения."><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_pos.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /></span>
				
				</div>
				<div>Регистрация: 21.03.2007</div>
				
				
				
				
				
				<div>    </div>
			</div>

	</td>
	
	<td class="alt1" id="td_post_159705" style="border-right: 1px solid #C2DBF2">
	
		
		
			<!-- icon and title -->
			
			<strong>Копирование в Excel</strong>
			<hr size="1" style="color:#C2DBF2; background-color:#C2DBF2" />
			<!-- / icon and title -->
		

		<!-- message -->
		<div id="post_message_159705">
			
			Здравия,<br />
 <br />
    Подскажите как реализовать следующее:<br />
Есть заготовка типа шаблона по разметке вкладыша в экселе на листе2. На первый лист аксаптой sysExcelWorksheet'ом закидываются требуемые значения в уже отформатированную область. Как скопировать с листа 2 требуемое оформление на первый со сдвигом для отображения 2-го, 3-го... n-го вкладыша?<br />
    То есть сдвиг сам - не проблема. Как выдернуть оформление?<br />
 <br />
 <br />
Заранее спасибо
		</div>
		<!-- / message -->

		

		
		

		

		

		

	</td>
</tr>
<tr>
	
	<td class="alt1" valign="bottom" align="right" style="border: 1px solid #C2DBF2; border-left: 0px; border-top: 0px">
	
<div class="smallfont">
		<!-- controls -->

		
		
		
		
		
		
		
		
		
		
			
		
		
		<!-- / controls -->
</div>
	</td>
</tr>

</table>


<!-- post 159705 popup menu -->
<div class="vbmenu_popup" id="postmenu_159705_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" border="0">
	<tr>
		<td class="thead">Михаил Петрович</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=9328">Посмотреть профиль</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="private.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=newpm&amp;u=9328" rel="nofollow">Отправить личное сообщение для Михаил Петрович</a></td></tr>
	
	
	
	
		<tr><td class="vbmenu_option"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=9328" rel="nofollow">Найти ещё сообщения от Михаил Петрович</a></td></tr>
	
	
	
	</table>
</div>
<!-- / post 159705 popup menu -->


	</div>
	
		</div>
	</div>
</div>

<!-- / close content container -->

<!-- / post #159705 --><!-- post #159717 -->

	<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">

	<div id="edit159717" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post159717" class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="table-layout: fixed">
<tr>
	
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-right: 0px; width: 15em;" >
			<!-- status icon and date -->
			<a name="post159717"><img class="inlineimg" src="http://img.axforum.info/statusicon/post_old.gif" alt="Старый" border="0" /></a>
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159717#post159717" target="new">13.02.2008, 12:00</a>
			
			<!-- / status icon and date -->
		</td>
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-left: 0px" align="right">
			
			&nbsp;
			
			#<a href="showpost.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159717&amp;postcount=2" target="new" rel="nofollow" id="postcount159717" name="2"><strong>2</strong></a>
			&nbsp;
			
			
		</td>
	
</tr>
<tr valign="top">
	<td class="alt2" style="border: 1px solid #C2DBF2; border-top: 0px; border-bottom: 0px; width: 15em;" rowspan="2">

			<div id="postmenu_159717">
			<div style="float:right"><img class="inlineimg" src="http://img.axforum.info/statusicon/user_offline.gif" alt="Raven Melancholic is offline" border="0" />

</div>
				
				<a class="bigusername" href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=4154">Raven Melancholic</a>
				<script type="text/javascript"> vbmenu_register("postmenu_159717", true); </script>
				
			</div>

			<IDXSKIP><div class="smallfont">Участник</div></IDXSKIP>
		<table class="hide-w1" cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
			<tr><td align="left" valign="top">
			
				<div class="smallfont">
					<a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=4154"><img src="customavatars/avatar4154_3.gif" width="100" height="83" alt="Аватар для Raven Melancholic" border="0" /></a>
				</div>
			
			</td>
			<td align="right" valign="bottom">
			<div class="smallfont"><a href="http://axforum.info/forums/showthread.php?t=30638" target="_blank"><img src="http://img.axforum.info/ranks/sam-ax.jpg" alt="Самостоятельные клиенты AX" border="0" width="41" height="22"></a></div>
			
			</td>
			</tr>
		</table>

			<div class="smallfont hide-w1">
				<IDXSKIP>&nbsp;<br /></IDXSKIP><div><span title="Сообщения"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=4154" rel="nofollow">1,657</a></span>
				
					<span title="Репутация">/ <a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=4154&amp;tab=rep_received">809</a></span> 
					(<span title="Вес репутации 30" id="reppower_159717_4154">30</span>)
					<span id="repdisplay_159717_4154" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения."><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_pos.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /></span>
				
				</div>
				<div>Регистрация: 21.03.2005</div>
				<div>Адрес: Москва-Петушки</div>
				
				
				
				
				<div>    </div>
			</div>

	</td>
	
	<td class="alt1" id="td_post_159717" style="border-right: 1px solid #C2DBF2">
	
		
		

		<!-- message -->
		<div id="post_message_159717">
			
			Что-то вроде этого:<br />
<br />
<div class="xpp"><IDXSKIP><div class="smallfont xpp_title">X++:</div></IDXSKIP><pre class="alt2 xpp_code">#define.xlPasteFormats(-4122)
<span style="color: blue">private</span> <IDXSKIP><span style="color: blue">void</span></IDXSKIP> copyLineFormat(SysExcelWorksheet _workSheet, <span style="color: blue">int</span> _fromRow, <span style="color: blue">int</span> _toRow)
{
    Com     rangeFrom, rangeTo;
    <IDXSKIP><span style="color: blue">str</span></IDXSKIP>     strRangeFrom, strRangeTo;

    strRangeFrom    = ComExcelDocument_RU::numToNameCell(#colItemId, _fromRow) + <span style="color: red">&quot;:&quot;</span> + ComExcelDocument_RU::numToNameCell(endCol, _fromRow);
    strRangeTo      = ComExcelDocument_RU::numToNameCell(#colItemId, _toRow) + <span style="color: red">&quot;:&quot;</span> + ComExcelDocument_RU::numToNameCell(endCol, _toRow);

    rangeFrom   = _workSheet.cells().range(strRangeFrom).comObject();
    rangeTo     = _workSheet.cells().range(strRangeTo).comObject();

    rangeFrom.Copy();
    rangeTo.PasteSpecial(#xlPasteFormats);

    rangeFrom.finalize();
    rangeTo.finalize();

}</pre></div>Но это для одного и того же листа, далее доработать несложно. Только следует знать, как минимум две вещи:<br />
1) Механизм тормозной;<br />
2) В момент формирования отчета пользователь не может использовать накаким образом буфер обмена для других задач
		</div>
		<!-- / message -->

		

		
		

		

		

		

	</td>
</tr>
<tr>
	
	<td class="alt1" valign="bottom" align="right" style="border: 1px solid #C2DBF2; border-left: 0px; border-top: 0px">
	
<div class="smallfont">
		<!-- controls -->

		
		
		
		
		
		
		
		
		
		
			
		
		
		<!-- / controls -->
</div>
	</td>
</tr>

</table>


<!-- post 159717 popup menu -->
<div class="vbmenu_popup" id="postmenu_159717_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" border="0">
	<tr>
		<td class="thead">Raven Melancholic</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=4154">Посмотреть профиль</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="private.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=newpm&amp;u=4154" rel="nofollow">Отправить личное сообщение для Raven Melancholic</a></td></tr>
	
	
	
	
		<tr><td class="vbmenu_option"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=4154" rel="nofollow">Найти ещё сообщения от Raven Melancholic</a></td></tr>
	
	
	
	</table>
</div>
<!-- / post 159717 popup menu -->


	</div>
	
		</div>
	</div>
</div>

<!-- / close content container -->

<!-- / post #159717 --><!-- post #159792 -->

	<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">

	<div id="edit159792" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post159792" class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="table-layout: fixed">
<tr>
	
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-right: 0px; width: 15em;" >
			<!-- status icon and date -->
			<a name="post159792"><img class="inlineimg" src="http://img.axforum.info/statusicon/post_old.gif" alt="Старый" border="0" /></a>
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159792#post159792" target="new">13.02.2008, 18:19</a>
			
			<!-- / status icon and date -->
		</td>
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-left: 0px" align="right">
			
			&nbsp;
			
			#<a href="showpost.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159792&amp;postcount=3" target="new" rel="nofollow" id="postcount159792" name="3"><strong>3</strong></a>
			&nbsp;
			
			
		</td>
	
</tr>
<tr valign="top">
	<td class="alt2" style="border: 1px solid #C2DBF2; border-top: 0px; border-bottom: 0px; width: 15em;" rowspan="2">

			<div id="postmenu_159792">
			<div style="float:right"><img class="inlineimg" src="http://img.axforum.info/statusicon/user_offline.gif" alt="Gustav is offline" border="0" />

</div>
				
				<a class="bigusername" href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597"><b>Gustav</b></a>
				<script type="text/javascript"> vbmenu_register("postmenu_159792", true); </script>
				
			</div>

			<IDXSKIP><div class="smallfont">Moderator</div></IDXSKIP>
		<table class="hide-w1" cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
			<tr><td align="left" valign="top">
			
				<div class="smallfont">
					<a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597"><img src="customavatars/avatar5597_5.gif" width="71" height="90" alt="Аватар для Gustav" border="0" /></a>
				</div>
			
			</td>
			<td align="right" valign="bottom">
			<div class="smallfont"><a href="http://axforum.info/forums/showthread.php?t=30312" target="_blank"><img src="http://img.axforum.info/ranks/best2009.png" alt="Лучший по профессии 2009" border="0" width="40" height="21"></a><br /><img src="http://img.axforum.info/ranks/sap.gif" alt="SAP" border="0" width="43" height="21"></div>
			
			</td>
			</tr>
		</table>

			<div class="smallfont hide-w1">
				<IDXSKIP>&nbsp;<br /></IDXSKIP><div><span title="Сообщения"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=5597" rel="nofollow">1,845</a></span>
				
					<span title="Репутация">/ <a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597&amp;tab=rep_received">1144</a></span> 
					(<span title="Вес репутации 42" id="reppower_159792_5597">42</span>)
					<span id="repdisplay_159792_5597" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения."><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_pos.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /></span>
				
				</div>
				<div>Регистрация: 24.01.2006</div>
				<IDXSKIP><div>Адрес: Санкт-Петербург</div></IDXSKIP>
				
				
				
				
				<div>    </div>
			</div>

	</td>
	
	<td class="alt1" id="td_post_159792" style="border-right: 1px solid #C2DBF2">
	
		
		

		<!-- message -->
		<div id="post_message_159792">
			
			<b>Михаил Петрович</b>, не очень понимаю, зачем нужен лист2, если на лист1 уже присутствует сформатированная область.<br />
<br />
Выведите в нее данные для вкладыша 1. Ниже нее друг за другом выведите в неформатированном виде данные вкладышей 2...N. Далее скопируйте формат области 1 на диапазон областей 2...N. Т.е. в самом конце процесса будет нужна будет всего одна (!) операция копирования формата &quot;маленькой&quot; области на &quot;большую&quot; (кратную &quot;маленькой&quot; N-1 раз). <br />
<br />
Как выполнить операцию копирования - уже рассказал <b>Raven Melancholic</b>.<br />
<br />
P.S. ВАЖНО: при копировании следует выделять не просто область 1, а полные строки, проходящие через область 1. Соответственно вставку следует производить в полные строки, проходящие через области 2...N. В этом случае высоты строк вкладыша корректно воспроизведутся и на нижних областях. В противном случае - распространятся только шрифты, заливки, рамки и т.п.
		</div>
		<!-- / message -->

		

		
		

		

		

		

	</td>
</tr>
<tr>
	
	<td class="alt1" valign="bottom" align="right" style="border: 1px solid #C2DBF2; border-left: 0px; border-top: 0px">
	
<div class="smallfont">
		<!-- controls -->

		
		
		
		
		
		
		
		
		
		
			
		
		
		<!-- / controls -->
</div>
	</td>
</tr>

</table>


<!-- post 159792 popup menu -->
<div class="vbmenu_popup" id="postmenu_159792_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" border="0">
	<tr>
		<td class="thead">Gustav</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597">Посмотреть профиль</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="private.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=newpm&amp;u=5597" rel="nofollow">Отправить личное сообщение для Gustav</a></td></tr>
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.axforum.info/forums/showthread.php?t=22268">Посетить домашнюю страницу Gustav</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=5597" rel="nofollow">Найти ещё сообщения от Gustav</a></td></tr>
	
	
	
	</table>
</div>
<!-- / post 159792 popup menu -->


	</div>
	
		</div>
	</div>
</div>

<!-- / close content container -->

<!-- / post #159792 --><!-- post #159996 -->

	<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">

	<div id="edit159996" style="padding:0px 0px 6px 0px">
	<!-- this is not the last post shown on the page -->



<table id="post159996" class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="table-layout: fixed">
<tr>
	
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-right: 0px; width: 15em;" >
			<!-- status icon and date -->
			<a name="post159996"><img class="inlineimg" src="http://img.axforum.info/statusicon/post_old.gif" alt="Старый" border="0" /></a>
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159996#post159996" target="new">15.02.2008, 14:34</a>
			
			<!-- / status icon and date -->
		</td>
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-left: 0px" align="right">
			
			&nbsp;
			
			#<a href="showpost.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159996&amp;postcount=4" target="new" rel="nofollow" id="postcount159996" name="4"><strong>4</strong></a>
			&nbsp;
			
			
		</td>
	
</tr>
<tr valign="top">
	<td class="alt2" style="border: 1px solid #C2DBF2; border-top: 0px; border-bottom: 0px; width: 15em;" rowspan="2">

			<div id="postmenu_159996">
			<div style="float:right"><img class="inlineimg" src="http://img.axforum.info/statusicon/user_offline.gif" alt="Владимир Максимов is offline" border="0" />

</div>
				
				<a class="bigusername" href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=2539">Владимир Максимов</a>
				<script type="text/javascript"> vbmenu_register("postmenu_159996", true); </script>
				
			</div>

			<IDXSKIP><div class="smallfont">Участник</div></IDXSKIP>
		<table class="hide-w1" cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
			<tr><td align="left" valign="top">
			
			</td>
			<td align="right" valign="bottom">
			<div class="smallfont"><a href="http://ms.korusconsulting.ru/"><img src="http://img.axforum.info/ranks/korusconsulting.gif" alt="КОРУС Консалтинг" border="0" width="21" height="21"></a></div>
			
			</td>
			</tr>
		</table>

			<div class="smallfont hide-w1">
				&nbsp;<br /><div><span title="Сообщения"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=2539" rel="nofollow">1,330</a></span>
				
					<span title="Репутация">/ <a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=2539&amp;tab=rep_received">811</a></span> 
					(<span title="Вес репутации 30" id="reppower_159996_2539">30</span>)
					<span id="repdisplay_159996_2539" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения."><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos2.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_pos.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /></span>
				
				</div>
				<div>Регистрация: 13.01.2004</div>
				
				
				
				
				
				<div>    </div>
			</div>

	</td>
	
	<td class="alt1" id="td_post_159996" style="border-right: 1px solid #C2DBF2">
	
		
		

		<!-- message -->
		<div id="post_message_159996">
			
			Вариант решения подобных задач сильно облегчающий жизнь разработчика:<br />
<br />
В файле шаблона Excel делаются прямые ссылки на другой лист. Т.е. напрямую в ячейках второго листа пишется нечто вроде: Лист1!A1<br />
<br />
Сами же данные забрасываются на первый лист. Либо в специальные ячейки, либо, сплошным списком.<br />
<br />
Если заброс данных идет сплошным списоком, то адресация на втором листе делается не к конкретной ячейке, а при помощи поисковых функций самого Excel. Например:<br />
<br />
=ЕСЛИ(ЕНД(ВПР($B27;Отгрузка!$A:$N;3;ЛОЖЬ));0;ВПР($B27;Отгрузка!$A:$N;3;ЛОЖЬ))<br />
<br />
Здесь ищется значение на листе с именем &quot;Отгрузка&quot; при помощи функции ВПР() по ключу из столбца &quot;B&quot;. Функция ЕСЛИ(ЕНД(),0,ВПР()) нужна для того, чтобы подавить вывод значения #Н/Д, если по указанному ключу ничего не найдено.<br />
<br />
Разумеется сам шаблон Excel получается значительно бОльшего размера (в байтах), его сложнее модифицировать и несколько больше времени тратится на его открытие (идет обновление связей при открытии). Однако имеем следующие преимущества:<br />
<ol style="list-style-type: decimal"><li>Вся логика форматирования отчета (что и где расположить) целиком находится в файле Excel. Одно место для внесения модификаций. Причем это можно доверить самим пользователям.<br /></li>
<li>Подготовка данных и их выгрузка в Excel существенно облегчается. На порядки! Код формирования такого отчета в Axapta становится &quot;прозрачным&quot; и легко модифицируемым.<br /></li>
<li>Пользователи могут видеть исходные данные, из которых получается результирующий отчет и, если необходимо, делать дополнительный анализ. Например, почему некие данные не отобразились в результате или отобразились не те данные. Упрощается &quot;разбор полетов&quot;.</li>
</ol>
		</div>
		<!-- / message -->

		

		
		

		

		

		

	</td>
</tr>
<tr>
	
	<td class="alt1" valign="bottom" align="right" style="border: 1px solid #C2DBF2; border-left: 0px; border-top: 0px">
	
<div class="smallfont">
		<!-- controls -->

		
		
		
		
		
		
		
		
		
		
			
		
		
		<!-- / controls -->
</div>
	</td>
</tr>

</table>


<!-- post 159996 popup menu -->
<div class="vbmenu_popup" id="postmenu_159996_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" border="0">
	<tr>
		<td class="thead">Владимир Максимов</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=2539">Посмотреть профиль</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="private.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=newpm&amp;u=2539" rel="nofollow">Отправить личное сообщение для Владимир Максимов</a></td></tr>
	
	
	
	
		<tr><td class="vbmenu_option"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=2539" rel="nofollow">Найти ещё сообщения от Владимир Максимов</a></td></tr>
	
	
	
	</table>
</div>
<!-- / post 159996 popup menu -->


	</div>
	
		</div>
	</div>
</div>

<!-- / close content container -->

<!-- / post #159996 --><!-- post #160013 -->

	<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">

	<div id="edit160013" style="padding:0px 0px 6px 0px">
	



<table id="post160013" class="tborder" cellpadding="6" cellspacing="0" border="0" width="100%" align="center" style="table-layout: fixed">
<tr>
	
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-right: 0px; width: 15em;" >
			<!-- status icon and date -->
			<a name="post160013"><img class="inlineimg" src="http://img.axforum.info/statusicon/post_old.gif" alt="Старый" border="0" /></a>
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=160013#post160013" target="new">15.02.2008, 15:35</a>
			
			<!-- / status icon and date -->
		</td>
		<td class="thead smallfont sf" style="font-weight:normal; border: 1px solid #C2DBF2; border-left: 0px" align="right">
			
			&nbsp;
			
			#<a href="showpost.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=160013&amp;postcount=5" target="new" rel="nofollow" id="postcount160013" name="5"><strong>5</strong></a>
			&nbsp;
			
			
		</td>
	
</tr>
<tr valign="top">
	<td class="alt2" style="border: 1px solid #C2DBF2; border-top: 0px; border-bottom: 0px; width: 15em;" rowspan="2">

			<div id="postmenu_160013">
			<div style="float:right"><img class="inlineimg" src="http://img.axforum.info/statusicon/user_offline.gif" alt="Gustav is offline" border="0" />

</div>
				
				<a class="bigusername" href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597"><b>Gustav</b></a>
				<script type="text/javascript"> vbmenu_register("postmenu_160013", true); </script>
				
			</div>

			<div class="smallfont">Moderator</div>
		<table class="hide-w1" cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
			<tr><td align="left" valign="top">
			
				<div class="smallfont">
					<a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597"><img src="customavatars/avatar5597_5.gif" width="71" height="90" alt="Аватар для Gustav" border="0" /></a>
				</div>
			
			</td>
			<td align="right" valign="bottom">
			<div class="smallfont"><a href="http://axforum.info/forums/showthread.php?t=30312" target="_blank"><img src="http://img.axforum.info/ranks/best2009.png" alt="Лучший по профессии 2009" border="0" width="40" height="21"></a><br /><img src="http://img.axforum.info/ranks/sap.gif" alt="SAP" border="0" width="43" height="21"></div>
			
			</td>
			</tr>
		</table>

			<div class="smallfont hide-w1">
				<IDXSKIP>&nbsp;<br /></IDXSKIP><div><span title="Сообщения"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=5597" rel="nofollow">1,845</a></span>
				
					<span title="Репутация">/ <a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597&amp;tab=rep_received">1144</a></span> 
					(<span title="Вес репутации 42" id="reppower_160013_5597">42</span>)
					<span id="repdisplay_160013_5597" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения."><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_highpos3.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /><img class="inlineimg" src="http://img.axforum.info/reputation/reputation_pos.gif" alt="+" title="Эта ссылка позволяет сказать 'Мне нравится' автору сообщения." border="0" /></span>
				
				</div>
				<div>Регистрация: 24.01.2006</div>
				<div>Адрес: Санкт-Петербург</div>
				
				
				
				
				<div>    </div>
			</div>

	</td>
	
	<td class="alt1" id="td_post_160013" style="border-right: 1px solid #C2DBF2">
	
		
		

		<!-- message -->
		<div id="post_message_160013">
			
			Владимир, от души поддерживаю! <img src="/forums/images/smilies/smile.gif" border="0" alt="" title="Smile" class="inlineimg" /><br />
<div class="q">
	<IDXSKIP><div class="smallfont q_title">Цитата:</div></IDXSKIP>
	<div class="alt2 q_body">
		
			Сообщение от <strong>Gustav</strong>
			<a href="/forums/showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=143125#post143125" rel="nofollow"><img class="inlineimg" src="http://img.axforum.info/buttons/viewpost.gif" border="0" alt="Посмотреть сообщение" /></a>
			<div style="font-style:italic">Для развесистых стандартных шаблонов (типа акта ОС-1) теперь тоже использую такой вывод с CopyFromRecordset. В файле шаблона создаю еще один лист, можно скрытый, на который вывожу одну строку с необходимыми данными. А в ячейках самого шаблона прописываю формулы-ссылки на ячейки этой выводимой строки. Подход родился в процессе решения задачи по пакетной печати нескольких тысяч актов ОС-1. Один CopyFromRecordset вместо многих присваиваний Range.Value(...) увеличил скорость процесса примерно в 30 раз (иначе можно было бы тихо загнуться на этой печати).</div>
		
	</div>
</div>Я использую 3 листа:<br />
<br />
- &quot;Бланк&quot; - собственно сформатированный бланк, который подается на печать; в ячейках бланка находятся формулы, ссылающиеся на лист &quot;ТекущаяСтрока&quot; вида: =ТекущаяСтрока!B3.<br />
<br />
- &quot;ВыгруженныеДанные&quot; - много строк, выгруженных из Аксапты при помощи CopyFromRecordset, начиная с ячейки B2 (в первой строке, c B1 - заголовки полей для удобства); с дополнительной колонкой A &quot;Печатать?&quot;, которая по умолчанию заполняется &quot;единичками&quot; (о ней ниже).<br />
<br />
- &quot;ТекущаяСтрока - таблица вида &quot;выгруженных данных&quot;, но только с двумя строками (ну, и с теми же заголовками полей, что и на втором листе).<br />
<br />
В первой из этих двух строк находятся формулы, ссылающиеся на лист &quot;ВыгруженныеДанные&quot; вида (на примере ячейки B2): =ИНДЕКС(ВыгруженныеДанные!B:B, $A$2). В ячейке $A$2 содержится номер строки, которую надо напечатать. Этот номер меняется в цикле несложным макросом.<br />
<br />
Ниже этой строки находится дополнительная строка, каждая ячейка которой ссылается на ячейку выше. Цель: замена 0 пустой строкой в тех случаях, когда отображение 0 на &quot;Бланке&quot; нежелательно. Формула в ячейке B3 такая: =ЕСЛИ(B2=0,&quot;&quot;,B2)<br />
<br />
Выгрузив данные, пользователь сам решает, какие именно строчки ему надо напечатать, выставляя 0 или 1 в колонке &quot;Печатать?&quot;, после чего кнопкой запускает макрос, который бежит по колонке А и печатает бланк для тех строк, у которых в колонке A присутствует 1. <br />
<br />
Листы, кнопка, макрос живут в файле *.xlt и при выгрузке пользователь получает своеобразное мини-АРМ для печати.
		</div>
		<!-- / message -->

		

		
		

		

		

		

	</td>
</tr>
<tr>
	
	<td class="alt1" valign="bottom" align="right" style="border: 1px solid #C2DBF2; border-left: 0px; border-top: 0px">
	
<div class="smallfont">
		<!-- controls -->

		
		
		
		
		
		
		
		
		
		
			
		
		
		<!-- / controls -->
</div>
	</td>
</tr>

</table>


<!-- post 160013 popup menu -->
<div class="vbmenu_popup" id="postmenu_160013_menu" style="display:none">
	<table cellpadding="4" cellspacing="1" border="0">
	<tr>
		<td class="thead">Gustav</td>
	</tr>
	
		<tr><td class="vbmenu_option"><a href="member.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;u=5597">Посмотреть профиль</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="private.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=newpm&amp;u=5597" rel="nofollow">Отправить личное сообщение для Gustav</a></td></tr>
	
	
	
		<tr><td class="vbmenu_option"><a href="http://www.axforum.info/forums/showthread.php?t=22268">Посетить домашнюю страницу Gustav</a></td></tr>
	
	
		<tr><td class="vbmenu_option"><a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=finduser&amp;u=5597" rel="nofollow">Найти ещё сообщения от Gustav</a></td></tr>
	
	
	
	</table>
</div>
<!-- / post 160013 popup menu -->


	</div>
	
		</div>
	</div>
</div>

<!-- / close content container -->

<!-- / post #160013 --><div id="lastpost"></div></div>

<!-- start content table -->
<!-- open content container -->

<div id="axforum_content" align="center">
	<div class="page" style="width:100%; text-align:left">
		<div style="padding:0px 0px 0px 0px" align="left">

<!-- / start content table -->



<!-- controls below postbits -->
<table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-top:-3px">
<tr valign="top">
	
		<IDXSKIP><td>&nbsp;</td></IDXSKIP>
	

<td class="smallfont" align="center">

<!-- next / previous links -->
	<div class="smallfont" align="center">
		<IDXSKIP><strong>&laquo;</strong></IDXSKIP>
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=22058&amp;goto=nextoldest" rel="nofollow">Предыдущая тема</a>
			|
			<a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=22058&amp;goto=nextnewest" rel="nofollow">Следующая тема</a>
		<IDXSKIP><strong>&raquo;</strong></IDXSKIP>
	</div>
	<br />
<!-- / next / previous links -->



</td>

	
</tr>
</table>
<!-- / controls below postbits -->



<div class="hide-w4" align="center">

<!-- Яндекс.Директ -->
<script type="text/javascript">
yandex_partner_id = 168631;
yandex_site_bg_color = 'FFFFFF';
yandex_ad_format = 'direct';
yandex_font_size = 1;
yandex_direct_type = 'horizontal';
yandex_direct_border_type = 'collapse';
yandex_direct_limit = 3;
yandex_direct_title_font_size = 2;
yandex_direct_links_underline = false;
yandex_direct_header_bg_color = 'FEEAC7';
yandex_direct_bg_color = 'FFF9F0';
yandex_direct_border_color = 'FBE5C0';
yandex_direct_title_color = '0000CC';
yandex_direct_url_color = '006600';
yandex_direct_text_color = '000000';
yandex_direct_hover_color = '0066FF';
yandex_direct_sitelinks_color = '0000CC';
yandex_direct_favicon = true;
yandex_no_sitelinks = false;
document.write('<scr'+'ipt type="text/javascript" src="//an.yandex.ru/system/context.js"></scr'+'ipt>');
</script>

</div>

<br />
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<IDXSKIP><thead>
	<tr>
		<td class="tcat" width="100%" colspan="5">
			<a style="float:right" href="#top" onclick="return toggle_collapse('similarthreads')"><img id="collapseimg_similarthreads" src="http://img.axforum.info/buttons/collapse_tcat.gif" alt="" border="0" /></a>
			Похожие темы<a name="similarthreads"></a>
		</td>
	</tr>
</thead></IDXSKIP>
<tbody id="collapseobj_similarthreads" style="">
<tr class="thead" align="center">
	<IDXSKIP><td class="thead" width="75%">Тема</td></IDXSKIP>
	<IDXSKIP><td class="thead hide-w1" nowrap="nowrap">Автор</td></IDXSKIP>
	<IDXSKIP><td class="thead hide-w2" >Раздел</td></IDXSKIP>
	<IDXSKIP><td class="thead" >Ответов</td></IDXSKIP>
	<IDXSKIP><td class="thead hide-w1" nowrap="nowrap">Посл. сообщение</td></IDXSKIP>
</tr>
<tr>
	<td class="alt1" align="left">
		
		 <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=13405" title="">Исследование скорости экспорта данных из Axapta  в Excel (коллективный эксперимент)</a>
	</td>
	<td class="alt2 hide-w1" nowrap="nowrap">Gustav</td>
	<IDXSKIP><td class="alt1 hide-w2" nowrap="nowrap">DAX:&nbsp;База&nbsp;знаний и проекты</td></IDXSKIP>
	<td class="alt2" align="center">79</td>
	<td class="alt1 hide-w1" align="right" nowrap="nowrap">13.02.2014 <span class="time">13:18</span></td>
</tr>
<tr>
	<td class="alt1" align="left">
		
		 <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=25870" title="">Копирование листов в Excel с шаблоном</a>
	</td>
	<td class="alt2 hide-w1" nowrap="nowrap">Zoe</td>
	<td class="alt1 hide-w2" nowrap="nowrap">DAX:&nbsp;Программирование</td>
	<IDXSKIP><td class="alt2" align="center">8</td></IDXSKIP>
	<td class="alt1 hide-w1" align="right" nowrap="nowrap">20.11.2008 <span class="time">15:50</span></td>
</tr>
<tr>
	<td class="alt1" align="left">
		
		 <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=18862" title="">Копирование листов в Excel</a>
	</td>
	<td class="alt2 hide-w1" nowrap="nowrap">Андрей К.</td>
	<td class="alt1 hide-w2" nowrap="nowrap">DAX:&nbsp;База&nbsp;знаний и проекты</td>
	<td class="alt2" align="center">12</td>
	<td class="alt1 hide-w1" align="right" nowrap="nowrap">30.08.2007 <span class="time">08:44</span></td>
</tr>
<tr>
	<td class="alt1" align="left">
		
		 <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=19669" title="">[Excel] - Несколько версий Excel на машине клиента</a>
	</td>
	<td class="alt2 hide-w1" nowrap="nowrap">Андре</td>
	<td class="alt1 hide-w2" nowrap="nowrap">DAX:&nbsp;Программирование</td>
	<td class="alt2" align="center">11</td>
	<td class="alt1 hide-w1" align="right" nowrap="nowrap">07.08.2007 <span class="time">13:45</span></td>
</tr>
<tr>
	<td class="alt1" align="left">
		
		 <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=4737" title="">Копирование из Грида в Excel</a>
	</td>
	<td class="alt2 hide-w1" nowrap="nowrap">ArturK</td>
	<td class="alt1 hide-w2" nowrap="nowrap">DAX:&nbsp;Программирование</td>
	<IDXSKIP><td class="alt2" align="center">5</td></IDXSKIP>
	<td class="alt1 hide-w1" align="right" nowrap="nowrap">09.03.2004 <span class="time">19:55</span></td>
</tr>

</tbody>
</table>

















<!-- controls for non-popup browsers -->


<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center" style="border-top-width:0px">
<IDXSKIP><tr>
	<td class="thead" >Опции темы<a name="goto_threadtools"></a></td>
	<td class="thead">Поиск в этой теме<a name="goto_threadsearch"></a></td>
</tr></IDXSKIP>
<tr valign="top">
	<td class="alt1" >

	<!-- thread tools -->
	<div class="smallfont">
		
			<div><img class="inlineimg" src="http://img.axforum.info/buttons/printer.gif" alt="Версия для печати" vspace="1" /> <a href="printthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;t=22058" rel="nofollow">Версия для печати</a></div>
			<div><img class="inlineimg" src="http://img.axforum.info/buttons/sendtofriend.gif" alt="Отправить по электронной почте" vspace="1" /> <a href="sendmessage.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=sendtofriend&amp;t=22058" rel="nofollow">Отправить по электронной почте</a></div>
		
		
		
	</div>
	<!-- / thread tools -->

	</td>
	
	<td class="alt1">

	<!-- search this thread -->
	<form action="search.php?do=process&amp;searchthreadid=22058" method="post">
	<div class="smallfont">
		<input type="hidden" name="s" value="5cd6bd225f7fa707c1fa499383fda4ba" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" name="do" value="process" />
		<input type="hidden" name="searchthreadid" value="22058" />
		<IDXSKIP><strong>Поиск в этой теме</strong></IDXSKIP><IDXSKIP>:<br /></IDXSKIP>
		<input type="text" class="bginput" name="query" size="20" style="width:15em;" /><input type="submit" class="button" value="Вперёд"  /><br />
		<a href="search.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;searchthreadid=22058">Расширенный поиск</a>
	</div>
	</form>
	<!-- /  search this thread -->

	</td>
	
</tr>

<IDXSKIP><tr>
	<td class="thead" colspan="2">Опции просмотра<a name="goto_displaymodes"></a></td>
	
</tr></IDXSKIP>
<tr valign="top">
	
	<td class="alt2" colspan="2">

	<!-- thread display modes -->

	<div class="smallfont">
		<IDXSKIP><div><img class="inlineimg" src="http://img.axforum.info/buttons/mode_linear.gif" alt="Линейный вид" vspace="1" /> <strong>Линейный вид</strong></div></IDXSKIP>
		<div><img class="inlineimg" src="http://img.axforum.info/buttons/mode_hybrid.gif" alt="Комбинированный вид" vspace="1" /> <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;mode=hybrid&amp;t=22058">Комбинированный вид</a></div>
		<div><img class="inlineimg" src="http://img.axforum.info/buttons/mode_threaded.gif" alt="Древовидный вид" vspace="1" /> <a href="showthread.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;p=159705&amp;mode=threaded#post159705">Древовидный вид</a></div>
	</div>

	<!-- / thread display modes -->

	</td>
	
	
</tr>




</table>
<br />


<!-- / controls for non-popup browsers -->


<!-- forum rules and admin links -->
<table cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
<tr valign="bottom">
	<td width="100%" valign="top">
		<table class="tborder hide-w1" cellpadding="6" cellspacing="1" border="0" width="210">
<IDXSKIP><thead>
<tr>
	<td class="thead">
		<a style="float:right" href="#top" onclick="return toggle_collapse('forumrules')"><img id="collapseimg_forumrules" src="http://img.axforum.info/buttons/collapse_thead.gif" alt="" border="0" /></a>
		Ваши права в разделе
	</td>
</tr>
</thead></IDXSKIP>
<tbody id="collapseobj_forumrules" style="">
<tr>
	<td class="alt1" nowrap="nowrap"><div class="smallfont">
		
		<IDXSKIP><div>Вы <strong>не можете</strong> создавать новые темы</div></IDXSKIP>
		<IDXSKIP><div>Вы <strong>не можете</strong> отвечать в темах</div></IDXSKIP>
		<IDXSKIP><div>Вы <strong>не можете</strong> прикреплять вложения</div></IDXSKIP>
		<div><IDXSKIP>Вы <strong>не можете</strong></IDXSKIP> <IDXSKIP>редактировать свои сообщения</IDXSKIP></div>
		<hr />
		
		<div><a href="misc.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=bbcode" target="_blank">BB коды</a> <strong>Вкл.</strong></div>
		<div><a href="misc.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=showsmilies" target="_blank">Смайлы</a> <strong>Вкл.</strong></div>
		<div><a href="misc.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;do=bbcode#imgcode" target="_blank">[IMG]</a> код <strong>Вкл.</strong></div>
		<IDXSKIP><div>HTML код <strong>Выкл.</strong></div></IDXSKIP>
	</div></td>
</tr>
</tbody>
</table>
	</td>
	<td class="smallfont" align="right">
		<table cellpadding="0" cellspacing="0" border="0">
		
		<tr>
			<td>
			<div class="smallfont" style="text-align:left; white-space:nowrap">
	<form action="forumdisplay.php" method="get">
	<input type="hidden" name="s" value="5cd6bd225f7fa707c1fa499383fda4ba" />
	<input type="hidden" name="daysprune" value="" />
	<strong>Быстрый переход</strong><br />
	<select name="f" onchange="this.form.submit();">
		<optgroup label="Навигация по форуму">
			<option value="cp" >Мой кабинет</option>
			<option value="pm" >Личные сообщения</option>
			<option value="subs" >Подписки</option>
			<option value="wol" >Кто на форуме</option>
			<option value="search" >Поиск по форуму</option>
			<option value="home" >Главная страница форума</option>
		</optgroup>
		
		<optgroup label="Разделы">
		<option value="40" class="fjdpth0" > Microsoft Dynamics AX</option>
<option value="68" class="fjdpth0" > Microsoft Dynamics CRM</option>
<option value="63" class="fjdpth0" > Microsoft Dynamics NAV</option>
<option value="62" class="fjdpth0" > Рынок</option>
<option value="61" class="fjdpth0" > Прочие обсуждения</option>
<option value="108" class="fjdpth1" >&nbsp; &nbsp;  forum.mazzy.ru</option>
<option value="101" class="fjdpth0" > Проекты</option>

		</optgroup>
		
	</select><input type="submit" class="button" value="Вперёд"  />
	</form>
</div>
			</td>
		</tr>
		</table>
	</td>
</tr>
</table>
<!-- /forum rules and admin links -->




		</div>
	</div>
</div>

<!-- / close content container -->
<!-- /content area table -->



<form action="index.php" method="get" style="clear:left">

<table cellpadding="6" cellspacing="0" border="0" width="100%" class="page" align="center">
<tr>
	
		<td class="tfoot">
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Выбор стиля">
					<option value="11" class="" >-- Default Style</option>
<option value="14" class="" >---- gl00mie style 1</option>
<option value="15" class="" >---- gl00mie style 2</option>
<option value="16" class="" >---- Default 2017</option>

				</optgroup>
			</select>
		</td>
	
	
		<td class="tfoot hide-w4">
			<select name="langid" onchange="switch_id(this, 'lang')">
				<optgroup label="Выбор языка">
					<option value="3" class="" >-- Deutsch (Sie)</option>
<option value="1" class="" >-- English (US)</option>
<option value="2" class="" selected="selected">-- Russian (RU)</option>
<option value="4" class="" >-- Ukraine (UA)</option>

				</optgroup>
			</select>
		</td>
	
	<td class="tfoot hide-w1" align="right" width="100%">
		<div class="smallfont">
			<strong>
				<a href="/forums/sendmessage.php?s=5cd6bd225f7fa707c1fa499383fda4ba" rel="nofollow" accesskey="9">Обратная связь</a> <IDXSKIP>-
				<a href="http://axforum.info">AXForum</a></IDXSKIP> <IDXSKIP>-
				
				
				<span class="hide-w2">
				<a href="/forums/archive/index.php">Архив</a> -
				
				
				
				</span></IDXSKIP>
				<IDXSKIP><a href="#top" onclick="self.scrollTo(0, 0); return false;">Вверх</a></IDXSKIP>
			</strong>
		</div>
	</td>
</tr>
</table>

<br />

<div>
<IDXSKIP><span style="float:right">
<!-- Rating@Mail.ru logo -->
<a href="http://top.mail.ru/jump?from=274305">
<img src="//top-fwz1.mail.ru/counter?id=274305;t=464;l=1" 
style="border:0;" height="31" width="88" alt="Рейтинг@Mail.ru" /></a>
<!-- //Rating@Mail.ru logo -->
<!--LiveInternet logo--><a href="http://www.liveinternet.ru/click" target=_blank><img
src="http://counter.yadro.ru/logo?15.6" border=0
title="LiveInternet: показано число просмотров за 24 часа, посетителей за 24 часа и за сегодня"
width=88 height=31></a><!--/LiveInternet-->
<!-- begin of Top100 code -->

<script id="top100Counter" type="text/javascript" src="http://counter.rambler.ru/top100.jcn?805545"></script>
<noscript>

</noscript>
<!-- end of Top100 code -->
</span></IDXSKIP>

<div class="smallfont" align="left">Часовой пояс GMT +3, время: <span class="time">18:35</span>.</div>

	<div class="smallfont" align="left">
	<!-- Do not remove this copyright notice -->
	<IDXSKIP>Powered by  vBulletin&reg; v3.8.5. Перевод: </IDXSKIP><IDXSKIP><a href="http://www.zcarot.com/" target="_blank">zCarot</a></IDXSKIP><br /><IDXSKIP><a href="http://axforum.info/forums/member.php?u=10">Контактная информация</a></IDXSKIP><IDXSKIP>, 
<noindex><a href="/forums/showthread.php?p=180040#post180040" rel="nofollow">Реклама</a></noindex></IDXSKIP><IDXSKIP>.
	</IDXSKIP><!-- Do not remove this copyright notice -->
	</div>

	<div class="smallfont" align="center">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	<img src="http://axforum.info/forums/cron.php?s=5cd6bd225f7fa707c1fa499383fda4ba&amp;rand=1497108928" alt="" width="1" height="1" border="0" />
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->

	
	</div>
</div>
<div style="clear:both">

</form>




<script type="text/javascript">
<!--
	// Main vBulletin Javascript Initialization
	vBulletin_init();
//-->
</script>

<!-- temp -->
<div style="display:none">
	<!-- thread rate -->
	
		
	
	<!-- / thread rate -->
</div>
</body></html>
