studfiles.ru/preview/1620478/page:34
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru">

<head>
    <title>Кёртис Фрай - Хитрости Excel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-Control" content="max-age=10800" />
    <meta HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE" />
    <link rel="next" href="/preview/1620478/page:35/">
    <link rel="prev" href="/preview/1620478/page:33/">
    <meta property="og:image" content="/_images/logotype_cube.png" />
    <meta property="og:title" content="Кёртис Фрай - Хитрости Excel" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="StudFiles" />
    <meta property="og:url" content="/preview/1620478/page:34/" />
    <meta name="Keywords" content="ртис, Фрай, Хитрости, скачать, бесплатно, курсовик, диплом, реферат, лаборатрная, методичка" />
    <meta name="Description" content="Читать работу online по теме: Кёртис Фрай - Хитрости Excel. ВУЗ: ЯГПУ. Предмет: [НЕСОРТИРОВАННОЕ]. Размер: 49.69 Mб." />
    <meta property="og:description" content="Читать работу online по теме: Кёртис Фрай - Хитрости Excel. ВУЗ: ЯГПУ. Предмет: [НЕСОРТИРОВАННОЕ]. Размер: 49.69 Mб." />
    
    
    <!-- css -->

    <!--    
    <link rel="stylesheet" href="/_style/style.css" type="text/css" />
    <link type="text/css" href="/_style/jquery.jscrollpane.css" rel="stylesheet" media="all" />
    <link rel="stylesheet" type="text/css" media="screen" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/smoothness/jquery-ui.css" /> 
    <link rel="stylesheet" href="/elfinder/css/elfinder.min.css" type="text/css" media="screen">
    <link rel="stylesheet" href="/elfinder/css/theme.css" type="text/css" media="screen">
    <link rel="stylesheet" href="/_style/chosen.css" type="text/css" media="screen">
    <link rel="stylesheet" href="/_style/highlight.min.css" type="text/css" />
    -->

    <link rel="stylesheet" href="/_style/production/all_styles.css?v=5" type="text/css" />

    <!-- icon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- script -->

    <script>
        var selfUrl             = '/preview/1620478/page:34/';
        var folderId            = false;
        var pageTitle           = "Кёртис Фрай - Хитрости Excel";
        var folderDownload      = "false";
        var currentPage         = 'preview';
        var tplHidePopupUniver  = true;
        var tplHidePopupSubj    = true;
    </script>
    
</head>

<body>
    
    <div class="page  ">
        
        <div class="page_wrapper">
            
            
            
            <div class="header">
                <a href="/"><img src="/_images/logotype_cc.png" class="logotype" alt="Файловый архив студентов." /></a>
                <a href="/"><span class="logotype">Файловый архив студентов.<br />1022 вуза, 1990 предмета.</span></a>
                
                <!-- Begin of Panel pnlLogin -->
                    <div class="auth_block">
                        <IDXSKIP><a href="/login/" class="login enter_link">Войти</a></IDXSKIP> <IDXSKIP>/ <a href="/login/" class="enter_link">Регистрация</a></IDXSKIP>
                        <div class="popup_window" id="popup_login">
                            <IDXSKIP><div class="popup_header" id="univer_tabs">
                                <span class="close_popup"></span>
                                <a href="#signin" class="show_tab signin">Войти</a>
                                <a href="#signup" class="show_tab signup selected">Регистрация</a>
                            </div></IDXSKIP>
                            <div class="popup_content">
                                    <div class="login_block block_signin login_bg">
                                        <form name="loginForm" method="post" action="" id="loginForm" class="std_form">
                                            <label for="txtLogin">Логин:</label>
                                            <INPUT type="text" name="txtLogin" value=""  id="txtLogin"  />
                                            <label for="txtPassword">Пароль:</label>
                                            <INPUT type="password" name="txtPassword"  id="txtPassword" >
                                            <span class="forgot_pasword"><a href="/forgot_password/">Забыли пароль?</a></span>
                                            <label></label>
                                            <input type="hidden" name="skipRedirect" value="0" />
                                            <input type="hidden" name="btnLogin_submitValue" value="947825" /><input type="submit" name="btnLogin" value="Войти"  id="btnLogin" class="btn_standart"  />
                                        </form>
                                    </div>
                                    <div class="login_block block_signup login_bg"> <!-- register_bg -->
                                        <form name="registerForm" method="post" action="" id="registerForm" class="std_form">
                                            <IDXSKIP><label for="txtRegisterEmail">Email:</label></IDXSKIP> 
                                            <INPUT type="text" name="txtRegisterEmail" value=""  id="txtRegisterEmail"  /> 
                                            <IDXSKIP><label for="txtRegisterLogin">Логин:</label></IDXSKIP> 
                                            <INPUT type="text" name="txtRegisterLogin" value=""  id="txtRegisterLogin"  />
                                            <IDXSKIP><label for="txtRegisterPassword">Пароль:</label></IDXSKIP> 
                                            <INPUT type="password" name="txtRegisterPassword"  id="txtRegisterPassword" >
                                            <label class="checkbox terms"><INPUT type="hidden" name="_isPostBack" value="1"><INPUT type="checkbox" name="ckbTermsRegistration"  id="ckbTermsRegistration" ><IDXSKIP>Принимаю <a href="/terms/" target="_blank">пользовательское соглашение</a></IDXSKIP></label>
                                            <input type="hidden" name="btnRegister_submitValue" value="568750" /><input type="submit" name="btnRegister" value="Зарегистрироваться"  id="btnRegister" class="btn_blue"  />
                                        </form>
                                    </div>
                                
                            </div>
                        </div>
                    </div>
                <!-- End of Panel pnlLogin -->
                <div class="additional_menu">
                  <IDXSKIP><a href="/help/">FAQ</a></IDXSKIP> <IDXSKIP><a href="/contact_us/">Обратная связь</a></IDXSKIP> <IDXSKIP><a href="/feedback/">Вопросы и предложения</a></IDXSKIP>
                    <form action="" method="post">    
                        <INPUT type="text" name="txtSearchGo" value=""  id="txtSearchGo" placeholder="Поиск по файлам"  />
                        <input type="hidden" name="btnSearchGo_submitValue" value="738531" /><input type="submit" name="btnSearchGo" value="Go"  id="btnSearchGo" class="btn_standart"  />
                    </form>
                </div>
                <ul>
                    <IDXSKIP><li><a href="/">Вузы</a></li></IDXSKIP><IDXSKIP><li><a href="/all-vuz/">Предметы</a></li></IDXSKIP><IDXSKIP><li><a href="/users/">Пользователи</a></li></IDXSKIP>


                    <IDXSKIP><li class=" add_files"><a href="/login/" class="enter_link login">Добавить файлы</a></li></IDXSKIP>
                    <IDXSKIP><li class="advert"><a href="/user_files/go.php?url=http://www.multiwork.org/lead.aspx?from=studfiles" rel="nofollow" target="_blank">Заказать работу</a></li></IDXSKIP>
                </ul>
                <div class="clear"></div>
            </div>
            <div class="content">
                
    <div class="filter preview_info">
        <img src="http://www.studfiles.ru/user_photo/2706_s4YKI.png" />
        
        <div class="user_details">
          <IDXSKIP><span class="label ">Добавил:</span></IDXSKIP>
          <div class="details">
            <IDXSKIP>Upload<a href="" class="preview_login"></a></IDXSKIP>

            
            
            
            
            

            <span class="report_legal"><IDXSKIP>Опубликованный материал нарушает ваши авторские права? </IDXSKIP><IDXSKIP><a href="/contact_us/">Сообщите нам.</a></IDXSKIP></span>

            
          </div>
          <IDXSKIP><span class="label ">Вуз:</span></IDXSKIP><div class="details"><a href="/yagpu/">Ярославский Государственный Педагогический Университет им. К.Д.Ушинского</a></div>
          <IDXSKIP><span class="label ">Предмет:</span></IDXSKIP><div class="details"><a href="/yagpu/145/folder:7610/#1620478">[НЕСОРТИРОВАННОЕ]</a></div>
          <IDXSKIP><span class="label ">Файл:</span></IDXSKIP><div class="details"><h1 class="path">/&nbsp;Кёртис Фрай - Хитрости Excel</h1><span class="path">.pdf</span></div>
        </div>

        <div class="description">
            <IDXSKIP><span class="label">Скачиваний:</span></IDXSKIP> <div class="details">52</div>
            <IDXSKIP><span class="label">Добавлен:</span></IDXSKIP> <div class="details">06.02.2015</div>
            <IDXSKIP><span class="label">Размер:</span></IDXSKIP> <div class="details ">49.69 Mб</div>
            <a class="btn_standart btn_download link_download" href="#1620478" rel="nofollow">Скачать</a>
        </div>

    </div>

    
    
    <div class="preview_content ">
        <div class="banner_top"><!-- Yandex.RTB R-A-146764-1 -->
<div id="yandex_rtb_R-A-146764-1"></div>
<script type="text/javascript">
    (function(w, d, n, s, t) {
        w[n] = w[n] || [];
        w[n].push(function() {
            Ya.Context.AdvManager.render({
                blockId: "R-A-146764-1",
                renderTo: "yandex_rtb_R-A-146764-1",
                async: true
            });
        });
        t = d.getElementsByTagName("script")[0];
        s = d.createElement("script");
        s.type = "text/javascript";
        s.src = "//an.yandex.ru/system/context.js";
        s.async = true;
        t.parentNode.insertBefore(s, t);
    })(this, this.document, "yandexContextAsyncCallbacks");
</script></div>
        
        
        
        
        <!-- Begin of Panel pnlDocument -->
            <div class="type_pdf">
                <style>.__page_wrapper {overflow: visible;}</style>
                <IDXSKIP><div class="chapter_page_navigation">
                    <a class="show_chapter_sidebar" href="#">☰ Содержание</a>
                </div></IDXSKIP>
                

<div class="pagination">
        
        
        
        
        
            <a href="/preview/1620478/" class="page_num"><<</a>
        
            <a href="/preview/1620478/page:33/" class="page_num"><</a>
        
            <a href="/preview/1620478/page:16/" class="page_num">16</a>
        
            <a href="/preview/1620478/page:17/" class="page_num">17</a>
        
            <a href="/preview/1620478/page:18/" class="page_num">18</a>
        
            <a href="/preview/1620478/page:19/" class="page_num">19</a>
        
            <a href="/preview/1620478/page:20/" class="page_num">20</a>
        
            <a href="/preview/1620478/page:21/" class="page_num">21</a>
        
            <a href="/preview/1620478/page:22/" class="page_num">22</a>
        
            <a href="/preview/1620478/page:23/" class="page_num">23</a>
        
            <a href="/preview/1620478/page:24/" class="page_num">24</a>
        
            <a href="/preview/1620478/page:25/" class="page_num">25</a>
        
            <a href="/preview/1620478/page:26/" class="page_num">26</a>
        
            <a href="/preview/1620478/page:27/" class="page_num">27</a>
        
            <a href="/preview/1620478/page:28/" class="page_num">28</a>
        
            <a href="/preview/1620478/page:29/" class="page_num">29</a>
        
            <a href="/preview/1620478/page:30/" class="page_num">30</a>
        
            <a href="/preview/1620478/page:31/" class="page_num">31</a>
        
            <a href="/preview/1620478/page:32/" class="page_num">32</a>
        
            <a href="/preview/1620478/page:33/" class="page_num">33</a>
        
            <a href="/preview/1620478/page:35/" class="next_link">Следующая &#62;</a>
        
            <a href="/preview/1620478/page:33/" class="back_link">&#60; Предыдущая</a>
        
            <span class="current_page">Стр 34 из 37</span>
        
            <a href="" class="page_num selected">34</a>
        
            <a href="/preview/1620478/page:35/" class="page_num">35</a>
        
            <a href="/preview/1620478/page:36/" class="page_num">36</a>
        
            <a href="/preview/1620478/page:37/" class="page_num">37</a>
        
</div>


                <div id="content_pdf_page">
                    <div class="pdf_holder">
                        
                        
                        
                        
                        <link rel="stylesheet" type="text/css" href="/html/2706/679/html_VTXI3OjlUm.vIvo/css.css">
<div id="page_331" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 597px;height: 868px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:597px;height:868px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr331x1.jpg" style="width:597px;height:868px;"></div><div class="dclr"></div><p style="text-align: left;padding-left: 70px;margin-top: 61px;margin-bottom: 0px;" class="ft20"><span class="ft22">3 34 Глава 8. </span>Настройка, макросы и УВД</p><p style="text-align: justify;padding-left: 70px;padding-right: 37px;margin-top: 12px;margin-bottom: 0px;text-indent: 1px;" class="ft54">Кстати говоря, Word и Excel <nobr>по-разному</nobr>ведут себя в случае присваивания объекту значения Nothing. Word закрывается только в том случае, если окно программы отсутствует на экране; Excel закрывается всегда.</p><p style="text-align: justify;padding-left: 70px;padding-right: 37px;margin-top: 1px;margin-bottom: 0px;text-indent: 1px;" class="ft33">Существует три простых приема для ускорения работы макросов. В приведенном далее фрагменте первая строка отключает обновление экрана (см. предыдущий раз­ дел); вторая запрещает повторный обсчет разрывов страниц при изменении листа (это отнимает довольно много времени); наконец, третья строка запрещает повтор­ ный обсчет листа при изменении ячейки (тоже весьма трудоемкая операция):</p><p style="text-align: left;padding-left: 70px;padding-right: 301px;margin-top: 3px;margin-bottom: 0px;" class="ft140">Application.ScreenUpdatlng - False ActiveSheet.DisplayPageBreaks - False Application.Calculation = xlManual</p><p style="text-align: left;padding-left: 71px;margin-top: 9px;margin-bottom: 0px;" class="ft51">Создание строки из компонентов</p><p class="p1415 ft25">Проблема</p><p style="text-align: justify;padding-left: 72px;padding-right: 33px;margin-top: 4px;margin-bottom: 0px;" class="ft33">Я хочу вывести адрес диапазона ячеек в окне сообщения; это поможет отладит ь процедуру, над которой я работаю. Я знаю, что в середину нужно включить сим­ вол двоеточия, чтобы строка имела вид А1:А4 или <nobr>что-нибудь</nobr>в этом роде. Ка&lt; в VBА создать строку по значениям нескольких переменных и как добавить в не г двоеточие, чтобы строка выглядела как диапазон адресов?</p><p class="p2022 ft25">Решение</p><p style="text-align: left;padding-left: 72px;padding-right: 35px;margin-top: 4px;margin-bottom: 0px;" class="ft54">Объединение строк осуществляется оператором конкатенации &amp;, как показан э в следующем примере:</p><p style="text-align: left;padding-left: 85px;padding-right: 300px;margin-top: 1px;margin-bottom: 0px;text-indent: -11px;" class="ft116">strAllShows - strFirstAddress &amp; ":" &amp; strLastAddress</p><p style="text-align: justify;padding-left: 72px;padding-right: 31px;margin-top: 2px;margin-bottom: 0px;text-indent: 1px;" class="ft33">Команда берет текст, хранящийся в переменной strFirstAddress, присоединяет к не­ му двоеточие, после чего добавляет текст переменной strLastAddress для создания строки. Например, если переменная strFirstAddress содержит текст А1, а перемен­ ная strLastAddress — текст G45, то переменная strAIIShows будет содержать текст A1:G45.</p><p style="text-align: justify;padding-left: 73px;padding-right: 26px;margin-top: 19px;margin-bottom: 0px;" class="ft54">Оператор &amp; можно использовать сколько угодно раз для построения длинных стро к в VBА. Нередко эти операторы размещают в разных строках, добавляя симво <span class="ft295">т: </span>продолжения строки:</p><p style="text-align: left;padding-left: 86px;padding-right: 255px;margin-top: 0px;margin-bottom: 0px;text-indent: -12px;" class="ft20">msg = "Очень длинное сообщение, " &amp; _ "которое выводится в окне сообщения. " &amp; _ "но должно помещаться в окне программы."</p><p style="text-align: left;padding-left: 73px;margin-top: 1px;margin-bottom: 0px;" class="ft20">MsgBox msg</p><p style="text-align: left;padding-left: 72px;padding-right: 34px;margin-top: 5px;margin-bottom: 0px;text-indent: 1px;" class="ft54">Как уже упоминалось, пробел с символом подчеркивания ( _) позволяет разбить команду на несколько строк без вставки реальных разрывов строк. Последняя з; дача решается при помощи константы vbCrLf:</p><p style="text-align: left;padding-left: 73px;margin-top: 1px;margin-bottom: 0px;" class="ft20">msg = "Очень длинное сообщение, которое "</p><p style="text-align: justify;padding-left: 85px;margin-top: 0px;margin-bottom: 0px;" class="ft20"><span class="ft20">&amp;</span><span style="font: 12px 'Arial';margin-left: 5px;line-height: 14px;">vbCrLf &amp; "выводится в окне сообщения "</span></p><p style="text-align: justify;padding-left: 85px;margin-top: 0px;margin-bottom: 0px;" class="ft20"><span class="ft20">&amp;</span><span style="font: 12px 'Arial';margin-left: 5px;line-height: 14px;">vbCrLf &amp; "с разрывами строк."</span></p><p style="text-align: left;padding-left: 73px;margin-top: 1px;margin-bottom: 0px;" class="ft20">MsgBox msg</p></div><div id="page_332" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 596px;height: 868px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:596px;height:868px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr332x1.jpg" style="width:596px;height:868px;"></div><div class="dclr"></div><table cellpadding="0" cellspacing="0" style="width: 145px;margin-left: 394px;margin-top: 61px;font: 12px 'Arial';">
<tr>
	<td class="tr9 td84"><p class="p22 ft20">Проблемы сУВА</p></td><td class="tr9 td127"><p class="p56 ft20">3 3 5</p></td></tr></table><p class="p263 ft51">Выполнение операции с каждым элементом коллекции</p><p style="text-align: left;padding-left: 47px;margin-top: 6px;margin-bottom: 0px;" class="ft25">Проблема</p><p style="text-align: justify;padding-left: 47px;padding-right: 57px;margin-top: 3px;margin-bottom: 0px;" class="ft33">В своей работе я использую так много книг, что не помню, сколько листов содер­ жит та или иная книга (особенно если некоторые листы остаются скрытыми). Существует ли конструкция для выполнения некоторой операции с <span class="ft203">каждым </span>лис­ том книги независимо от их количества? Например, можно ли написать процеду­ ру, которая бы делала каждый лист книги видимым?</p><p class="p298 ft25">Решение</p><p style="text-align: justify;padding-left: 47px;padding-right: 53px;margin-top: 4px;margin-bottom: 0px;text-indent: 1px;" class="ft33">Конечно, можно. Некоторые объекты — такие, как листы в книгах или ячейки в ди­ апазонах — образуют <span class="ft203">коллекции. </span>Для выполнения операций с каждым элементом коллекции (например, с каждым листом в коллекции Worksheets) следует исполь­ зовать циклы For Each...Next:</p><p class="p883 ft20">Sub UnhideAllSheets О</p><p style="text-align: left;padding-left: 54px;margin-top: 0px;margin-bottom: 0px;" class="ft20">Dim wksMySheet As Worksheet</p><p style="text-align: left;padding-left: 53px;padding-right: 337px;margin-top: 1px;margin-bottom: 0px;text-indent: 1px;" class="ft140">For Each wksMySheet In Worksheets wksMySheet.Visible = True</p><p style="text-align: left;padding-left: 48px;padding-right: 447px;margin-top: 0px;margin-bottom: 0px;text-indent: 6px;" class="ft116">Next wksMySheet End Sub</p><p style="text-align: justify;padding-left: 48px;padding-right: 57px;margin-top: 0px;margin-bottom: 0px;text-indent: 1px;" class="ft33">Чтобы получить список всех коллекций в Excel 2003, запустите редактор Visual Basic, нажав клавиши Alt+Fll, откройте справочную систему Visual Basic с помо­ щью клавиши F1, щелкните в строке Microsoft Excel Visual Basic Reference в области задач, после чего откройте ссылку Collections. Если теперь щелкнуть на любой букве, на экране появится список коллекций, имена которых начинаются с этой буквы.</p><p style="text-align: left;padding-left: 48px;margin-top: 12px;margin-bottom: 0px;" class="ft51">Запуск макроса при возникновении события</p><p class="p302 ft25">Проблема</p><p style="text-align: justify;padding-left: 48px;padding-right: 56px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft31">Сейчас я занимаюсь разработкой программной системы на VBA по заказу клиен­ та. Нужно написать макрос, который бы выводил окно сообщения с краткими пояснениями каждый раз, когда мой клиент просматривает очередной лист. Как это сделать?</p><p style="text-align: left;padding-left: 49px;margin-top: 10px;margin-bottom: 0px;" class="ft25">Решение</p><p style="text-align: justify;padding-left: 48px;padding-right: 55px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft31">Чтобы макрос запускался при возникновении определенного события, следует включить его код в процедуру обработки этого события. В Excel для таких объек­ тов, как книги, листы и т. д., определяются наборы стандартных событий. Чтобы макрос запускался при активизации листа пользователем, выполните следующие действия в редакторе Visual Basic.</p><p class="p1737 ft33"><span class="ft31">1.</span><span class="ft92">В окне проекта, находящемся в левом верхнем углу окна редактора Visual Basic (рис. 8.22), сделайте двойной щелчок на нужном объекте. В нашем примере двойной щелчок на листе Лист1 открывает новое окно программы.</span></p><p class="p1714 ft33"><span class="ft31">2.</span><span class="ft208">Раскройте список Object в левом верхнем углу окна программы и выберите в нем пункт Worksheet.</span></p><p style="text-align: justify;padding-left: 68px;padding-right: 55px;margin-top: 1px;margin-bottom: 0px;text-indent: -19px;" class="ft33"><span class="ft31">3.</span><span class="ft208">Раскройте список Procedure в правом верхнем углу и выберите в нем пункт Activate. Редактор Visual Basic создаст заготовку процедуры события Activate.</span></p></div><div id="page_333" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 596px;height: 868px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:596px;height:868px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr333x1.jpg" style="width:596px;height:868px;"></div><div class="dclr"></div><p class="p14 ft22"><span class="ft31">336 </span>Глава 8. Настройка, макросы и VBA</p><p style="text-align: justify;padding-left: 87px;padding-right: 38px;margin-top: 15px;margin-bottom: 0px;text-indent: -19px;font: bold 12px 'Arial';line-height: 16px;"><span class="ft22">4.</span><span style="font: bold 12px 'Arial';margin-left: 10px;line-height: 16px;">Введите между строками Sub и End Sub строку MsgBox("B этом листе обобщаются затраты по проекту А3802 за 4 квартал").</span></p><p style="text-align: justify;padding-left: 87px;padding-right: 37px;margin-top: 1px;margin-bottom: 0px;text-indent: -18px;" class="ft33"><span class="ft167">5.</span><span class="ft92">Закройте редактор Visual Basic. Активизируйте лист Лист1 и проверьте, как работает процедура обработки события.</span></p><p style="text-align: left;padding-left: 90px;margin-top: 18px;margin-bottom: 0px;" class="ft58">iMicrosoft Visual Basic - Книга2 - (Module! (Code)]</p><p style="text-align: left;padding-left: 122px;margin-top: 4px;margin-bottom: 0px;" class="ft62">Шйй i'e.v iiv.ei f.invaj n*i</p><p style="text-align: left;padding-left: 128px;margin-top: 5px;margin-bottom: 0px;" class="ft70">* <nobr>-J</nobr></p><p style="text-align: left;padding-left: 345px;margin-top: 5px;margin-bottom: 0px;" class="ft84">т ] |{Dccl.rations)</p><p style="text-align: left;padding-left: 123px;margin-top: 0px;margin-bottom: 0px;font: italic bold 18px 'Arial';line-height: 20px;">LA</p><p style="text-align: left;padding-left: 106px;padding-right: 433px;margin-top: 0px;margin-bottom: 0px;font: 5px 'Arial';line-height: 7px;">fui« r. i (FUNCRES.XLA) VBAProJetl (Книг «2) \tt MwwoftE&gt;:et Objects</p><p style="text-align: justify;padding-left: 113px;padding-right: 441px;margin-top: 0px;margin-bottom: 0px;text-indent: 1px;font: 5px 'Arial';line-height: 7px;"><span class="ft122">•</span><span style="font: 5px 'Arial';margin-left: 5px;line-height: 7px;">: ft.. • i (Лист!) Щ nw,2 (ЛистЕ)</span></p><p style="text-align: justify;padding-left: 113px;margin-top: 0px;margin-bottom: 0px;" class="ft84"><span class="ft84">•</span><span style="font: 5px 'Arial';margin-left: 1px;line-height: 6px;">Й ^ ' Д Л и с т З )</span></p><p style="text-align: justify;padding-left: 113px;margin-top: 1px;margin-bottom: 0px;" class="ft84"><span class="ft420">Q </span><nobr>ЭтаКнч-а</nobr></p><p class="p279 ft84">ft ModJM</p><p style="text-align: left;padding-left: 100px;margin-top: 125px;margin-bottom: 0px;" class="ft455">Рис. 8.22.Это окно программы связано сконкретным листом,а не скнигой в целом</p><p class="p1525 ft51">Установка пароля для просмотра кода VBA</p><p class="p430 ft25">Проблема</p><p style="text-align: left;padding-left: 69px;padding-right: 37px;margin-top: 4px;margin-bottom: 0px;" class="ft33">Я не хочу, чтобы любой желающий мог просматривать мой код. Как защитит], паролем программный модуль VBA?</p><p class="p1197 ft25">Решение</p><p style="text-align: left;padding-left: 69px;margin-top: 4px;margin-bottom: 0px;" class="ft31">Парольная защита кода VBA в книге устанавливается так.</p><p style="text-align: justify;padding-left: 87px;padding-right: 43px;margin-top: 5px;margin-bottom: 0px;text-indent: -17px;" class="ft54"><span class="ft67">1.</span><span class="ft606">В редакторе Visual Basic выполните команду Tools • VBAProject Properties, перей дите на вкладку Protection и установите флажок Lock project for viewing.</span></p><p class="p100 ft31"><span class="ft31">2.</span><span class="ft607">Введите пароль в поле Password и повторите его в поле Confirm.</span></p><p class="p1678 ft31"><span class="ft31">3.</span><span class="ft607">Сохраните книгу и закройте ее.</span></p><p class="p557 ft51">Сокращенные ссылки на объекты в коде VBA</p><p class="p727 ft22">Проблема</p><p style="text-align: justify;padding-left: 68px;padding-right: 37px;margin-top: 5px;margin-bottom: 0px;text-indent: 1px;" class="ft33">Условные форматы, содержащие до трех условий, можно создавать командой Формат • Условное форматирование, но для моих данных необходимо целых пять условий. Задача легко решается в VBA конструкциями вида</p><p style="text-align: left;padding-left: 69px;margin-top: 1px;margin-bottom: 0px;" class="ft20">If eel.Value &gt; 10000 Then</p><p class="p423 ft20">WorksheetsC'flHBapb") .RangeC'Al").Font.Bold = True</p><p class="p423 ft20">Worksheets("Январь").RangeC'Al").Font.Italic = True</p><p style="text-align: left;padding-left: 67px;margin-top: 1px;margin-bottom: 0px;" class="ft20">Worksheets( "Январь"). RangeC'Al"). Font. <nobr>Color-Index</nobr>= 30</p></div><div id="page_334" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 606px;height: 875px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:606px;height:875px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr334x1.jpg" style="width:606px;height:875px;"></div><div class="dclr"></div><div style="border:none;margin: 60px 0px 0px 56px;padding: 0px;border:none;width: 550px;overflow: hidden;">
<table cellpadding="0" cellspacing="0" style="width: 145px;margin-left: 347px;font: bold 12px 'Arial';">
<tr>
	<td class="tr9 td135"><p class="p22 ft22">Проблемы с VBA</p></td><td class="tr9 td102"><p class="p56 ft20">3 3 7</p></td></tr></table><table cellpadding="0" cellspacing="0" style="width: 390px;margin-top: 11px;font: 9px 'Arial';">
<tr>
	<td style="padding: 0px;margin: 0px;width: 377px;vertical-align: bottom;" class="tr5"><p class="p22 ft14">End I f</p></td><td class="tr5 td13"><p class="p22 ft14">• .</p></td></tr></table><p style="text-align: justify;padding-right: 58px;margin-top: 2px;margin-bottom: 0px;" class="ft38">Однако меня раздражает необходимость каждый раз вводить текст Worksheets ("Январь").Range("Al"), который присутствует в каждой команде внутри блока Then. Нельзя ли <nobr>как-то</nobr>избавиться от ввода лишних данных?</p><p class="p211 ft25">Решение</p><p class="p1934 ft24">Для сокращения ссылок на объекты используется конструкция With...End With:</p><p class="p717 ft20">If eel.Value &gt; 10000 Then</p><p class="p2173 ft20">With Worksheets("Январь").Range("Al").Font</p><p class="p1242 ft20">.Bold True</p><p class="p1242 ft20">. I t a l i c = True</p><p style="text-align: left;padding-left: 6px;padding-right: 440px;margin-top: 0px;margin-bottom: 0px;text-indent: 7px;" class="ft140">.Colorlndex = 30 End With</p><p class="p166 ft20">End I f</p><p class="p754 ft24">He забудьте ставить точку перед именами свойств и методов!</p><p style="text-align: justify;padding-right: 53px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft46">При использовании ключевого слова With утрачивается удобная функция авто­ заполнения VBA. Автозаполнение особенно полезно при изучении VBA: при вво­ де точки после имени объекта редактор выводит список всех возможных методов и свойств. Если вы предпочитаете сохранить эту возможность, создайте корот­ кую ссылку на объект и используйте ее вместо ключевого слова With:</p><p class="p1025 ft20">Dim rng As Range</p><p style="text-align: left;padding-left: 1px;padding-right: 294px;margin-top: 0px;margin-bottom: 0px;" class="ft140">Set rng • Worksheets("flHBapb").Range("Al") <span style="font: 13px 'Courier New';line-height: 16px;">rng.Font.Bold = True</span></p><p style="text-align: left;padding-left: 1px;padding-right: 411px;margin-top: 0px;margin-bottom: 0px;font: 10px 'Courier New';line-height: 19px;">rng.Font.Italic = True rng.FontSnze = 12</p><p class="p166 ft51">Открытие книги в режиме восстановления</p><p class="p206 ft25">Проблема</p><p style="text-align: justify;padding-left: 1px;padding-right: 58px;margin-top: 2px;margin-bottom: 0px;" class="ft38">Я только что перешел на работу с новой версией Excel, которая была установлена на моем компьютере этим утром. При попытке открыть одну из книг, содержащих макросы, я получил следующее сообщение об ошибке:</p><p style="text-align: left;padding-left: 20px;padding-right: 38px;margin-top: 0px;margin-bottom: 0px;" class="ft328">В AutoPivotJcls были обнаружены ошибки, но Microsoft Excel удалось открыть файл с внесением некоторых изменений. Сохраните файл, чтобы, изменения стали постоянными.</p><p style="text-align: left;padding-left: 20px;padding-right: 337px;margin-top: 0px;margin-bottom: 0px;font: italic 14px 'Times New Roman';line-height: 19px;">Потерян проект VisualBasic. Потеряны элементы ActiveX.</p><p style="text-align: justify;padding-left: 1px;padding-right: 49px;margin-top: 0px;margin-bottom: 0px;" class="ft24">Ошибка <nobr>как-то</nobr>связана с Visual Basic for Applications? Программа спрашивала, хочу ли я установить Visual Basic for Applications; я ответил отрицательно, пото­ му что язык VBА был уже установлен. Я не стал сохранять файл без проекта Visual Basic (это привело бы к потере программного кода), но, может, стоит разрешить Excel установить VBA заново?</p><p class="p513 ft25">Решение</p><p style="text-align: left;padding-left: 2px;padding-right: 52px;margin-top: 2px;margin-bottom: 0px;text-indent: 1px;" class="ft75">Программа установки Office не всегда устанавливает VBA в составе Office. Неко­ торые сетевые администраторы предпочитают не устанавливать VBA, если толь-</p></div><div style="border:none;margin: 10px 0px 0px 76px;padding: 0px;border:none;width: 530px;overflow: hidden;">
<p class="p7 ft67">12 Зак. 309</p></div></div><div id="page_335" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 614px;height: 880px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:614px;height:880px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr335x1.jpg" style="width:614px;height:880px;"></div><div class="dclr"></div><p class="p1474 ft20"><span class="ft70">338 </span><span class="ft22">Глава 8. </span>Настройка, макросы и УВД</p><p style="text-align: justify;padding-left: 69px;padding-right: 54px;margin-top: 12px;margin-bottom: 0px;" class="ft33">ко начальник не скажет им, что поддержка VBA нужна конкретному пользовате­ лю для выполнения его работы. Разумеется, отсутствие макросов решает пробле­ му с макровирусами, но иногда оно создает препятствия в работе.</p><p style="text-align: justify;padding-left: 70px;padding-right: 54px;margin-top: 2px;margin-bottom: 0px;text-indent: 1px;" class="ft31">В данном случае отказ от установки VBA привел к появлению сообщения об ошиб ке. Если у вас под рукой имеется установочный диск Office, запустите Excel, вы­ полните команду Сервис • Макрос • Редактор Visual Basic и щелкните на кнопке Да чтобы установить VBA.</p><p style="text-align: left;padding-left: 71px;padding-right: 250px;margin-top: 16px;margin-bottom: 0px;text-indent: 1px;font: 17px 'Arial';line-height: 21px;">Невозможность сохранения файла без подключения к сети</p><p style="text-align: left;padding-left: 72px;margin-top: 4px;margin-bottom: 0px;" class="ft70">Проблема</p><p style="text-align: justify;padding-left: 71px;padding-right: 53px;margin-top: 4px;margin-bottom: 0px;" class="ft31">Один из моих коллег только что пробежал по офису, крича, что сеть сейчас от­ ключится и мне нужно срочно сохранить свою работу. В это время я возился со сводной таблицей в книге, которая хранилась на другом компьютере сети; я по­ пытался сохранить книгу на сетевом диске, поскорее щелкнув на кнопке Сохра­ нить. Видимо, я все же действовал недостаточно быстро, потому что на экране появилось следующее сообщение об ошибке:</p><p style="text-align: left;padding-left: 91px;padding-right: 53px;margin-top: 2px;margin-bottom: 0px;" class="ft295">Microsoft Excel не может обратиться к файлу \\Sebastopol\NetShare\AutoPi- vot.xls. Это сообщение может выводиться по следующим причинам:</p><p style="text-align: left;padding-left: 92px;margin-top: 0px;margin-bottom: 0px;" class="ft32">Файл или каталог не существует.</p><p style="text-align: left;padding-left: 91px;padding-right: 53px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft295">Открываемый файл используется другой программой. Закройте документ в дру­ гой прогрсшме и повторите попытку.</p><p style="text-align: left;padding-left: 91px;padding-right: 51px;margin-top: 0px;margin-bottom: 0px;" class="ft203">Имя сохраняемой книги совпадает с именем другого документа, доступного толь­ ко для чтения. Попробуйте сохранить книгу под другим именем.</p><p style="text-align: justify;padding-left: 72px;padding-right: 48px;margin-top: 2px;margin-bottom: 0px;text-indent: 1px;" class="ft31">При этом книга все еще отображалась на экране, поэтому я попытался сохранить ее на <span class="ft32">своем </span>жестком диске — и получил сообщение об ошибке «Документ не был сохранен». Почему я не могу сохранить файл на своем компьютере, если он нахо­ дится в памяти?</p><p style="text-align: left;padding-left: 73px;margin-top: 26px;margin-bottom: 0px;" class="ft70">Решение</p><p style="text-align: justify;padding-left: 73px;padding-right: 50px;margin-top: 4px;margin-bottom: 0px;text-indent: 1px;" class="ft31">Вы столкнулись с одной из многих странностей Excel 2000 и более поздних вер­ сий. Если вы пытаетесь сохранить удаленный файл на своем компьютере <span class="ft32">после отключения сети </span>и этот файл содержит сводную таблицу, код VBA или внедрен­ ные объекты (например, графику или другие документы Office), Excel не может получить всю информацию, необходимую для сохранения. Если книга не содер­ жит ни одного из перечисленных элементов, вы можете сохранить ее на своем компьютере.</p><p style="text-align: justify;padding-left: 73px;padding-right: 47px;margin-top: 21px;margin-bottom: 0px;text-indent: 1px;" class="ft31">При работе с сетевым файлом в Excel 97 все, что вы можете сделать для решения этой проблемы, — почаще сохранять изменения. Excel 2000 и выше можно заста­ вить сохранять локальную копию сетевого файла, для чего в реестр включаются два параметра: NetworkResiliency и PivotTableNetworkResiliency. Все вносимые изме­ нения записываются в память компьютера; при сохранении книги Excel записы­ вает все изменения в файле на удаленный компьютер.</p><p style="text-align: left;padding-left: 73px;padding-right: 51px;margin-top: 6px;margin-bottom: 0px;" class="ft54">Прежде всего обязательно создайте резервную копию реестра! За подробностями обращайтесь к врезке, посвященной резервированию реестра, в разделе «Увели-</p></div><div id="page_336" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 605px;height: 874px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:605px;height:874px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr336x1.jpg" style="width:605px;height:874px;"></div><div class="dclr"></div><table cellpadding="0" cellspacing="0" style="width: 144px;margin-left: 400px;margin-top: 63px;font: 12px 'Arial';">
<tr>
	<td class="tr16 td84"><p class="p22 ft20">Проблемы с УВД</p></td><td class="tr16 td60"><p class="p56 ft22">339</p></td></tr></table><p style="text-align: justify;padding-left: 52px;padding-right: 61px;margin-top: 8px;margin-bottom: 0px;" class="ft54">чение количества отменяемых операций» ранее в данной главе. Создание пара­ метров производится следующим образом.</p><p style="text-align: justify;padding-left: 71px;padding-right: 57px;margin-top: 0px;margin-bottom: 0px;text-indent: -17px;" class="ft33"><span class="ft31">1.</span><span class="ft246">Запустите редактор реестра (Пуск • Выполнить • Regedit) и откройте раздел HKEY_CURRENT_USER\Software\Microson:\Office\6epcM^\Excel\Options, где </span><span class="ft203">версия </span>— номер используемой версии Excel (для Excel 2000 он равен 0, для Excel 2002 — 10, а для Excel 2 0 0 3 - И).</p><p style="text-align: justify;padding-left: 72px;padding-right: 61px;margin-top: 2px;margin-bottom: 0px;text-indent: -19px;" class="ft33"><span class="ft31">2.</span><span class="ft208">Щелкните правой кнопкой мыши на подразделе Options на левой панели и вы­ полните команду Создать • Параметр DWORD.</span></p><p style="text-align: justify;padding-left: 72px;padding-right: 60px;margin-top: 2px;margin-bottom: 0px;text-indent: -19px;" class="ft54"><span class="ft31">3.</span><span class="ft53">Замените имя по умолчанию Новый параметр #1, появившееся в нижней части правой панели, именем NetworkResiliency.</span></p><p style="text-align: justify;padding-left: 72px;padding-right: 61px;margin-top: 1px;margin-bottom: 0px;text-indent: -20px;" class="ft31"><span class="ft31">4.</span><span class="ft607">Сделайте двойной щелчок на параметре NetworkResiliency и введите в поле Зна­ чение число 1. Если вы работаете с Excel 2000, после этого можно закрыть ре­ дактор реестра и перезапустить Excel. В более поздних версиях Excel перей­ дите к шагу 5.</span></p><p style="text-align: justify;padding-left: 72px;padding-right: 61px;margin-top: 19px;margin-bottom: 0px;text-indent: -19px;" class="ft54"><span class="ft31">5.</span><span class="ft141">В Excel 2002 и выше щелкните правой кнопкой мыши на подразделе Options на левой панели и выполните команду Создать • Параметр DWORD.</span></p><p style="text-align: justify;padding-left: 72px;padding-right: 60px;margin-top: 1px;margin-bottom: 0px;text-indent: -19px;" class="ft54"><span class="ft31">6.</span><span class="ft141">Замените имя по умолчанию Новый параметр #2, появившееся в нижней части правой панели, именем PivotTableNetworkResiliency.</span></p><p style="text-align: justify;padding-left: 53px;margin-top: 1px;margin-bottom: 0px;" class="ft31"><span class="ft31">7.</span><span class="ft63">Сделайте двойной щелчок па параметре PivotTableNetworkResiliency и введите</span></p><p style="text-align: justify;padding-left: 72px;margin-top: 0px;margin-bottom: 0px;" class="ft31"><span class="ft31">в</span><span class="ft36">поле Значение число 1.</span></p><p style="text-align: justify;padding-left: 54px;margin-top: 4px;margin-bottom: 0px;" class="ft31"><span class="ft31">8.</span><span class="ft52">Закройте редактор реестра и перезапустите Excel.</span></p><p style="text-align: justify;padding-left: 54px;padding-right: 59px;margin-top: 8px;margin-bottom: 0px;text-indent: 1px;" class="ft31">Присутствие этих двух параметров указывает Excel на необходимость хранения полной копии книги в каталоге временных файлов на локальном компьютере (уч­ тите, что это замедляет открытие и сохранение файлов). Если подключение к се­ ти будет потеряно, то при попытке сохранить книгу со сводной таблицей, моду­ лем VBA или внедренным объектом все равно будет выведено длинное сообщение об ошибке. Но поскольку Excel хранит на вашем компьютере полную копию кни­ ги, не ограничиваясь списком изменений между исходным файлом и отредакти­ рованной версией, вы сможете сохранить файл на локальном компьютере даже при потере связи с исходным файлом.</p><p style="text-align: left;padding-left: 55px;margin-top: 34px;margin-bottom: 0px;" class="ft22">EXCEL VBA ДЛЯ УЧЕНЫХ И ИНЖЕНЕРОВ</p><p style="text-align: left;padding-left: 92px;margin-top: 1px;margin-bottom: 0px;" class="ft11">Большинство ресурсов, посвященных Excel, ориентировано на <nobr>бизнес-сообщество,</nobr>но Гил-</p><p style="text-align: left;padding-left: 92px;margin-top: 0px;margin-bottom: 0px;" class="ft11">берто Е. Уррос (Gilberto E.Urroz) из университета штата Юта создал замечательный бесплат­</p><p style="text-align: left;padding-left: 92px;padding-right: 54px;margin-top: 0px;margin-bottom: 0px;" class="ft76">ный ресурс для студентов, занимающихся изучением численных методов. В нем приводится код для решения систем линейных уравнений, численного интегрирования и решения три­</p><p style="text-align: left;padding-left: 92px;padding-right: 54px;margin-top: 0px;margin-bottom: 0px;" class="ft79">гонометрических уравнений. Код можно загрузить по адресу http://www.engineering.usu.edu/ cee/faculty/gurro/Software_Calculators/ExcelVBA/ExcelVBAExamples.htm.</p><p style="text-align: left;padding-left: 55px;margin-top: 29px;margin-bottom: 0px;" class="ft315">Ошибка метода Range.Calculate</p><p style="text-align: left;padding-left: 56px;margin-top: 9px;margin-bottom: 0px;" class="ft70">Проблема</p><p style="text-align: justify;padding-left: 55px;padding-right: 58px;margin-top: 4px;margin-bottom: 0px;" class="ft33">Я пытаюсь выполнить макрос в книге с большим количеством формул ВПР(). Что­ бы программа не занималась постоянным пересчетом всех формул в книге, я ис­ пользую метод Range.Calculate для указания пересчитываемых ячеек. Например,</p></div><div id="page_337" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 611px;height: 878px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:611px;height:878px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr337x1.jpg" style="width:611px;height:878px;"></div><div class="dclr"></div><div style="border:none;margin: 62px 0px 0px 71px;padding: 0px;border:none;width: 540px;overflow: hidden;">
<p class="p7 ft20">3 4 0 Глава 8. Настройка, макросы и VBA</p><p class="p1643 ft24">команда Range("A4:A5").Calculate пересчитывает формулы в ячейках А4 и А5. Одна­ ко при попытке запустить макрос на другом компьютере появляется следующее сообщение об ошибке:</p><p style="text-align: left;padding-left: 20px;margin-top: 1px;margin-bottom: 0px;" class="ft329">Ошибка времени выполнения '1004'</p><p style="text-align: left;padding-left: 19px;margin-top: 3px;margin-bottom: 0px;" class="ft329">Не удается вызвать метод Calculate класса Range</p><p class="p717 ft24">Что происходит? На моем компьютере этот макрос отлично работает!</p><p class="p1003 ft93">Решение</p><p style="text-align: left;padding-left: 1px;padding-right: 42px;margin-top: 2px;margin-bottom: 0px;" class="ft46">Дело в том, что вы пытаетесь использовать метод Range.Calculate в книге, для ко­ торой включен режим ручного пересчета и установлен флажок Итерации. Эти на­ стройки мешают работе метода Range.Calculate и становятся причиной ошибки Чтобы избавиться от проблемы, выполните команду Сервис • Параметры, перей дите на вкладку Вычисления и установите переключатель Автоматически или сбрось­ те флажок Итерации (или сделайте то и другое).</p><p style="text-align: left;padding-left: 2px;padding-right: 45px;margin-top: 0px;margin-bottom: 0px;" class="ft154">Если вы предпочитаете автоматизировать процесс, перед вызовом метода Calculate проверьте способ пересчета формул на программном уровне, как показано ниже:</p><p style="text-align: left;padding-left: 2px;padding-right: 422px;margin-top: 0px;margin-bottom: 0px;" class="ft140">Dim rng As Range Set rng = Selection</p><p style="text-align: left;padding-left: 8px;padding-right: 355px;margin-top: 0px;margin-bottom: 0px;text-indent: -4px;" class="ft20">I f Application.Calculation = _ xlCalculationManual Then Application.Calculation = _</p><p style="text-align: left;padding-left: 15px;padding-right: 400px;margin-top: 0px;margin-bottom: 0px;text-indent: 5px;" class="ft20">xlCalculateAutomatic rng.Calculate</p><p style="text-align: left;padding-left: 3px;padding-right: 259px;margin-top: 0px;margin-bottom: 0px;text-indent: 5px;" class="ft140">Application.Calculation = xlCalculationManual Else</p><p style="text-align: left;padding-left: 3px;padding-right: 460px;margin-top: 0px;margin-bottom: 0px;" class="ft140">rng.Calculate End I f</p><p style="text-align: left;padding-left: 4px;margin-top: 21px;margin-bottom: 0px;" class="ft6">Полезные процедуры VBA</p><p class="p1291 ft51">Создание книги с листами для всех месяцев</p><p class="p1651 ft93">Проблема</p><p style="text-align: justify;padding-left: 3px;padding-right: 41px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft24">Многим пользователям из администрации часто приходится создавать книги, в ко­ торых каждый месяц года представлен отдельным листом. Здесь можно было бы воспользоваться шаблоном, но я предпочитаю автоматизировать процесс, чтобы книги создавались щелчком на кнопке панели инструментов. Как выглядит про­ цедура VBA для решения этой задачи?</p><p style="text-align: left;padding-left: 4px;margin-top: 8px;margin-bottom: 0px;" class="ft93">Решение</p><p style="text-align: justify;padding-left: 3px;padding-right: 45px;margin-top: 2px;margin-bottom: 0px;" class="ft24">Далее приведена процедура для решения поставленной задачи. Именам листов присваиваются сокращенные названия месяцев; более того, листы даже распола­ гаются в хронологическом порядке!</p></div><div style="border:none;margin: 3px 0px 0px 74px;padding: 0px;border:none;width: 537px;overflow: hidden;">
<p class="p166 ft20">Sub YearMonthO</p><p style="text-align: left;padding-right: 367px;margin-top: 1px;margin-bottom: 0px;" class="ft140">Dim intSheetCount As Integer Workbooks.Ass</p></div></div><div id="page_338" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 603px;height: 872px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:603px;height:872px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr338x1.jpg" style="width:603px;height:872px;"></div><div class="dclr"></div><p style="text-align: right;padding-right: 56px;margin-top: 62px;margin-bottom: 0px;" class="ft35">Полезные процедуры VBA 3 4 1</p><p style="text-align: left;padding-left: 51px;margin-top: 5px;margin-bottom: 0px;" class="ft35">Worksheets.Add Count:=12 -</p><p class="p1118 ft35">ActiveWorkbook.Work sheets.Count</p><p style="text-align: left;padding-left: 52px;margin-top: 0px;margin-bottom: 0px;" class="ft35">For intSheetCount = 1 To 12</p><p style="text-align: left;padding-left: 52px;margin-top: 0px;margin-bottom: 0px;" class="ft35">Worksheets(intSheetCount).Name - _</p><p style="text-align: left;padding-left: 52px;margin-top: 0px;margin-bottom: 0px;" class="ft35">FormattDateSeriaKl. intSheetCount, 1) "имм")</p><p style="text-align: left;padding-left: 52px;margin-top: 0px;margin-bottom: 0px;" class="ft35">Next intSheetCount</p><p style="text-align: left;padding-left: 52px;margin-top: 0px;margin-bottom: 0px;" class="ft35">End Sub</p><p class="p2047 ft51">Случайный выбор значений из списка</p><p class="p1723 ft25">Проблема</p><p style="text-align: justify;padding-left: 52px;padding-right: 59px;margin-top: 2px;margin-bottom: 0px;" class="ft24">Я устраиваю прослушивание для постановки пьесы. Для этого мне нужно создать пары из актеров и актрис. Имена актеров хранятся в ячейках А2:А8, а имена акт­ рис — в ячейках В2:В8. Как создать набор случайных пар из двух списков одина­ ковой длины, не содержащий повторений?</p><p class="p1449 ft25">Решение</p><p style="text-align: justify;padding-left: 52px;padding-right: 60px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft24">На самом деле случайный выбор должен производиться только из одного списка; если элементы одного списка изменяют порядок, то переставлять элементы вто­ рого списка не обязательно. Для решения задачи можно воспользоваться следую­ щим кодом:</p><p class="p1452 ft20">Sub PickAtRandomO</p><p style="text-align: left;padding-left: 52px;padding-right: 332px;margin-top: 1px;margin-bottom: 0px;" class="ft140">Dim i As Integer. intRank As Integer Randomize</p><p style="text-align: left;padding-left: 52px;margin-top: 0px;margin-bottom: 0px;" class="ft20">Range("B2").Select</p><p class="p530 ft20">For i = 8 To 14</p><p style="text-align: left;padding-left: 58px;margin-top: 1px;margin-bottom: 0px;" class="ft20">ActiveCell.Offset(i, 0).Value =</p><p style="text-align: left;padding-left: 58px;margin-top: 0px;margin-bottom: 0px;" class="ft20">ActiveCell.Offsetti - 8. 0).Value</p><p style="text-align: left;padding-left: 59px;margin-top: 1px;margin-bottom: 0px;" class="ft20">ActiveCell.Offsetti - 8. 2).Value = Rnd</p><p class="p956 ft20">Next i</p><table cellpadding="0" cellspacing="0" style="width: 267px;margin-left: 55px;margin-top: 23px;font: bold 7px 'Arial';">
<tr>
	<td class="tr5 td8"><p class="p22 ft105">• ^ П <span class="ft593">1</span></p></td><td class="tr5 td74"><p class="p22 ft105">Г</p></td><td class="tr5 td12"><p class="p22 ft105">Л <span class="ft593">0 </span>Ч •</p></td><td class="tr5 td44"><p class="p22 ft105">П</p></td><td class="tr5 td94"><p class="p22 ft105">, U 4.Г</p></td><td class="tr5 td51"><p class="p22 ft105">П I</p></td></tr></table><p style="text-align: left;padding-left: 54px;padding-right: 279px;margin-top: 0px;margin-bottom: 0px;font: 10px 'Courier New';line-height: 14px;">intRank = Application.WorksheetFunction.Rank (ActiveCell.Offset(i - 8. 2).Value. _</p><p class="p956 ft35">Range("D2:D8"))</p><p style="text-align: left;padding-left: 53px;padding-right: 314px;margin-top: 0px;margin-bottom: 0px;font: 13px 'Courier New';line-height: 16px;">ActiveCell. Offsetti. l).Value = _ ActiveCell.Offset(intRank - 1. 1).Value Next i</p><p style="text-align: left;padding-left: 54px;margin-top: 0px;margin-bottom: 0px;" class="ft35">End Sub</p><p style="text-align: left;padding-left: 54px;margin-top: 11px;margin-bottom: 0px;" class="ft51">Генератор неповторяющихся случайных чисел</p><p style="text-align: left;padding-left: 54px;margin-top: 8px;margin-bottom: 0px;" class="ft34">Проблема</p><p style="text-align: justify;padding-left: 53px;padding-right: 53px;margin-top: 3px;margin-bottom: 0px;text-indent: 1px;" class="ft46">Я работаю преподавателем и стараюсь равномерно вызывать всех своих студен­ тов во время занятий. Но вместо вызова в алфавитном порядке или по очередно­ сти мест я предпочитаю случайный выбор. Было бы замечательно, если бы про­ грамма Excel помогла мне создать пары из случайных чисел и имен студентов.</p></div><div id="page_339" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 608px;height: 876px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:608px;height:876px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr339x1.jpg" style="width:608px;height:876px;"></div><div class="dclr"></div><div style="border:none;margin: 64px 0px 0px 68px;padding: 0px;border:none;width: 540px;overflow: hidden;">
<p class="p7 ft20"><span class="ft93">342 </span><span class="ft22">Глава 8. </span>Настройка, макросы и УВД</p><p style="text-align: justify;padding-right: 45px;margin-top: 9px;margin-bottom: 0px;" class="ft75">В классе учится всего 30 студентов, но генератор случайных чисел Excel быстрс начинает повторяться. Можно ли сгенерировать список из 30 случайных чисел, который помог бы мне вызвать каждого из 30 студентов только по одному разу?</p><p class="p717 ft93">Решение</p><p style="text-align: justify;padding-right: 50px;margin-top: 2px;margin-bottom: 0px;" class="ft43">Чтобы построить список случайных чисел в заданном интервале ячеек, скопируйте следующую процедуру в программный модуль и вызовите ее:</p><p class="p166 ft20">Sub UniqueRandomNumbersO</p><p style="text-align: left;padding-left: 1px;padding-right: 120px;margin-top: 0px;margin-bottom: 0px;" class="ft140">Dim rngCell As Range, rngCheckRange As Range. rngRangeObject As Range Dim intTemp As Integer. intCellCount As Integer</p><p class="p166 ft20">Dim strPrompt As String</p><p style="text-align: left;padding-left: 7px;margin-top: 14px;margin-bottom: 0px;" class="ft20">strPrompt = "Выделите ячейки, заполняемые случайными числами."</p><p style="text-align: left;padding-left: 7px;margin-top: 12px;margin-bottom: 0px;" class="ft20">Set rngCheckRange = Application.InputBox(Prompt:=strPrompt, Type:=8)</p><p style="text-align: left;padding-left: 8px;margin-top: 14px;margin-bottom: 0px;" class="ft20">intCellCount = rngCheckRange.Cells.Count</p><p style="text-align: left;padding-left: 7px;margin-top: 15px;margin-bottom: 0px;" class="ft20">MsgBox (intCellCount)</p><p style="text-align: left;padding-left: 8px;margin-top: 14px;margin-bottom: 0px;" class="ft20">rngCheckRange.CIearContents</p><p style="text-align: left;padding-left: 8px;margin-top: 15px;margin-bottom: 0px;" class="ft20">For Each rngCell In rngCheckRange</p><p style="text-align: left;padding-left: 8px;margin-top: 2px;margin-bottom: 0px;" class="ft20">intTemp = Int(intCellCount * Rnd) + 1</p><p style="text-align: left;padding-left: 8px;padding-right: 138px;margin-top: 0px;margin-bottom: 0px;" class="ft140">Set rngRangeObject = rngCheckRange.Find(intTemp, lookat:=xlWhole) While Not rngRangeObject Is Nothing</p><p class="p321 ft20">intTemp = Int(intCellCount * Rnd) + 1</p><p style="text-align: left;padding-left: 8px;padding-right: 137px;margin-top: 0px;margin-bottom: 0px;" class="ft20">Set rngRangeObject = rngCheckRange.Find(intTemp, lookat:=xlWhole) Wend</p><p style="text-align: left;padding-left: 9px;padding-right: 391px;margin-top: 0px;margin-bottom: 0px;text-indent: 1px;" class="ft140">rngCell.Value = intTemp Next rngCell</p><p class="p644 ft20">End Sub</p><p class="p1250 ft22">КЛАССИКА АРКАДНОГО ЖАНРА</p><p style="text-align: justify;padding-left: 40px;padding-right: 41px;margin-top: 0px;margin-bottom: 0px;text-indent: 1px;" class="ft124">Представляю вам еще одно средство снижения производительности работы в Office. Unbreakable— бесплатная версия классической аркадной игры Arkanoid. Как и в других клонах аркадной классики, <nobr>Рас-Man</nobr>и Space Invaders, программист Кончи Тани (Kouichi Tani) использует каждую ячейку листа как отдельный пиксел. Unbreakable можно загру­ зить по адресу<nobr>http://www.xl-logic.com/xl_files/games/unbreakable.zip.</nobr> Распакуйте архив и начинайте играть... все инструкции получите прямо в игре.</p></div><div style="border:none;margin: 72px 0px 0px 400px;padding: 0px;border:none;width: 208px;overflow: hidden;">
<p class="p7 ft93">_*%&amp;</p></div></div><div id="page_340" style="position:relative; overflow: hidden;margin: 0px 0px 0px 0px;padding: 0px;border: none;width: 598px;height: 869px;">
<div style="position:absolute;top:0px;left:0px;z-index:-1;width:598px;height:869px;">
<img src="/html/2706/679/html_VTXI3OjlUm.vIvo/htmlconvd-lsyKOr340x1.jpg" style="width:598px;height:869px;"></div><div class="dclr"></div><p style="text-align: justify;padding-left: 52px;padding-right: 53px;margin-top: 559px;margin-bottom: 0px;" class="ft31">Основные функции Excel годами не менялись. Конечно, Microsoft приходилось время от времени подбрасывать <nobr>что-нибудь</nobr>новенькое, чтобы у пользователей был стимул перейти на новую версию. В Excel 2003 таким новшеством стала поддержка языка XML. XML позволяет организовать обмен данными между при­ ложениями независимо от того, умеет программа открывать файлы других про­ грамм или нет. И хотя язык XML компания Microsoft не изобретала, она пред­ ложила новые перспективы, которые сделали сочетание XML+Office 2003 привлекательным для<nobr>бизнес-сообщества.</nobr>Возможности XML действительно впечатляют, но для работы с языком требуется определенная подготовка (мате­ риалы Microsoft по использованию XML в Office и других приложениях можно найти по адресуhttp://msdn.microsoft.com/xml/).</p><p style="text-align: justify;padding-left: 53px;margin-top: 21px;margin-bottom: 0px;" class="ft31">К сожалению, программа Excel 2003 также не оказалась обделенной рядом новых</p><p style="text-align: justify;padding-left: 53px;padding-right: 49px;margin-top: 1px;margin-bottom: 0px;" class="ft31"><span class="ft31">и</span><span class="ft50">интересных возможностей для сбоев. Например, генератор случайных чисел, который теоретически должен выдавать числа от 0 до 1, иногда выдает отрица­ тельные числа. А при построении диаграмм временами проявляется другая ошиб­ ка, </span><IDXSKIP><nobr>из-за</nobr></IDXSKIP>которой сумма квадратов оказывается<span class="ft32">отрицательным </span>числом — что со­ вершенно невозможно, если только вы не работаете с мнимыми числами.</p></div>
                    </div>
                </div>
                

<div class="pagination">
        
        
        
        
        
            <a href="/preview/1620478/" class="page_num"><<</a>
        
            <a href="/preview/1620478/page:33/" class="page_num"><</a>
        
            <a href="/preview/1620478/page:16/" class="page_num">16</a>
        
            <a href="/preview/1620478/page:17/" class="page_num">17</a>
        
            <a href="/preview/1620478/page:18/" class="page_num">18</a>
        
            <a href="/preview/1620478/page:19/" class="page_num">19</a>
        
            <a href="/preview/1620478/page:20/" class="page_num">20</a>
        
            <a href="/preview/1620478/page:21/" class="page_num">21</a>
        
            <a href="/preview/1620478/page:22/" class="page_num">22</a>
        
            <a href="/preview/1620478/page:23/" class="page_num">23</a>
        
            <a href="/preview/1620478/page:24/" class="page_num">24</a>
        
            <a href="/preview/1620478/page:25/" class="page_num">25</a>
        
            <a href="/preview/1620478/page:26/" class="page_num">26</a>
        
            <a href="/preview/1620478/page:27/" class="page_num">27</a>
        
            <a href="/preview/1620478/page:28/" class="page_num">28</a>
        
            <a href="/preview/1620478/page:29/" class="page_num">29</a>
        
            <a href="/preview/1620478/page:30/" class="page_num">30</a>
        
            <a href="/preview/1620478/page:31/" class="page_num">31</a>
        
            <a href="/preview/1620478/page:32/" class="page_num">32</a>
        
            <a href="/preview/1620478/page:33/" class="page_num">33</a>
        
            <a href="/preview/1620478/page:35/" class="next_link">Следующая &#62;</a>
        
            <a href="/preview/1620478/page:33/" class="back_link">&#60; Предыдущая</a>
        
            <span class="current_page">Стр 34 из 37</span>
        
            <a href="" class="page_num selected">34</a>
        
            <a href="/preview/1620478/page:35/" class="page_num">35</a>
        
            <a href="/preview/1620478/page:36/" class="page_num">36</a>
        
            <a href="/preview/1620478/page:37/" class="page_num">37</a>
        
</div>


            </div>
        <!-- End of Panel pnlDocument -->
        
    </div>
    
    <div class="banner_bottom_preview "><div style="display: inline-block;">
<!-- /52555387/studfiles.ru_336х280_1 -->
<div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script> 
<script> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; </script> 
<script> googletag.cmd.push(function() { var _YB=_YB||{ab:function(){return (Math.random()>=0.1?'b':'a'+Math.floor(Math.random()*10));}}; var _yt=new Date(),yb_th=_yt.getUTCHours()-8,yb_tm=_yt.getUTCMinutes(),yb_wd=_yt.getUTCDay();if(yb_th<0){yb_th=24+yb_th;yb_wd-=1;};if(yb_wd<0){yb_wd=7+yb_wd}; googletag.defineSlot('/52555387/studfiles.ru_336х280_1', [336, 280], 'div-gpt-ad-1492592171177-0').setTargeting('yb_ab',_YB.ab()).setTargeting('yb_ff', String(Math.round(Math.random()))).setTargeting('yb_th', yb_th.toString()).setTargeting('yb_tm', yb_tm.toString()).setTargeting('yb_wd', yb_wd.toString()).addService(googletag.pubads()); googletag.enableServices(); }); </script>
</div>
<div id='div-gpt-ad-1492592171177-0' style='height:280px; width:336px;'> 
<script> googletag.cmd.push(function() { googletag.display('div-gpt-ad-1492592171177-0'); }); </script> 
</div>
</div>
 
<div style="display: inline-block;">
 <!-- /52555387/studfiles.ru_336х280_2 -->
<div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>

 // GPT slots
 var gptAdSlots = [];
 googletag.cmd.push(function() {

var _YB=_YB||{ab:function(){return (Math.random()>=0.1?'b':'a'+Math.floor(Math.random()*10));}}; var _yt=new Date(),yb_th=_yt.getUTCHours()-8,yb_tm=_yt.getUTCMinutes(),yb_wd=_yt.getUTCDay();if(yb_th<0){yb_th=24+yb_th;yb_wd-=1;};if(yb_wd<0){yb_wd=7+yb_wd};

   // Define a size mapping object. The first parameter to addSize is
   // a viewport size, while the second is a list of allowed ad sizes.
   var mapping = googletag.sizeMapping().

   // mobile 
   addSize([0, 0], []). 

   // tablet 
   addSize([680, 0], [336, 280]). 

   // Desktop 
   addSize([1024, 0], [336, 280]).build();

   // Define the GPT slot
   gptAdSlots[0] = googletag.defineSlot('/52555387/studfiles.ru_336х280_2', [[336, 280], [336, 280]], 'div-gpt-ad-1492592171177-1').setTargeting('yb_ab',_YB.ab()).setTargeting('yb_ff', String(Math.round(Math.random()))).setTargeting('yb_th', yb_th.toString()).setTargeting('yb_tm', yb_tm.toString()).setTargeting('yb_wd', yb_wd.toString()).
       defineSizeMapping(mapping).
       addService(googletag.pubads());
   // Start ad fetching
   googletag.enableServices();
 });
</script>
</div>

<div id='div-gpt-ad-1492592171177-1'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1492592171177-1'); });
</script>
</div>
</div>

<div style="display: inline-block;">
<!-- /52555387/studfiles.ru_336х280_3 -->
<div>
<script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>

 // GPT slots
 var gptAdSlots = [];
 googletag.cmd.push(function() {

var _YB=_YB||{ab:function(){return (Math.random()>=0.1?'b':'a'+Math.floor(Math.random()*10));}}; var _yt=new Date(),yb_th=_yt.getUTCHours()-8,yb_tm=_yt.getUTCMinutes(),yb_wd=_yt.getUTCDay();if(yb_th<0){yb_th=24+yb_th;yb_wd-=1;};if(yb_wd<0){yb_wd=7+yb_wd};

   // Define a size mapping object. The first parameter to addSize is
   // a viewport size, while the second is a list of allowed ad sizes.
   var mapping = googletag.sizeMapping().

   // mobile 
   addSize([0, 0], []). 

   // Desktop 
   addSize([1024, 0], [336, 280]).build();

   // Define the GPT slot
   gptAdSlots[0] = googletag.defineSlot('/52555387/studfiles.ru_336х280_3', [[336, 280]], 'div-gpt-ad-1492592171177-2').setTargeting('yb_ab',_YB.ab()).setTargeting('yb_ff', String(Math.round(Math.random()))).setTargeting('yb_th', yb_th.toString()).setTargeting('yb_tm', yb_tm.toString()).setTargeting('yb_wd', yb_wd.toString()).
       defineSizeMapping(mapping).
       addService(googletag.pubads());
   // Start ad fetching
   googletag.enableServices();
 });
</script>
</div>

<div id='div-gpt-ad-1492592171177-2'>
<script type='text/javascript'>
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1492592171177-2'); });
</script>
</div>
</div>
</div>
    
    <!-- Begin of Panel pnlAdjacent -->
        <div class="preview_folder_content ">
            <span class="title"><IDXSKIP>Соседние файлы в предмете </IDXSKIP><a href="/all-vuz/145/folder:7610/">[НЕСОРТИРОВАННОЕ]</a></span>
            <ul class="files_list" id="files_list">
                
                    <li><a href="/all-vuz/145/folder:7610/#1603411" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__vnd_openxmlformats_officedocument_wordprocessingml_document "><span class="date">05.02.2015</span><span class="size">14.1 Кб</span><span class="download"><a href="#1603411" rel="nofollow" title="Количество скачиваний" class="link_download">1</a></span><a href="/preview/1603411/">Как необходимо вести себя во время танцев.docx</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620397" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__pdf "><span class="date">06.02.2015</span><span class="size">1.96 Mб</span><span class="download"><a href="#1620397" rel="nofollow" title="Количество скачиваний" class="link_download">116</a></span><a href="/preview/1620397/">Карпов А.В. - Общая психология.pdf</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1619386" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__vnd_openxmlformats_officedocument_wordprocessingml_document "><span class="date">06.02.2015</span><span class="size">12.44 Кб</span><span class="download"><a href="#1619386" rel="nofollow" title="Количество скачиваний" class="link_download">2</a></span><a href="/preview/1619386/">карта.docx</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620275" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__msword "><span class="date">06.02.2015</span><span class="size">27.14 Кб</span><span class="download"><a href="#1620275" rel="nofollow" title="Количество скачиваний" class="link_download">1</a></span><a href="/preview/1620275/">картотека 2003.doc</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620480" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__pdf "><span class="date">06.02.2015</span><span class="size">9.17 Mб</span><span class="download"><a href="#1620480" rel="nofollow" title="Количество скачиваний" class="link_download">3</a></span><a href="/preview/1620480/">Келли.pdf</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620478" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__pdf marker"><span class="date">06.02.2015</span><span class="size">49.69 Mб</span><span class="download"><a href="#1620478" rel="nofollow" title="Количество скачиваний" class="link_download">52</a></span><a href="/preview/1620478/">Кёртис Фрай - Хитрости Excel.pdf</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620346" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__pdf "><span class="date">06.02.2015</span><span class="size">674.64 Кб</span><span class="download"><a href="#1620346" rel="nofollow" title="Количество скачиваний" class="link_download">1</a></span>Китай. Восстание.pdf</div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620347" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__pdf "><span class="date">06.02.2015</span><span class="size">1.81 Mб</span><span class="download"><a href="#1620347" rel="nofollow" title="Количество скачиваний" class="link_download">3</a></span>Китай. Опиумные войны.pdf</div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620222" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__rtf "><span class="date">06.02.2015</span><span class="size">1.65 Mб</span><span class="download"><a href="#1620222" rel="nofollow" title="Количество скачиваний" class="link_download">3</a></span><a href="/preview/1620222/">Китай. Прокламации восставших.doc</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620223" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__rtf "><span class="date">06.02.2015</span><span class="size">7.84 Mб</span><span class="download"><a href="#1620223" rel="nofollow" title="Количество скачиваний" class="link_download">3</a></span><a href="/preview/1620223/">Китай. Синьхайская революция. документы.doc</a></div></li>
                
                    <li><a href="/all-vuz/145/folder:7610/#1620348" class="file_link" title="Ссылка на файл">#</a><div class="file ft__application ft__pdf "><span class="date">06.02.2015</span><span class="size">3.1 Mб</span><span class="download"><a href="#1620348" rel="nofollow" title="Количество скачиваний" class="link_download">2</a></span>Китай. Синьхайская революция. документы.pdf</div></li>
                
            </ul>
        </div>
    <!-- End of Panel pnlAdjacent -->
    
    <script>
    
        // $(document).ready(function() {
          
        //     var scalePdf = function(element) {
            
        //         var widthPdfPage   = $(element).parent().width();
        //         var widthPdfHolder = $(element).width();
                
        //         if (widthPdfPage < widthPdfHolder) {
                  
        //           var scale      = widthPdfPage/widthPdfHolder;
        //           scale          = Math.floor(scale*100)/100;
        //           var heightPage = $(element).height() * scale;
                  
        //           $(element).css('-webkit-transform', 'scale('+scale+')');
        //           $(element).parent().css('height', heightPage+'px');
        //         }
            
        //     };
          
        //     scalePdf('#content_pdf_page .pdf_holder');

        //     var panel = false;
          
        //     $( window ).resize(function() {scalePdf('#content_pdf_page .pdf_holder');});

        //     if ($('.sidebar').height() > ($(self).height() - 270) && $('.sidebar').is(':visible')) {
        //         $('.sidebar').height(Math.max($(self).height() - 270, 300));
        //         panel = $(".sidebar").jScrollPane(function() {

        //         });
        //         if ($('li.selected').prevAll('*').length > 2) {
        //             panel.data('jsp').scrollToElement($('li.selected').prevAll('*').eq(1), true);
        //         }
        //     }

        //     $('.chapter_list a').click(function() {
        //         $('.chapter_list li').removeClass('selected');
        //         $(this).parent().addClass('selected');
        //     });

        //     var hash = window.location.hash.replace("#","");

        //     if (hash != '') {
        //         $('.chapter_list li').removeClass('selected');
        //         $('.chapter_list #chapter_'+hash).parent().addClass('selected');
        //         if ($('li.selected').prevAll('*').length > 3 && panel !== false) {
        //             panel.data('jsp').scrollToElement($('li.selected').prevAll('*').eq(3), true);
        //         }
        //     }

        //     $('.show_chapter_sidebar').click(function() {
        //         $('.right_content').hide();
        //         $('.hide_chapter_sidebar').show();
        //         $('.sidebar').addClass('show_sidebar');
        //         $(this).hide();
        //         return false;
        //     });
        //     $('.hide_chapter_sidebar').click(function() {
        //         $('.sidebar').removeClass('show_sidebar');
        //         $(this).hide();
        //         $('.show_chapter_sidebar').show();
        //         $('.right_content').show();
        //         return false;
        //     });
          
        // });

    </script>
    
            </div>
            <div class="banner_bottom"></div>
        </div>
    </div>

    <div class="footer">
        <div class="footer_holder">
            <div class="content  ">
                <div class="border"></div>
                <IDXSKIP><a href="/help/" class="link">Помощь</a></IDXSKIP> <IDXSKIP><a href="/contact_us/" class="link">Обратная связь</a></IDXSKIP> 
                <IDXSKIP><a href="/feedback/" class="link">Вопросы и предложения</a></IDXSKIP> <IDXSKIP><a href="/terms/" class="link">Пользовательское соглашение</a></IDXSKIP>
				<!--LiveInternet logo--><IDXSKIP><a href="http://www.liveinternet.ru/click"
				target=_blank rel="nofollow" class="liveinternet"><img src="http://counter.yadro.ru/logo?11.1"
				title="LiveInternet: показано число просмотров за 24 часа, посетителей за 24 часа и за сегодня"
				alt="" border=0 width=88 height=31></a></IDXSKIP><!--/LiveInternet-->
            </div>
        </div>
    </div>

    <div class="popup_add" id="popup_download_captcha" style="margin: -250px 0 0 -235px; width: 490px; height: 340px;">
        <IDXSKIP><div class="popup_header" id="univer_tabs">
            <span class="close" onclick="on_closePopup('popup_download_captcha');"></span>
            <div class="title">Ограничение</div>
        </div></IDXSKIP>

        
        
        <div class="tab_content">
        	<p><IDXSKIP>Для продолжения скачивания необходимо собрать картинку:</IDXSKIP></p>
        </div>
    </div>

    <script>
        if (window.addEventListener !== undefined) {
            window.addEventListener("popstate", function(e) {
            	var kyRe    = /\#([0-9]+)/g;
                var kyArray = kyRe.exec(window.location.href);
                if (kyArray != null && kyArray[1]) {
                    
                } else {
                    // Get folder Id from "Back"
                	var myRe    = /folder:([0-9]+)/g;
                	var myArray = myRe.exec(location.pathname);
                	
                    // Get list files
                	if (myArray != null && myArray[1]) {
                	  on_downloadFoldersContentList(myArray[1], false);
                	}
                	else if (window.folderId !== undefined && folderId){
                	  on_getListFiles(folderId, false);
                	}
                }  
            }, false)
        }
    </script>
	
	<!-- Google Analytics counter -->
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-11137462-1', 'studfiles.ru');
	ga('send', 'pageview');
	</script>
	<!-- Google Analytics counter -->

    	<!-- Yandex.Metrika counter -->
    	<script type="text/javascript">
    	(function (d, w, c) {
    		(w[c] = w[c] || []).push(function() {
    			try {
    				w.yaCounter321550 = new Ya.Metrika({id:321550,
    						clickmap:true,
    						trackLinks:true,
    						accurateTrackBounce:true});
    			} catch(e) { }
    		});
    
    		var n = d.getElementsByTagName("script")[0],
    			s = d.createElement("script"),
    			f = function () { n.parentNode.insertBefore(s, n); };
    		s.type = "text/javascript";
    		s.async = true;
    		s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";
    
    		if (w.opera == "[object Opera]") {
    			d.addEventListener("DOMContentLoaded", f, false);
    		} else { f(); }
    	})(document, window, "yandex_metrika_callbacks");
    	</script>
    	<IDXSKIP><noscript><div><img src="//mc.yandex.ru/watch/321550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></IDXSKIP>
    	<!-- /Yandex.Metrika counter -->		

    

    

    

    
	
	
	<!--LiveInternet counter--><script type="text/javascript"><!--
	new Image().src = "http://counter.yadro.ru/hit?r"+
	escape(document.referrer)+((typeof(screen)=="undefined")?"":
	";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
	screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
	";"+Math.random();//--></script><!--/LiveInternet-->

	<!--
    <script type="text/javascript" src="/_script/jquery-1.7.2.min.js"></script> 
    <script type="text/javascript" src="/_script/jquery-ui-1.10.0.custom.min.js"></script> 
    <script type="text/javascript" src="/_script/ajaxrequest.js"></script>
    <script type="text/javascript" src="/elfinder/js/elfinder.min.js"></script>
    <script type="text/javascript" src="/_script/jquery.mousewheel.js"></script>
    <script type="text/javascript" src="/_script/mwheelIntent.js"></script>
    <script type="text/javascript" src="/_script/jquery.jscrollpane.min.js"></script>
    <script type="text/javascript" src="/elfinder/js/i18n/elfinder.ru.js"></script>
    <script type="text/javascript" src="/_script/jquery.collapser.min.js"></script>
    <script type="text/javascript" src="/_script/chosen.1.4.jquery.min.js"></script>
    <script type="text/javascript" src="/_script/highlight.min.js"></script>
    <script type="text/javascript" src="/_script/main.js?v=0419"></script>
    <script type="text/javascript" src="/_script/files_tree_list.js"></script>
    <script type="text/javascript" src="/_script/search.js"></script>
	-->

	<script async type="text/javascript" src="/_script/production/studfiles.min.js?v=13"></script>
					
</body>
</html>
